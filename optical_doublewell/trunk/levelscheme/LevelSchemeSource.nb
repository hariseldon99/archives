(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 5.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    848462,      21757]
NotebookOptionsPosition[    822292,      20934]
NotebookOutlinePosition[    823140,      20964]
CellTagsIndexPosition[    823097,      20961]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["LevelScheme package",
  FontFamily->"Times New Roman",
  FontSize->36],
 StyleBox["\n\t",
  FontFamily->"Times New Roman"],
 StyleBox["M. A. Caprio, ", "SmallText",
  FontFamily->"Times New Roman",
  FontSize->12],
 "Department of Physics, University of Notre Dame"
}], "Chapter"],

Cell[TextData[{
 "Level scheme drawing and scientific figure preparation system\n",
 StyleBox["See standardized annotation comments below for version \
information.",
  FontSlant->"Italic"]
}], "Text",
 CellFrame->{{0, 0}, {0, 2}}],

Cell[CellGroupData[{

Cell["Header comments", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Title", ":", " ", "LevelScheme"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Context", ":", " ", "LevelScheme`"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Summary", ":", " ", 
     RowBox[{
     "Scientific", " ", "figure", " ", "preparation", " ", "system"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Author", ":", " ", 
      RowBox[{"Mark", " ", 
       RowBox[{"A", ".", " ", "Caprio"}]}]}]}], ",", " ", 
    RowBox[{"Department", " ", "of", " ", "Physics"}], ",", " ", 
    RowBox[{"University", " ", "of", " ", "Notre", " ", "Dame"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Copyright", ":", " ", 
      RowBox[{"Copyright", " ", "2007"}]}]}], ",", " ", 
    RowBox[{"Mark", " ", 
     RowBox[{"A", ".", " ", "Caprio"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", 
     RowBox[{"Version", ":", " ", "3.40"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Mathematica", " ", 
     RowBox[{"Version", ":", " ", "6.0"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"History", ":", "\[IndentingNewLine]", 
      RowBox[{"Early", " ", "ancestor", " ", "code"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"July", " ", "1999."}], "\n", "   ", 
     RowBox[{"V1", ".00"}]}], ",", " ", 
    RowBox[{"January", " ", "2004", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"first", " ", "web", " ", "release"}], ")"}], ".", " ", 
      "\[IndentingNewLine]", "V2"}], ".00"}], ",", " ", 
    RowBox[{
     RowBox[{"November", " ", "2004."}], "  ", "\[IndentingNewLine]", " ", 
     RowBox[{"V3", ".00"}]}], ",", " ", 
    RowBox[{
     RowBox[{"March", " ", "2005."}], "\[IndentingNewLine]", " ", 
     RowBox[{"V3", ".01"}]}], ",", " ", 
    RowBox[{"March", " ", "2005.", "\[IndentingNewLine]", " ", 
     StyleBox["V3",
      FontFamily->"Courier New"], 
     StyleBox[".02",
      FontFamily->"Courier New"]}], 
    StyleBox[",",
     FontFamily->"Courier New"], 
    StyleBox[" ",
     FontFamily->"Courier New"], 
    RowBox[{
     StyleBox["April",
      FontFamily->"Courier New"], 
     StyleBox[" ",
      FontFamily->"Courier New"], 
     StyleBox["2005.",
      FontFamily->"Courier New"], "\[IndentingNewLine]", " ", "V3", ".10"}], 
    ",", " ", 
    RowBox[{"April", " ", "2005", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CPCPL", " ", "distribution"}], ")"}], ".", 
      "\[IndentingNewLine]", "V3"}], ".11"}], ",", " ", 
    RowBox[{
     RowBox[{"May", " ", "2005."}], "\n", "   ", 
     RowBox[{"V3", ".20"}]}], ",", " ", 
    RowBox[{
     RowBox[{"October", " ", "2005."}], "\n", "   ", 
     RowBox[{"V3", ".21"}]}], ",", " ", 
    RowBox[{
     RowBox[{"October", " ", "2005."}], "\[IndentingNewLine]", " ", 
     RowBox[{"V3", ".30"}]}], ",", " ", 
    RowBox[{"July", " ", "2007.", "\n", "V3", ".40"}], ",", " ", 
    RowBox[{"August", " ", "2007.", "\n", "V3", ".41"}], ",", " ", 
    RowBox[{"September", " ", "2007."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Discussion", ":", "\n", " ", 
      RowBox[{
      "The", " ", "LevelScheme", " ", "package", " ", "has", " ", "been", " ",
        "published", " ", "in", " ", "Computer", " ", "Physics", " ", 
       "Communications"}]}]}], ",", " ", 
    RowBox[{"M", ".", " ", "A", ".", " ", "Caprio"}], ",", " ", 
    RowBox[{"Comput", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "171"}],
     ",", " ", 
    RowBox[{"107", " ", 
     RowBox[{
      RowBox[{"(", "2005", ")"}], ".", "  ", "Updates"}], " ", "and", " ", 
     "further", " ", "information", " ", "may", " ", "be", " ", "obtained", 
     " ", "through", " ", "the", " ", "LevelScheme", " ", "home", " ", 
     "page"}], ",", " ", 
    RowBox[{
     RowBox[{"www", ".", "levelscheme", ".", "org", ".", "  ", "If"}], " ", 
     "you", " ", "modify", " ", "the", " ", "software"}], ",", " ", 
    RowBox[{
    "you", " ", "*", "must", "*", " ", "change", " ", "the", " ", "package", 
     " ", "name", " ", "and", " ", "*", "must", "*", " ", "change", " ", 
     "the", " ", "message", " ", "displayed", " ", "when", " ", "the", " ", 
     "package", " ", "is", " ", "loaded"}], ",", " ", 
    RowBox[{
    "to", " ", "clearly", " ", "indicate", " ", "that", " ", "the", " ", 
     "package", " ", "is", " ", "a", " ", "modified", " ", 
     RowBox[{"version", "."}]}]}], "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 AutoIndent->False,
 CellChangeTimes->{{3.395093723328125*^9, 3.39509375184375*^9}, {
  3.398545735296875*^9, 3.39854574365625*^9}},
 LanguageCategory->"NaturalLanguage"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "LevelScheme`Private`$RevisionString", "=", 
   "\"\<3.41 (September 11, 2007)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "LevelScheme`Private`$HomePageURL", "=", 
   "\"\<http://wnsl.physics.yale.edu/levelscheme/notebook_entrance_3.41.html\>\
\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395093759515625*^9, 3.39509380640625*^9}, {
   3.3955242503125*^9, 3.3955242775*^9}, {3.395524400171875*^9, 
   3.3955244023125*^9}, {3.396268347734375*^9, 3.396268400109375*^9}, {
   3.396543732125*^9, 3.3965437368125*^9}, {3.39687832734375*^9, 
   3.39687832746875*^9}, {3.398545138328125*^9, 3.398545160234375*^9}, 
   3.39854552634375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin package", "Section"],

Cell[CellGroupData[{

Cell["Version flag message", "Subsection",
 CellChangeTimes->{{3.39551529709375*^9, 3.39551530159375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "6.0"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<This version of LevelScheme requires Mathematica 6 or higher.  You \
are currently running Mathematica \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"IntegerPart", "[", "$VersionNumber", "]"}], "]"}], "<>", 
       "\"\<.  Please visit the LevelScheme home page \
(http://wnsl.physics.yale.edu/levelscheme) to download the appropriate \
earlier version of LevelScheme for use with your Mathematica.\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395515425421875*^9, 3.395515556828125*^9}, {
  3.395515586859375*^9, 3.395515853921875*^9}, {3.3955159191875*^9, 
  3.395515920640625*^9}, {3.395515954171875*^9, 3.395515984609375*^9}, {
  3.39654378584375*^9, 3.396543820328125*^9}, {3.398545170921875*^9, 
  3.3985451744375*^9}, {3.3985452474375*^9, 3.39854528821875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package context definition", "Subsection"],

Cell["\<\
Declare package context, read in packages which should be visible to the \
user, and unprotect all symbols in current context in case package is read in \
over itself.\
\>", "Text"],

Cell["\<\
Provided packages:
\tCustomTicks` is provided for the user's benefit, used internally for tick \
processing.
\tMCText` is provided for the user's benefit.
\tForEach` is provided for the user's benefit, also used internally.
\tBlockOptions` is provided for symbol BlockOptions, also used internally for \
dynamic scoping of option values.
\tInheritOptions` is provided so that the user can access the symbol \
Inherited, also used internally for option processing.
\tClipToRectangle` is provided so that the user can access the symbol \
ClipToRectangle, also used internally by drawing functions.
\tGraphics`Common`GraphicsCommon` is provided to avoid hiding ScaleFactor.
\tLegacyColors` is provided for the user's benefit.
\tNamedColorPalette` is provided so user can directly launch palette, also \
used internally for palette pop-up button.\
\>", "Text",
 CellChangeTimes->{{3.39508774165625*^9, 3.395087742265625*^9}, {
   3.395087773609375*^9, 3.395087773859375*^9}, {3.395090593546875*^9, 
   3.39509059396875*^9}, 3.395090637203125*^9, {3.395090677359375*^9, 
   3.3950906781875*^9}, {3.395091141296875*^9, 3.39509117134375*^9}, {
   3.395518963640625*^9, 3.3955189995625*^9}, {3.39551904921875*^9, 
   3.395519068234375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<LevelScheme`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CustomTicks`\>\"", ",", "\"\<MCText`\>\"", ",", "\"\<ForEach`\>\"", 
      " ", ",", "\"\<BlockOptions`\>\"", ",", "\"\<InheritOptions`\>\"", ",", 
      "\"\<ClipToRectangle`\>\"", ",", 
      "\"\<Graphics`Common`GraphicsCommon`\>\"", ",", "\"\<LegacyColors`\>\"",
       ",", "\"\<NamedColorPalette`\>\""}], "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395087747453125*^9, 3.39508775096875*^9}, {
   3.39509064290625*^9, 3.395090643234375*^9}, 3.395090710546875*^9, {
   3.395091175015625*^9, 3.395091179703125*^9}, {3.395093472375*^9, 
   3.39509347784375*^9}, {3.395093608140625*^9, 3.3950936085*^9}, {
   3.395519039875*^9, 3.395519061546875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messages", "Section"],

Cell[CellGroupData[{

Cell["Generic parent object", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SchemeObject", "::", "usage"}], "=", 
   "\"\<Parent object for option inheritance for level scheme objects.\>\""}],
   ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic rendering options", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Color", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Opacity", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";", " ", 
   RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowLine", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Thickness", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";", "  ", 
   RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dashing", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";", "  ", 
   RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DashingGap", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DashingCorrection", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowFill", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FillColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FillOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "FontXXXXXX", " ", "options", " ", "are", " ", "all", " ", "from", " ", 
    RowBox[{"System`", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundFontSizeFactor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Show", "::", "reusage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], ";", " ", 
  RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Layer", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], ";", " "}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.3950877775*^9, 3.3950878165625*^9}, 
   3.3955199864375*^9, {3.396634096515625*^9, 3.396634120734375*^9}, {
   3.396634182421875*^9, 3.39663418646875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic text label options", "Subsection"],

Cell["\<\
\tNot all possible options for all labels are presently used, but they are \
reserved here anyway.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowText", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Offset", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], "   ", 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Nudge", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Orientation", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Background", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], "   ", 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AboveKinkL", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SegmentL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveKinkR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SegmentR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveKinkT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SegmentT", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveKinkB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SegmentB", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveKinkC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SegmentC", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowLabX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OffsetX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NudgeX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundOpacityX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PosnX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BufferX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveKinkX", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentX", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396636409859375*^9, 3.396636436390625*^9}, {
  3.39663648990625*^9, 3.39663653065625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tick mark control options", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ticks", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], " ", 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickShowLine", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickLineColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickThickness", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontFamily", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontSize", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontSlant", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontTracking", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickFontWeight", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TickNudge", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39663442825*^9, 3.396634432890625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Panel letter control options", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontFamily", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontSize", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontSlant", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontTracking", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterFontWeight", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowPanelLetter", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetterOffset", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterNudge", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterOrientation", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterBackground", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PanelLetterBackgroundOpacity", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39663441440625*^9, 3.39663441934375*^9}, {
  3.396636535953125*^9, 3.3966365574375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specialized drawing options", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Margin", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EnergyLabelFunction", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EnergyNudge", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WingHeight", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WingRiseWidth", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WingTipWidth", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWingL", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWingR", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToWing", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromWing", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineToFront", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects. (UNDOCUMENTED)\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EndPositions", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrowType", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrowHalf", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects. (UNDOCUMENTED)\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Width", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquiggleWavelength", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquiggleSide", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SquiggleBuffer", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotPoints", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TailBevel", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShaftLines", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HeadLength", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  RowBox[{"(*", "Graphics`Arrow`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HeadLip", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Kink", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowHead", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTail", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConversionColor", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConversionSide", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConversionCoeff", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CallOutVector", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], " "}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gap", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True],

Cell["Options for Scheme not already defined above", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Frame", "::", "reusage"}], "=", "\"\<Option for Scheme.\>\""}], 
   ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrameLabel", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrameTicks", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Axes", "::", "reusage"}], "=", "\"\<Option for Scheme.\>\""}], 
   ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotRange", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImageSize", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplayFunction", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeFlags", "::", "usage"}], "=", 
   "\"\<Option for Scheme.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BlockOptions", "::", "reusage"}], "=", 
    "\"\<Option for Scheme.\>\""}], ";"}], 
  RowBox[{"(*", "BlockOptions`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Information", "::", "reusage"}], "=", 
    "\"\<Option for Scheme. (UNDOCUMENTED)\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Debug", "::", "reusage"}], "=", 
    "\"\<Option for Scheme. (UNDOCUMENTED)\>\""}], ";"}], 
  RowBox[{"(*", "System`", "*)"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Inverted", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LineArrow", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MultilineArrow", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SquiggleArrow", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShapeArrow", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromHead", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromTail", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromHeadVertical", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromTailVertical", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromHeadHorizontal", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromTailHorizontal", "::", "usage"}], "=", 
   "\"\<Option value for level scheme drawing objects.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coordinate system control and conversion", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetOrigin", "::", "usage"}], "=", 
   "\"\<SetOrigin[x] or SetOrigin[pt] sets the origin of the user coordinate \
system.  SetOrigin[] clears the definition.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScale", "::", "usage"}], "=", 
   "\"\<SetScale[yfactor] or SetScale[{xfactor,yfactor}] sets the scaling of \
the user coordinate system.  SetScale[] clears the definition.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetRegion", "::", "usage"}], "=", 
   "\"\<SetRegion[{{xc1,xc2},{yc1,yc2}},{{xr1,xr2},{yr1,yr2}}] sets the \
region coordinate system and clipping box.  Any existing user coordinate \
definitions (origin or scale) are cleared.  SetRegion[] resets the region to \
the full canvas.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "::", "usage"}], "=", 
   "\"\<ConvertCoordinate[system,newsystem,type,{x,y}] or \
ConvertCoordinate[system,newsystem,type,x,index] carries out coordinate \
system conversion.  The systems can be specified to be CanvasCoords, \
RegionCoords, UserCoords, AbsoluteCoords, or ScaledCoords.  The type (C or D) \
indicates coordinate or displacement conversion.  The index (1 or 2) \
indicates X or Y coordinate conversion.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertRange", "::", "usage"}], "=", 
   "\"\<ConvertRange[system,newsystem,type,{x1,x2},index] carries out \
coordinate system conversion for X or Y ranges.  The arguments have similar \
meanings as for ConvertCoordinate.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertRegion", "::", "usage"}], "=", 
   "\"\<ConvertRegion[system,newsystem,type,{{x1,x2},{y1,y2}}] carries out \
coordinate system conversion for regions.  The arguments have similar \
meanings as for ConvertCoordinate.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"C", "::", "reusage"}], "=", 
    "\"\<Conversion type identifier for ConvertCoordinate.\>\""}], ";"}], " ",
   
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "::", "reusage"}], "=", 
    "\"\<Conversion type identifier for ConvertCoordinate.\>\""}], ";"}], " ",
   
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanvasCoords", "::", "usage"}], "=", 
   "\"\<Level scheme drawing coordinate system identifier.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteCoords", "::", "usage"}], "=", 
   "\"\<Level scheme drawing coordinate system identifier.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RegionCoords", "::", "usage"}], "=", 
   "\"\<Level scheme drawing coordinate system identifier.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledCoords", "::", "usage"}], "=", 
   "\"\<Level scheme drawing coordinate system identifier.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UserCoords", "::", "usage"}], "=", 
   "\"\<Level scheme drawing coordinate system identifier.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SavePoint", "::", "usage"}], "=", 
   "\"\<SavePoint[ID,{x,y}] or SavePoint[ID,{x,y},system] saves the canvas \
position of the given point.  If no coordinate system is specified, it is \
assumed {x,y} are the coordinates in the current user coordinate \
system.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetPoint", "::", "usage"}], "=", 
   "\"\<GetPoint[ID] or GetPoint[ID,system] returns the position of the \
previously saved point, converted to the presently-defined coordinate \
systems.  If no coordinate system is specified, the point is given in the \
current user coordinates.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Figure display", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "::", "usage"}], "=", 
   "\"\<Figure[list] returns a drawing constructed from the objects in \
list.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtendRange", "::", "reusage"}], "=", 
    "\"\<Option for Figure.\>\""}], ";"}], " ", 
  RowBox[{"(*", " ", "LevelScheme`", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeIfDef", "::", "usage"}], "=", 
   "\"\<SchemeIfDef[Flag,Object1,...] evaluates objects and splices them into \
the figure only if Flag is defined in the SchemeFlags option.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeIfNDef", "::", "usage"}], "=", 
   "\"\<SchemeIfNDef[Flag,Object1,...] evaluates objects and splices them \
into the figure only if Flag is *not* defined in the SchemeFlags \
option.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Level objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Lev", "::", "usage"}], "=", 
   "\"\<Lev[ID,x1,x2,Energy] is a level scheme drawing object.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLine", "::", "usage"}], "=", 
   "\"\<ExtensionLine[ID,position1,position2] or \
ExtensionLine[ID,side,length] is a level scheme drawing object.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LastLevel", "::", "usage"}], "=", 
   "\"\<LastLevel is a global variable containing the ID of the most recently \
defined level.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelEnergy", "::", "usage"}], "=", 
   "\"\<LevelEnergy[ID] returns the energy value (user coordinate) specified \
when the given level was defined.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Connector", "::", "usage"}], "=", 
   "\"\<Connector[ID1,ID2] is a level scheme drawing object.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition arrow objects", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "::", "usage"}], "=", 
   "\"\<Trans[ID1,position1,ID2,position2] or Trans[ID1,ID2] or \
Trans[pt1,pt2] is a level scheme drawing object.\>\""}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing shape objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeLine", "::", "usage"}], "=", 
   "\"\<SchemeLine[{pt1,pt2,...}] is a level scheme drawing object.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemePolygon", "::", "usage"}], "=", 
   "\"\<SchemePolygon[{pt1,pt2,...}] is a level scheme drawing object.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeCircle", "::", "usage"}], "=", 
   "\"\<SchemeCircle[pt,radius] or SchemeCircle[pt,radius,{theta1,theta2}] is \
a level scheme drawing object.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeEllipse", "::", "usage"}], "=", 
   "\"\<SchemeEllipse[pt,{r1,r2},theta] is a level scheme drawing \
object.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBox", "::", "usage"}], "=", 
   "\"\<SchemeBox[{{x1,x2},{y1,y2}}] or SchemeBox[pt1,pt2] is a level scheme \
drawing object.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeSquare", "::", "usage"}], "=", 
   "\"\<SchemeSquare[pt,radius] is a level scheme drawing object.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeArrow", "::", "usage"}], "=", 
   "\"\<SchemeArrow[pt1,pt2] is a level scheme drawing object.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBracket", "::", "usage"}], "=", 
   "\"\<SchemeBracket[Bottom|Top,{x1,x2},y] or \
SchemeBracket[Left|Right,x,{y1,y2}] is a level scheme drawing object.  Level \
IDs may be specified instead of coordinates, as \
SchemeBracket[Bottom|Top,{ID1,ID2},y] or \
SchemeBracket[Left|Right,x,{ID1,ID2}].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeLine3D", "::", "usage"}], "=", 
   "\"\<SchemeLine3D[{pt1,pt2,...}] is a 3D analogue of a level scheme \
drawing object.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeArrow3D", "::", "usage"}], "=", 
   "\"\<SchemeArrow3D[pt1,pt2] or SchemeArrow3D[pt1,pt2,headangle] is a 3D \
analogue of a level scheme drawing object.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Label objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ManualLabel", "::", "usage"}], "=", 
   "\"\<ManualLabel[pt,text] is a level scheme drawing object.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledLabel", "::", "usage"}], "=", 
   "\"\<ScaledLabel[scaledpt,text] is a level scheme drawing object.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BandLabel", "::", "usage"}], "=", 
   "\"\<BandLabel[ID,text] or BandLabel[ID,position,text] is a level scheme \
drawing object.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelLabel", "::", "usage"}], "=", 
   "\"\<LevelLabel[ID,position,text] is a level scheme drawing object.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ManualLabel3D", "::", "usage"}], "=", 
   "\"\<ManualLabel3D[pt,text] is a 3D analogue of a level scheme drawing \
object.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics inclusion", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics", "::", "usage"}], "=", 
   "\"\<RawGraphics[graphics1,...] is a level scheme drawing object which \
includes Graphics, ContourGraphics, or DensityGraphics objects in the scheme.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics3D", "::", "usage"}], "=", 
   "\"\<RawGraphics3D[graphics1,...] is a level scheme drawing object.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ClipToRectangle", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], " ", 
  RowBox[{"(*", "ClipToRectangle`", "*)"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ViewPort3D", "::", "usage"}], "=", 
   "\"\<ViewPort3D[{graphics,...},{{x1,x2},{y1,y2}}] is a level scheme \
drawing object which includes three-dimensional graphics objects in the \
scheme.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledViewPort3D", "::", "usage"}], "=", 
   "\"\<ScaledViewPort3D[{graphics,...},{{x1s,x2s},{y1s,y2s}}] is a level \
scheme drawing object which includes three-dimensional graphics objects in \
the scheme.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisScaling", "::", "usage"}], "=", 
   "\"\<Option for ViewPort3D.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EulerRotation", "::", "usage"}], "=", 
   "\"\<Option for ViewPort3D.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395091929890625*^9, 3.395091937828125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axes and panels", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxis", "::", "usage"}], "=", 
   "\"\<SchemeAxis[Bottom|Top,{x1,x2},y] or SchemeAxis[Left|Right,x,{y1,y2}] \
generates a freestanding axis.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigurePanel", "::", "usage"}], "=", 
   "\"\<FigurePanel[{{xc1,xc2},{yc1,yc2}}] sets the region coordinate system \
and draws a panel frame, labels, and fill.  The panel position is specified \
in canvas coordinates.  FigurePanel[{row,column}] generates a panel of a \
multipanel plot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledFigurePanel", "::", "usage"}], "=", 
   "\"\<ScaledFigurePanel[{{xs1,xs2},{ys1,ys2}}] sets the region coordinate \
system and draws a panel frame, labels, and fill.  The panel position is \
specified in scaled coordinates relative to the present plotting \
region.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotRange", "::", "reusage"}], "=", 
   "\"\<Option for FigurePanel.\>\""}], ";", 
  RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"XPlotRange", "::", "usage"}], "=", 
   "\"\<Option for FigurePanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YPlotRange", "::", "usage"}], "=", 
   "\"\<Option for FigurePanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowEdge", "::", "usage"}], "=", 
   "\"\<Option for FigurePanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "::", "usage"}], "=", 
   "\"\<Multipanel[{{xc3,xc4},{yc3,yc4}},{rows,columns}] initializes \
automatic multipanel plotting.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XPlotRanges", "::", "usage"}], "=", 
   "\"\<Option for Multipanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YPlotRanges", "::", "usage"}], "=", 
   "\"\<Option for Multipanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XFrameTicks", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YFrameTicks", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XFrameLabels", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YFrameLabels", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XPanelSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YPanelSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XGapSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YGapSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XMarginSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YMarginSizes", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelShift", "::", "usage"}], "=", 
   "\"\<Option for Panel, only relevant when used with automatic panel \
generation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelAdjustments", "::", "usage"}], "=", 
   "\"\<Option for Panel, only relevant when used with automatic panel \
generation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTicks", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTickLabels", "::", "reusage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], ";", 
  RowBox[{"(*", "CustomTicks`", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ShowTickLabelsExterior", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTickLabelsInterior", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowFrameLabels", "::", "reusage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowFrameLabelsExterior", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowFrameLabelsInterior", "::", "usage"}], "=", 
   "\"\<Option for automatic panel generation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetterCorner", "::", "usage"}], "=", 
   "\"\<Option for level scheme drawing objects.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetterInset", "::", "usage"}], "=", 
   "\"\<Option for Panel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetter", "::", "usage"}], "=", 
   "\"\<PanelLetter[] returns the letter for the current panel of a \
multipanel plot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Order", "::", "reusage"}], "=", 
   "\"\<Option for PanelLetter.\>\""}], ";", 
  RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"First", "::", "reusage"}], "=", 
   "\"\<Option for PanelLetter.\>\""}], ";", 
  RowBox[{"(*", "System`", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Format", "::", "reusage"}], "=", 
   "\"\<Option for PanelLetter.\>\""}], ";", 
  RowBox[{"(*", "System`", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3950921478125*^9, 3.395092164515625*^9}, {
  3.39552123815625*^9, 3.3955212451875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data plotting", "Subsection"],

Cell["Data utilities", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AttachIndex", "::", "usage"}], "=", "\"\<(UNDOCUMENTED)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaleFactor", "::", "reusage"}], "=", 
    "\"\<Option for AttachIndex.\>\""}], ";"}], " ", 
  RowBox[{
  "(*", "Graphics`Common`GraphicsCommon`ScaleFactor`", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Range", "::", "reusage"}], "=", 
    "\"\<Option for AttachIndex.\>\""}], ";"}], " ", 
  RowBox[{"(*", "System`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSetQ", "::", "usage"}], "=", 
   "\"\<DataSetQ[list] returns True only if list is a valid LevelScheme data \
set.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Data filtering", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SelectData", "::", "usage"}], "=", 
   "\"\<SelectData[test] is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExcludeData", "::", "usage"}], "=", 
   "\"\<ExcludeData[test] is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformData", "::", "usage"}], "=", 
   "\"\<TransformData[f] is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DownsampleData", "::", "usage"}], "=", 
   "\"\<DownsampleData[f] is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XRange", "::", "usage"}], "=", 
   "\"\<XRange[x1,x2] is a logical text which acts on a data point.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YRange", "::", "usage"}], "=", 
   "\"\<YRange[y1,y2] is a logical text which acts on a data point.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InPlotRegion", "::", "usage"}], "=", 
   "\"\<InPlotRegion is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitX", "::", "usage"}], "=", 
   "\"\<LimitX[x1,x2] is a data filter for DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitY", "::", "usage"}], "=", 
   "\"\<LimitY[y1,y2] is a data filter for DataPlot.\>\""}], ";"}]}], "Input",\

 InitializationCell->True],

Cell["Data plotting", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DataPlot", "::", "usage"}], "=", 
   "\"\<DataPlot[data] produces customizable data plots.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataTag", "::", "usage"}], "=", 
   "\"\<DataTag[ID] sets the name of the following data set.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaveDataStyle", "::", "usage"}], "=", 
   "\"\<SaveDataStyle[ID] saves the current plotting options.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDataStyle", "::", "usage"}], "=", 
   "\"\<SetDataStyle[ID] sets the plotting options to those of the given \
named data set.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataLabel", "::", "usage"}], "=", 
   "\"\<DataLabel[ID] attaches text to a data plot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataLegend", "::", "usage"}], "=", 
   "\"\<DataPlot[{xs,ys},{{dataset1,label1},...}] generates a data plot \
legend.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataTransformation", "::", "usage"}], "=", 
   "\"\<Symbol the option values for which control the behavior of \
DataPlot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataLine", "::", "usage"}], "=", 
   "\"\<Symbol the option values for which control the behavior of \
DataPlot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbol", "::", "usage"}], "=", 
   "\"\<Symbol the option values for which control the behavior of \
DataPlot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowData", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineShape", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataFilters", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolShape", "::", "reusage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], " ", 
  RowBox[{
  "(*", "Graphics`MultipleListPlot`", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErrorValue", "::", "usage"}], "=", 
   "\"\<Value type for data points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolSize", "::", "usage"}], "=", 
    "\"\<Option for level scheme drawing objects.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataLineShape", "::", "usage"}], "=", 
   "\"\<Symbol used for specification of LevelScheme plot line shape.  \
DataLineShape[shape,plotpoints] should act on a list of points, transforming \
it to another list of points.\>\""}], ";", 
  RowBox[{
   RowBox[{"DataSymbolShape", "::", "usage"}], "=", 
   "\"\<Symbol used for specification of LevelScheme plot symbol shape.  \
DataSymbolShape[shape,plotpoints] should return a list of points, spanning \
approximately the unit circle.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["User-accessible utilities", "Subsection"],

Cell["Decay scheme construction", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AutoLevelInit", "::", "usage"}], "=", 
   "\"\<AutoLevelInit[x0,space,bigspace] initializes automatic placement of \
transitions in a decay scheme.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoLevel", "::", "usage"}], "=", 
   "\"\<AutoLevel[ID1] selects the starting level for automatic placement of \
transitions in a decay scheme.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoTrans", "::", "usage"}], "=", 
   "\"\<AutoTrans[ID2] generates a transition to the specified ending level \
for automatic placement of transitions in a decay scheme.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Graphics", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "usage"}], "=", 
   "\"\<GrabPoints[graphics] returns the list of points from the first Line \
found by ExtractLines[graphics].\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLines", "::", "usage"}], "=", 
   "\"\<ExtractLines[graphics] extracts a list of Line objects from a \
Graphics, ContourGraphics, or Graphics3D object.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphics3DQ", "::", "usage"}], "=", 
   "\"\<Graphics3DQ[x] returns True if x is a Graphics3D object, with first \
argument of head list and optional second argument a flat list of \
options.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CombineGraphics3D", "::", "usage"}], "=", 
   "\"\<CombineGraphics3D[{graphics1,...}] returns a Graphics3D object with a \
primative list combining the primative lists of graphics1, ..., each as \
separate sublists (so style directives in one sublist do not affect the \
following sublists).\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRange", "::", "usage"}], "=", 
   "\"\<ExtendRange[{x1,x2},{fx1,fx2}] or ExtendRange[{x1,x2},fx] extends an \
interval by the specified fractional amounts in each direction.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "::", "usage"}], "=", 
   "\"\<ExtendRegion[{{x1,x2},{y1,y2}},{{fx1,fx2},{fy1,fy2}}] or \
ExtendRegion[{{x1,x2},{y1,y2}},{fx,fy}] or ExtendRegion[{{x1,x2},{y1,y2}},f] \
extends a plot region by the specified fractional amounts in each \
direction.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell["LevelScheme technology and debugging", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeGraphics", "::", "usage"}], "=", 
   "\"\<Graphics container for LevelScheme objects.\>\""}], ";", 
  RowBox[{
   RowBox[{"LineStyle", "::", "usage"}], "=", 
   "\"\<LineStyle[] returns a list of line style directives specified \
following the LevelScheme option system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FillStyle", "::", "usage"}], "=", 
   "\"\<FillStyle[] returns a list of fill style directives specified \
following the LevelScheme option system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "usage"}], "=", 
   "\"\<Evaluating LevelScheme[] reloads the LevelScheme package. \
(UNDOCUMENTED)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MultipanelSettings", "::", "usage"}], "=", 
   "\"\<MultipanelSettings[] prints the current Multipanel plotting settings. \
(UNDOCUMENTED)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PackageVersions", "::", "usage"}], "=", 
   "\"\<Evaluating PackageVersions[] displays package version information for \
all loaded packages. (UNDOCUMENTED)\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.39552335603125*^9, {3.39664039028125*^9, 3.3966404351875*^9}, {
   3.396640628234375*^9, 3.396640670421875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Legacy functions", "Subsection"],

Cell["\<\
\tDeprecated functions still work.
\tReplaced functions do not.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLineL", "::", "deprecated"}], "=", 
   "\"\<ExtensionLineL (last used in LevelScheme 2.0) has been absorbed into \
ExtensionLine.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLineR", "::", "deprecated"}], "=", 
   "\"\<ExtensionLineR (last used in LevelScheme 2.0) has been absorbed into \
ExtensionLine.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransArrow", "::", "deprecated"}], "=", 
   "\"\<TransArrow (last used in LevelScheme 2.0) has been absorbed into \
Trans.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RegionLabel", "::", "deprecated"}], "=", 
   "\"\<RegionLabel (last used in LevelScheme 2.0) has been replaced with \
ScaledLabel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnnotateL", "::", "deprecated"}], "=", 
   "\"\<AnnotateL (last used in LevelScheme 2.0) has been replaced with \
LevelLabel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnnotateR", "::", "deprecated"}], "=", 
   "\"\<AnnotateR (last used in LevelScheme 2.0) has been replaced with \
LevelLabel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisB", "::", "deprecated"}], "=", 
   "\"\<SchemeAxisB (last used in LevelScheme 2.0) has been replaced with \
SchemeAxis.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisL", "::", "deprecated"}], "=", 
   "\"\<SchemeAxisL (last used in LevelScheme 2.0) has been replaced with \
SchemeAxis.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisT", "::", "deprecated"}], "=", 
   "\"\<SchemeAxisT (last used in LevelScheme 2.0) has been replaced with \
SchemeAxis.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisR", "::", "deprecated"}], "=", 
   "\"\<SchemeAxisR (last used in LevelScheme 2.0) has been replaced with \
SchemeAxis.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoInit", "::", "deprecated"}], "=", 
   "\"\<AutoInit (last used in LevelScheme 2.0) has been renamed \
AutoLevelInit.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoPanelInit", "::", "replaced"}], "=", 
   "\"\<AutoPanelInit (last used in LevelScheme 2.0) has been replaced with \
Multipanel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoPanel", "::", "replaced"}], "=", 
   "\"\<AutoPanel (last used in LevelScheme 2.0) has been replaced with \
Panel.  Use SetRegion[] to turn off multipanel plotting.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeOrigin", "::", "deprecated"}], "=", 
   "\"\<SetSchemeOrigin (last used in LevelScheme 2.0) has been replaced with \
SetOrigin.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeScale", "::", "deprecated"}], "=", 
   "\"\<SetSchemeScale (last used in LevelScheme 2.0) has been replaced with \
SetScale.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeRegion", "::", "deprecated"}], "=", 
   "\"\<SetSchemeRegion (last used in LevelScheme 2.0) has been replaced with \
SetRegion.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetCoordinates", "::", "deprecated"}], "=", 
   "\"\<ResetCoordinates (last used in LevelScheme 3.21) has been absorbed \
into SetRegion.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemePoints", "::", "deprecated"}], "=", 
   "\"\<SchemePoints (last used in LevelScheme 3.21+ development version) has \
been absorbed into DataPlot.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Scheme", "::", "deprecated"}], "=", 
   "\"\<Scheme (last used in LevelScheme 3.21) has been replaced with Figure.\
\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.395523389484375*^9, {3.39663605815625*^9, 3.39663605871875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "abovekinkx"}], "=", 
   "\"\<The options AboveKinkL, AboveKinkR, and AboveKinkC (last used in \
LevelScheme 3.21) are no longer supported.  Please use SegmentL, SegmentR, \
and SegmentC instead.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.395519995734375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error messages", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "lsargs"}], "=", 
   "\"\<Missing or unexpected arguments in level scheme object `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "lsargsnull"}], "=", 
   "\"\<One of the arguments in `1` is Null.  Check for extra commas among \
the arguments.\>\""}], ";", 
  RowBox[{
   RowBox[{"LevelScheme", "::", "notinscheme"}], "=", 
   "\"\<Level scheme objects cannot be used outside of the function Scheme.  \
(If you are trying to save a list of level scheme objects for later use in a \
scheme, or to write a function which uses level scheme objects, use the \
SetDelayed symbol \\\":=\\\" for the assignment.)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "notreentrant"}], "=", 
   "\"\<Scheme is not reentrant.  It cannot be called within the object list \
given to Scheme.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "badparam"}], "=", 
   "\"\<Option `1` has invalid value `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "badvalue"}], "=", 
   "\"\<An invalid value `2` has been encountered for `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "badlevel"}], "=", 
   "\"\<A reference to an unrecognized level ID `1` has been \
encountered.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "badpoint"}], "=", 
   "\"\<A reference to an unrecognized point ID `1` has been \
encountered.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "::", "baddataset"}], "=", 
   "\"\<A reference to an unrecognized dataset ID `1` has been encountered.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScale", "::", "nonpositive"}], "=", 
   "\"\<User axis scale setting `1` is not positive.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetRegion", "::", "nonpositive"}], "=", 
   "\"\<User coordinate region setting `1` does not consist of positive \
intervals.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lev", "::", "energystr"}], "=", 
   "\"\<A string `2` has been specified as the level energy for a level \
(`1`), but this string cannot be converted to a number.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics", "::", "empty"}], "=", 
   "\"\<Empty graphics (Graphics[options___]) discarded.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics", "::", "multiarg"}], "=", 
   "\"\<Graphics with extra argument (Graphics[_,nonoption,options___]) \
discarded.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics", "::", "badpoint"}], "=", 
   "\"\<Encountered point coordinates (`1`) not a numerical pair or a valid \
Mathematica Scaled or Offset coordinate.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ViewPort3D", "::", "prange"}], "=", 
   "\"\<Option PlotRange cannot have value Automatic when AxisScaling \
specified.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigurePanel", "::", "badij"}], "=", 
   "\"\<A bad {row,column} index pair `1` has been specified for FigurePanel.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Scheme", "::", "prange"}], "=", 
   "\"\<No value specified for option PlotRange.  Assuming default value \
{{0,1},{0,1}}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Scheme", "::", "freegraphics"}], "=", 
   "\"\<A Mathematica graphics object was encountered among the objects in \
the list you gave to Scheme.  Did you wish the graphics to be displayed as \
part of the figure?  If so, enclose the graphics in RawGraphics (see \
LevelScheme user guide).  Otherwise Mathematica graphics objects (such as the \
output of plotting functions) are simply discarded by Scheme.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "::", "twoautos"}], "=", 
   "\"\<You cannot specify both initial and final horizontal positions as \
Automatic.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "args"}], "=", 
   "\"\<Missing or unexpected arguments in `1`.  (Check for missing or extra \
commas among the arguments.)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "kinks"}], "=", 
   "\"\<Kinks have been specified for an arrow type which does not support \
them.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "nullsegment"}], "=", 
   "\"\<An arrow cannot contain a line segment of zero length (canvas \
coordinates `1`).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "fromvert"}], "=", 
   "\"\<Position specified as FromTailVertical or FromHeadVertical on \
horizontal line segment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "fromhoriz"}], "=", 
   "\"\<Position specified as FromTailHorizontal or FromHeadHorizontal on \
vertical line segment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "horizbevel"}], "=", 
   "\"\<Cannot bevel tail of horizontal arrow.  (Set option \
TailBevel->False.)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "conversionlip"}], "=", 
   "\"\<For conversion-electron arrows, it is recommended that HeadLip be set \
to 0, yielding a cornerless arrowhead.  Otherwise, a misleading plot is \
obtained, since the corner of the arrowhead is still shaded even for \
vanishing conversion coefficient.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaTeXTableEntryValue", "::", "notnumeric"}], "=", 
   "\"\<LaTeX-style table entry `1` converts to `2`, which is not \
numeric.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeSquare", "::", "badr"}], "=", 
   "\"\<Unrecognized radius specification format `1`.\>\""}], ";", 
  RowBox[{
   RowBox[{"SchemeCircle", "::", "badr"}], "=", 
   "\"\<Unrecognized radius specification format `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "::", "oldsyntax"}], "=", 
   "\"\<Old syntax (LevelScheme 2.0) used for Multipanel.  Assuming value \
None for tick lists.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "::", "ambigticks"}], "=", 
   "\"\<Ambiguous whether `1` specifies the tick values for a single axis, to \
be repeated, or several axes.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "::", "num"}], "=", 
   "\"\<Incorrect number of `1` given.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "::", "autosizes"}], "=", 
   "\"\<Cannot generate `1` automatically if any of `2` are Automatic.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigurePanel", "::", "undefined"}], "=", 
   "\"\<FigurePanel[{row,column}] called when no multipanel plot \
defined.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetter", "::", "nopanel"}], "=", 
   "\"\<Cannot generate panel letter since not in multipanel plot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "noline"}], "=", 
   "\"\<No line found in graphics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "manylines"}], "=", 
   "\"\<More than one line found in graphics.  Only using first.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataPlot", "::", "baddata"}], "=", 
   "\"\<Ignoring invalid data set (`1`) encountered in DataPlot.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitX", "::", "badvalue"}], "=", 
   "\"\<Nonnumerical x value in data point (`1`).\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitY", "::", "badvalue"}], "=", 
   "\"\<Nonnumerical y value in data point (`1`).\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataPlot", "::", "badsymbol"}], "=", 
   "\"\<Symbol shape `1` unrecognized or improperly defined.  New symbols can \
be defined using DataSymbolShape.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.39509193859375*^9, {3.395092266484375*^9, 3.3950922706875*^9}, {
   3.395521246375*^9, 3.395521249125*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin private context", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PrivateContext", "=", "$Context"}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Section"],

Cell[CellGroupData[{

Cell[TextData[{
 "Load private packages and define pre-",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 6 legacy functions"
}], "Subsection",
 CellChangeTimes->{{3.3950910055*^9, 3.395091018765625*^9}}],

Cell["\<\
Private packages used only internally:
\tGraphics legacy package is for TransformGraphics.
\tBlockUnprotect` is used in restoring data set plotting options.\
\>", "Text",
 CellChangeTimes->{{3.39508867859375*^9, 3.395088684171875*^9}, {
  3.39508882375*^9, 3.395088834234375*^9}, {3.395089603546875*^9, 
  3.39508960509375*^9}, {3.395090977890625*^9, 3.39509098175*^9}}],

Cell["\<\
Note: Rotate2D[] rotation is CCW, so must negate angle to obtain CW rotation.\
\
\>", "Text",
 CellChangeTimes->{{3.3950909898125*^9, 3.39509099175*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LegacyFilterOptions", "[", 
    RowBox[{"f_Symbol", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"FilterRules", "[", 
     RowBox[{
      RowBox[{"{", "Opts", "}"}], ",", 
      RowBox[{"Options", "[", "f", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LegacyRotate2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", "phi_", ",", 
     RowBox[{"{", 
      RowBox[{"x0_", ",", "y0_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"-", "phi"}], ",", 
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0"}], "}"}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LegacyRotate2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", "phi_"}], "]"}], ":=", 
   RowBox[{"LegacyRotate2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "phi", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotationMatrix3D", "[", 
    RowBox[{"phi_", ",", "theta_", ",", "psi_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"Pi", "-", "psi"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{"theta", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"Pi", "-", "phi"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LegacyRegularPolygon", "[", 
     RowBox[{"n_", ",", " ", 
      RowBox[{"rad_:", "1"}], ",", " ", 
      RowBox[{"ctr_:", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"tilt_:", "0"}], ",", " ", 
      RowBox[{"k_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Line", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ctr", "+", 
         RowBox[{"rad", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"t", "+", "tilt"}], "]"}], ",", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", "+", "tilt"}], "]"}]}], "}"}]}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", " ", "0", ",", " ", 
          RowBox[{"2", "Pi"}], ",", " ", 
          RowBox[{"2", 
           RowBox[{"Pi", "/", "n"}]}]}], "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"NestList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"#", "+", "k"}], ",", "n", ",", "1"}], "]"}], "&"}], ",", 
        "1", ",", "n"}], "]"}], "\[RightDoubleBracket]"}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395088870203125*^9, 3.395088884796875*^9}, {
   3.395088918546875*^9, 3.395088949390625*^9}, 3.395089863421875*^9, {
   3.39509091809375*^9, 3.395090968*^9}, 3.39509102459375*^9, {
   3.395092686921875*^9, 3.395092704640625*^9}, {3.39509299859375*^9, 
   3.39509300584375*^9}, {3.395093119421875*^9, 3.39509314678125*^9}, 
   3.39509559921875*^9, {3.398544547875*^9, 3.3985445481875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<LegacyGraphics`\>\"", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<BlockUnprotect`\>\"", " ", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3950888423125*^9, 3.39508886715625*^9}, 
   3.395089608484375*^9, {3.39509040403125*^9, 3.395090412625*^9}, 
   3.39509097015625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Display greeting message", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GridBox", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "{", "\"\<LevelScheme scientific figure preparation system\>\"", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "{", "\"\<M. A. Caprio, Department of Physics, University of Notre \
Dame\>\"", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"RowBox", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Comput. Phys. Commun. \>\"", ",", 
            RowBox[{"textbf", "[", "\"\<171\>\"", "]"}], ",", 
            "\"\<, 107 (2005)\>\""}], "}"}], "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<Version \>\"", "<>", "$RevisionString"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"RowBox", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ButtonBox", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"StyleBox", "[", 
               RowBox[{"\"\<View color palette\>\"", ",", 
                RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ButtonNote", "->", "\"\<Named color palette\>\""}], 
              ",", 
              RowBox[{"ButtonFunction", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"NamedColorPalette", "[", "]"}], "&"}], ")"}]}], ",",
               
              RowBox[{"Active", "\[Rule]", "True"}], ",", 
              RowBox[{"ButtonFrame", "\[Rule]", "\"\<DialogBox\>\""}], ",", 
              RowBox[{"ButtonExpandable", "\[Rule]", "False"}], ",", 
              RowBox[{"Evaluator", "\[Rule]", "Automatic"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"MakeButtonForURL", "[", 
             RowBox[{
              RowBox[{"StyleBox", "[", 
               RowBox[{"\"\<Visit home page\>\"", ",", 
                RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], ",", 
              "$HomePageURL", ",", 
              RowBox[{"ButtonFrame", "\[Rule]", "\"\<DialogBox\>\""}], ",", 
              RowBox[{"ButtonExpandable", "\[Rule]", "False"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ColumnAlignments", "\[Rule]", "Left"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "DisplayForm"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.395089143765625*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
     "LevelScheme", " ", "scientific", " ", "figure", " ", "preparation", " ",
       "system"}]},
    {
     RowBox[{
      RowBox[{"M", ".", " ", "A", ".", " ", "Caprio"}], ",", " ", 
      RowBox[{"Department", " ", "of", " ", "Physics"}], ",", " ", 
      RowBox[{"University", " ", "of", " ", "Notre", " ", "Dame"}]}]},
    {
     RowBox[{
      RowBox[{"Comput", ".", " ", "Phys", ".", " ", "Commun", ".", " "}], 
      TagBox[
       StyleBox["\<\"171\"\>",
        FontWeight->"Bold"],
       StyleForm[#, FontWeight -> "Bold"]& ], 
      RowBox[{",", " ", 
       RowBox[{"107", " ", 
        RowBox[{"(", "2005", ")"}]}]}]}]},
    {
     RowBox[{"Version", " ", "3.30", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"July", " ", "18"}], ",", " ", "2007"}], ")"}]}]},
    {
     RowBox[{
      ButtonBox[
       StyleBox[
        RowBox[{"View", " ", "color", " ", "palette"}],
        FontFamily->"Times"],
       Active->True,
       ButtonFrame->"DialogBox",
       ButtonFunction:>(LevelScheme`Private`NamedColorPalette[]& ),
       ButtonNote->"Named color palette",
       Evaluator->Automatic,
       ImageSize->Automatic], 
      TagBox[
       ButtonBox[
        StyleBox[
         RowBox[{"Visit", " ", "home", " ", "page"}],
         FontFamily->"Times"],
        Active->True,
        ButtonData:>{
          URL[
          "http://wnsl.physics.yale.edu/levelscheme/notebook_entrance_3.30.\
html"], None},
        ButtonFrame->"DialogBox",
        ButtonFunction:>(FrontEndExecute[{
           FrontEnd`NotebookLocate[#2]}]& ),
        ButtonNote->
         "http://wnsl.physics.yale.edu/levelscheme/notebook_entrance_3.30.\
html",
        ImageSize->Automatic],
       DisplayForm]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  DisplayForm]], "Print",
 CellChangeTimes->{{3.395090214484375*^9, 3.39509021740625*^9}, 
   3.395090432625*^9, 3.395090781125*^9, 3.395091240984375*^9, 
   3.39509199109375*^9, 3.395092507453125*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global constants", "Subsection"],

Cell["Drawing layers", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$SchemeBackgroundLayer", "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SchemeDrawingLayer", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SchemeBlankingLayer", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SchemeTextLayer", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Flag to prevent evaluation of scheme objects outside of a scheme\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$InScheme", "=", "False"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Option definitions", "Section"],

Cell[CellGroupData[{

Cell["Option scoping symbol lists", "Subsection"],

Cell["\<\
List of symbols for which options should be dynamically scoped\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OptionSymbols", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"from", " ", "LevelScheme"}], " ", "*)"}], "\[IndentingNewLine]",
     
    RowBox[{
    "SchemeObject", ",", "Lev", ",", "ExtensionLine", ",", "Connector", ",", 
     "Trans", ",", "ManualLabel", ",", "ScaledLabel", ",", "BandLabel", ",", 
     "LevelLabel", ",", "SchemeBracket", ",", "\[IndentingNewLine]", 
     "SchemeLine", ",", "SchemePoints", ",", "SchemePolygon", ",", 
     "SchemeBox", ",", "SchemeSquare", ",", "SchemeCircle", ",", 
     "SchemeEllipse", ",", "SchemeArrow", ",", "\[IndentingNewLine]", 
     "RawGraphics", ",", "ViewPort3D", ",", "ScaledViewPort3D", ",", 
     "\[IndentingNewLine]", "FigurePanel", ",", "ScaledFigurePanel", ",", 
     "Multipanel", ",", "SchemeAxis", ",", "PanelLetter", ",", 
     "\[IndentingNewLine]", "LineStyle", ",", "FillStyle", ",", 
     "\[IndentingNewLine]", "AttachIndex", ",", "\[IndentingNewLine]", 
     "DataPlot", ",", "DataTag", ",", "SaveDataStyle", ",", "SetDataStyle", 
     ",", "DataLabel", ",", "DataTransformation", ",", "DataLine", ",", 
     "DataSymbol", ",", "DataLegend", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "external", " ", "*)"}], "\[IndentingNewLine]", 
     "LinTicks", ",", "LogTicks"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OptionSymbols3D", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "ManualLabel3D", ",", "SchemeLine3D", ",", "SchemeArrow3D", ",", 
     "RawGraphics3D"}], "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3950919401875*^9, 3.395091940671875*^9}, {
  3.395092273328125*^9, 3.395092273953125*^9}, {3.395521251203125*^9, 
  3.39552125121875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shorthand list definitions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BasicOpts", "=", 
   RowBox[{"{", 
    RowBox[{
    "Show", ",", "Color", ",", "Opacity", ",", "Layer", ",", 
     "ClipToRectangle"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"OutlineOpts", "=", 
   RowBox[{"{", 
    RowBox[{
    "ShowLine", ",", "LineColor", ",", "LineOpacity", ",", "Thickness", ",", 
     "Dashing", ",", "DashingGap", ",", "DashingCorrection"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TickOutlineOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TickShowLine", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickLineColor", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickLineOpacity", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickThickness", "\[Rule]", "Automatic"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"FillOpts", "=", 
   RowBox[{"{", 
    RowBox[{"ShowFill", ",", "FillColor", ",", "FillOpacity"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"BackgroundOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Background", "\[Rule]", "None"}], ",", 
     RowBox[{"BackgroundOpacity", "\[Rule]", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TextOpts", "=", 
   RowBox[{"{", 
    RowBox[{
    "FontFamily", ",", "FontSize", ",", "FontWeight", ",", "FontSlant", ",", 
     "FontTracking", ",", "FontColor", ",", "FontOpacity", ",", 
     "BackgroundFontSizeFactor"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TickTextOpts", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TickFontFamily", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickFontSize", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickFontWeight", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickFontSlant", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickFontTracking", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TickFontColor", "->", "Automatic"}], ",", 
     RowBox[{"TickFontOpacity", "->", "Automatic"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PanelLetterTextOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PanelLetterFontFamily", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontSize", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontWeight", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontSlant", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontTracking", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontColor", "->", "Automatic"}], ",", 
     RowBox[{"PanelLetterFontOpacity", "->", "Automatic"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PanelLetterOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShowPanelLetter", "\[Rule]", "True"}], ",", 
     RowBox[{"PanelLetterOffset", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PanelLetterCorner", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
     RowBox[{"PanelLetterNudge", "\[Rule]", "0"}], ",", 
     RowBox[{"PanelLetterOrientation", "->", "Automatic"}], ",", 
     RowBox[{"PanelLetterBackground", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LabLOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabL", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabL", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetL", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeL", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationL", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundL", "\[Rule]", "None"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabROpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabR", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabR", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetR", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeR", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationR", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundR", "\[Rule]", "None"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabTOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabT", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabT", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetT", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeT", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationT", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundT", "\[Rule]", "None"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabBOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabB", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabB", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetB", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeB", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationB", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundB", "\[Rule]", "None"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabCOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabC", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabC", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetC", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeC", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationC", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundC", "\[Rule]", "None"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabXOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LabX", "\[Rule]", "None"}], ",", 
     RowBox[{"ShowLabX", "\[Rule]", "True"}], ",", 
     RowBox[{"OffsetX", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"NudgeX", "\[Rule]", "0"}], ",", 
     RowBox[{"OrientationX", "->", "Automatic"}], ",", 
     RowBox[{"BackgroundX", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LabOpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShowText", "\[Rule]", "True"}], ",", 
     RowBox[{"Offset", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Nudge", "\[Rule]", "0"}], ",", 
     RowBox[{"Orientation", "->", "Automatic"}], ",", 
     RowBox[{"Background", "\[Rule]", "None"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3955199989375*^9, 3.395519999421875*^9}, {
  3.396634439375*^9, 3.396634476921875*^9}, {3.39663466884375*^9, 
  3.396634696140625*^9}, {3.396636778984375*^9, 3.396636795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InheritanceMode", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TrapUninheritableOptions", "\[Rule]", "True"}], ",", 
     RowBox[{"TrapUnknownOptions", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic parent object", "Subsection"],

Cell[TextData[{
 "Default font family\n\tUse of \"Times New Roman\" instead of \"Times\" \
under MS Windows seems to cause much lower rate of drawing glitches, at least \
under ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 4.1 front end."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$DefaultFontFamily", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$SystemID", "==", "\"\<Windows\>\""}], ",", 
     "\"\<Times New Roman\>\"", ",", "\"\<Times\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeObject", ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Overall", " ", "color"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Color", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Opacity", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ShowLine", "\[Rule]", "True"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"LineColor", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"LineOpacity", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Thickness", "\[Rule]", "1"}], ",", 
      RowBox[{"Dashing", "\[Rule]", "None"}], ",", 
      RowBox[{"DashingGap", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"DashingCorrection", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Fill", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ShowFill", "\[Rule]", "True"}], ",", " ", 
      RowBox[{"FillColor", "->", "Automatic"}], ",", 
      RowBox[{"FillOpacity", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Text", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FontFamily", "\[Rule]", "$DefaultFontFamily"}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
      RowBox[{"FontWeight", "->", "\"\<Plain\>\""}], ",", 
      RowBox[{"FontSlant", "->", "\"\<Plain\>\""}], ",", 
      RowBox[{"FontTracking", " ", "->", "\"\<Plain\>\""}], ",", 
      RowBox[{"FontColor", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FontOpacity", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"BackgroundFontSizeFactor", "\[Rule]", "1.0"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"General", " ", "rendering"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Layer", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ClipToRectangle", "\[Rule]", "True"}]}], "\[IndentingNewLine]",
      "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39552000415625*^9, 3.395520009109375*^9}, {
  3.396634483765625*^9, 3.396634488359375*^9}, {3.3966347294375*^9, 
  3.3966347504375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Level objects", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"Lev", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Line", " ", "geometry", " ", "margin"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Margin", "\[Rule]", "0.1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"EnergyNudge", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", "LabROpts", ",", "LabTOpts", ",", "LabBOpts", ",", 
      "LabCOpts", ",", "\[IndentingNewLine]", 
      RowBox[{"EnergyLabelFunction", "\[Rule]", "Identity"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Gull", " ", "wings"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"WingHeight", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"WingRiseWidth", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"WingTipWidth", "\[Rule]", "30"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeWingL", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeWingR", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Layer", " ", "override"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LineToFront", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ExtensionLine", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extension", " ", "line", " ", "endpoint", " ", "coordinates"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ToWing", "\[Rule]", "True"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"Connector", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", "}"}], ",", "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition arrow objects", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"Trans", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrow", " ", "shape", " ", "properties"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArrowType", "\[Rule]", "LineArrow"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowHalf", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Width", " ", "\[Rule]", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TailBevel", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShaftLines", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SquiggleBuffer", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"SquiggleWavelength", "\[Rule]", "10"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SquiggleSide", "\[Rule]", "Right"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotPoints", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Kink", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "True"}], ",", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Conversion", " ", "fill", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionColor", "\[Rule]", "White"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionSide", "\[Rule]", "Right"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionCoeff", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkL", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentL", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkR", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentR", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabCOpts", ",", 
      RowBox[{"PosnC", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkC", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentC", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Endpoint", " ", "coordinates", " ", "when", " ", "between", " ", 
        "levels"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"EndPositions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FromWing", "\[Rule]", "False"}], ",", 
      RowBox[{"ToWing", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Label objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ManualLabel", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", "LabOpts", "}"}], ",", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ScaledLabel", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", "LabOpts", "}"}], ",", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"BandLabel", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", "LabOpts", "}"}], ",", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"LevelLabel", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"LabOpts", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Callout", " ", "line", " ", "control"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CallOutVector", "\[Rule]", "None"}], ",", 
      RowBox[{"Gap", "\[Rule]", "0"}]}], " ", "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", "\[IndentingNewLine]", 
   RowBox[{"ManualLabel3D", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Offset", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Nudge", "\[Rule]", "0"}], ","}], "*)"}], 
      RowBox[{"Orientation", "->", "Automatic"}], ",", 
      RowBox[{"ShowText", "\[Rule]", "True"}], ",", 
      RowBox[{"Background", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing shape objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeLine", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrow", " ", "shape", " ", "properties"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "False"}], ",", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"BufferL", "\[Rule]", "Automatic"}], ","}], "*)"}], 
      "\[IndentingNewLine]", "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"BufferR", "\[Rule]", "Automatic"}], ","}], "*)"}], 
      "\[IndentingNewLine]", "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabCOpts", ",", 
      RowBox[{"PosnC", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemePoints", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "FillOpts"}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SymbolSize", "\[Rule]", "2.5"}], ",", 
      RowBox[{"SymbolShape", "\[Rule]", "\"\<Circle\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "16"}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";", 
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemePolygon", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "FillOpts"}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", "}"}], ",", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeCircle", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrow", " ", "shape", " ", "properties"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "False"}], ",", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", "LabROpts", ",", "LabTOpts", ",", "LabBOpts", ",", 
      "LabCOpts", ",", "LabXOpts", ",", 
      RowBox[{"BufferX", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PosnX", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeEllipse", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plotting", " ", "control"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotPoints", "\[Rule]", "90"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Arrow", " ", "shape", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "False"}], ",", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", "LabROpts", ",", "LabTOpts", ",", "LabBOpts", ",", 
      "LabCOpts", ",", "LabXOpts", ",", 
      RowBox[{"BufferX", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PosnX", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeBox", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "LabLOpts", ",", "LabROpts", ",", "LabTOpts", ",", "LabBOpts", ",", 
      "LabCOpts"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeSquare", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "LabLOpts", ",", "LabROpts", ",", "LabTOpts", ",", "LabBOpts", ",", 
      "LabCOpts"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeArrow", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrow", " ", "shape", " ", 
       RowBox[{"properties", " ", "--"}], " ", "default", " ", "for", " ", 
       "TailBevel", " ", "differs", " ", "from", " ", "Trans"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArrowType", "\[Rule]", "LineArrow"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowHalf", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Width", " ", "\[Rule]", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TailBevel", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShaftLines", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SquiggleBuffer", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"SquiggleWavelength", "\[Rule]", "10"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SquiggleSide", "\[Rule]", "Right"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotPoints", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Kink", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "True"}], ",", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Conversion", " ", "fill", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionColor", "\[Rule]", "White"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionSide", "\[Rule]", "Right"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ConversionCoeff", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkL", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentL", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkR", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentR", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabCOpts", ",", 
      RowBox[{"PosnC", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"AboveKinkC", "\[Rule]", "False"}], ",", 
      RowBox[{"SegmentC", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeBracket", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrowhead", " ", "control"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HeadLength", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeLine3D", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Color", ",", "Opacity", ",", "Show"}], "}"}], ",", 
        "OutlineOpts"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeArrow3D", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Color", ",", "Opacity", ",", "Show"}], "}"}], ",", 
        "OutlineOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrow", " ", "shape", " ", "properties"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArrowType", "\[Rule]", "LineArrow"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"HeadLength", "\[Rule]", "0.1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "0.1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTail", "\[Rule]", "False"}], ",", 
      RowBox[{"ShowHead", "\[Rule]", "True"}], " ", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabCOpts", ",", 
      RowBox[{"PosnC", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396634772359375*^9, 3.3966347775*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Raw graphics objects", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"RawGraphics", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{
       "Color", ",", "Opacity", ",", "Thickness", ",", "Dashing", ",", 
        "DashingGap", ",", "DashingCorrection", ",", "Show", ",", "Layer", 
        ",", "ClipToRectangle"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "UNDOCUMENTED", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Debug", "\[Rule]", "False"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"RawGraphics3D", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{
       "Color", ",", "Opacity", ",", "Thickness", ",", "Dashing", ",", 
        "DashingGap", ",", "DashingCorrection", ",", "Show"}], "}"}]}], "}"}],
     ",", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "UNDOCUMENTED", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Debug", "\[Rule]", "False"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ViewPort3D", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{"Show", ",", "Layer"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fill", " ", 
       RowBox[{"control", " ", "--"}], " ", "differs", " ", "from", " ", 
       RowBox[{"Color", "/", "FillColor"}], " ", "and", " ", "ShowFill", " ", 
       "convention", " ", "of", " ", "other", " ", "objects"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
     "BackgroundOpts", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Option", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]",
       
      RowBox[{"BlockOptions", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3", "D", " ", "display", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"EulerRotation", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AxisScaling", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Complement", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Options", "[", "Graphics3D", "]"}], ",", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Options", "[", "Graphics3D", "]"}], ",", 
          RowBox[{"x", ":", 
           RowBox[{"(", 
            RowBox[{"Background", "\[Rule]", "_"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "UNDOCUMENTED", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Debug", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ScaledViewPort3D", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{"Show", ",", "Layer"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fill", " ", 
       RowBox[{"control", " ", "--"}], " ", "differs", " ", "from", " ", 
       RowBox[{"Color", "/", "FillColor"}], " ", "and", " ", "ShowFill", " ", 
       "convention", " ", "of", " ", "other", " ", "objects"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
     "BackgroundOpts", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Option", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]",
       
      RowBox[{"BlockOptions", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3", "D", " ", "display", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"EulerRotation", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AxisScaling", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Complement", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Options", "[", "Graphics3D", "]"}], ",", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Options", "[", "Graphics3D", "]"}], ",", 
          RowBox[{"x", ":", 
           RowBox[{"(", 
            RowBox[{"Background", "\[Rule]", "_"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "UNDOCUMENTED", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Debug", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395091941515625*^9, 3.3950919419375*^9}, {
  3.395520016171875*^9, 3.39552002559375*^9}, {3.396634782765625*^9, 
  3.396634792140625*^9}, {3.396636698796875*^9, 3.39663673590625*^9}, {
  3.396636814265625*^9, 3.39663682515625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axes and panels", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"PanelLetter", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Order", "\[Rule]", "Horizontal"}], ",", 
      RowBox[{"First", "->", "\"\<a\>\""}], ",", 
      RowBox[{"Format", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"FigurePanel", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Color", ",", "Opacity", ",", "Show", ",", "Layer"}], "}"}], 
        ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"PanelLetter", ",", "All"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Panel", " ", "coordinate", " ", "range"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"XPlotRange", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"YPlotRange", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtendRange", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Panel", " ", "geometry", " ", 
        RowBox[{"adjustments", " ", "--"}], " ", "in", " ", "Multipanel", " ",
         "array", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PanelShift", "\[Rule]", "None"}], ",", 
      RowBox[{"PanelAdjustments", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Fill", " ", 
        RowBox[{"control", " ", "--"}], " ", "differs", " ", "from", " ", 
        RowBox[{"Color", "/", "FillColor"}], " ", "and", " ", "ShowFill", " ",
         "convention", " ", "of", " ", "other", " ", "objects"}], " ", "*)"}],
       "\[IndentingNewLine]", "BackgroundOpts", ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Frame", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowEdge", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "label", " ", "control"}], " ", "*)"}], 
      "\[IndentingNewLine]", "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"FrameLabel", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowFrameLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Panel", " ", "letter", " ", "control"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"PanelLetter", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"PanelLetterInset", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"15", ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "PanelLetterTextOpts", ",", "\[IndentingNewLine]", "PanelLetterOpts", 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Frame", " ", "ticks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"ShowTickLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"TickNudge", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "TickTextOpts", ",", "\[IndentingNewLine]", 
      "TickOutlineOpts"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"ScaledFigurePanel", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Color", ",", "Opacity", ",", "Show", ",", "Layer"}], "}"}], 
        ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"PanelLetter", ",", "All"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Panel", " ", "coordinate", " ", "range"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"XPlotRange", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"YPlotRange", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtendRange", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Panel", " ", "geometry", " ", 
        RowBox[{"adjustments", " ", "--"}], " ", "in", " ", "Multipanel", " ",
         "array", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"not", " ", "applicable", " ", "to", " ", "ScaledPanel"}], " ",
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Fill", " ", 
        RowBox[{"control", " ", "--"}], " ", "differs", " ", "from", " ", 
        RowBox[{"Color", "/", "FillColor"}], " ", "and", " ", "ShowFill", " ",
         "convention", " ", "of", " ", "other", " ", "objects"}], " ", "*)"}],
       "\[IndentingNewLine]", "BackgroundOpts", ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Frame", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowEdge", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "label", " ", "control"}], " ", "*)"}], 
      "\[IndentingNewLine]", "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"FrameLabel", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowFrameLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Panel", " ", "letter", " ", "control"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"PanelLetter", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"PanelLetterInset", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"15", ",", 
         RowBox[{"-", "15"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      "PanelLetterTextOpts", ",", "\[IndentingNewLine]", "PanelLetterOpts", 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Frame", " ", "ticks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"ShowTickLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"TickNudge", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "TickTextOpts", ",", "\[IndentingNewLine]", 
      "TickOutlineOpts"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"Multipanel", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"FigurePanel", ",", "\[IndentingNewLine]", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"Options", "[", "FigurePanel", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
         "PlotRange", ",", "XPlotRange", ",", "YPlotRange", ",", "LabB", ",", 
          "LabL", ",", "LabT", ",", "LabR", ",", "FrameLabel", ",", 
          "FrameTicks", ",", "PanelLetter"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Geometry", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XPanelSizes", "\[Rule]", "1"}], ",", 
      RowBox[{"YPanelSizes", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XGapSizes", "\[Rule]", "0"}], ",", 
      RowBox[{"YGapSizes", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XMarginSizes", "\[Rule]", "0"}], ",", 
      RowBox[{"YMarginSizes", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Margin", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Panel", " ", "appearance"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"XPlotRanges", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"YPlotRanges", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"XFrameLabels", "\[Rule]", "None"}], ",", 
      RowBox[{"YFrameLabels", "\[Rule]", "None"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"XFrameTicks", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"YFrameTicks", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowFrameLabelsExterior", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ShowFrameLabelsInterior", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTickLabelsExterior", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTickLabelsInterior", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
        "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SchemeAxis", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "TextOpts"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Arrowhead", " ", "control"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ShowHead", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLength", "\[Rule]", "9"}], ",", "\[IndentingNewLine]", 
      RowBox[{"HeadLip", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Label", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferL", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferR", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Frame", " ", "ticks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ticks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTicks", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ShowTickLabels", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TickNudge", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      "TickTextOpts", ",", "\[IndentingNewLine]", "TickOutlineOpts"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "InheritanceMode"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3950922848125*^9, 3.395092301375*^9}, 
   3.395092333765625*^9, {3.39552125125*^9, 3.3955212513125*^9}, {
   3.39663481503125*^9, 3.396634824703125*^9}, {3.396636743921875*^9, 
   3.396636744609375*^9}, {3.39663682884375*^9, 3.39663683403125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data plotting", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"AttachIndex", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"First", "\[Rule]", "1"}], ",", 
      RowBox[{"ScaleFactor", "\[Rule]", "1"}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataPlot", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ShowData", "\[Rule]", "True"}], ",", 
      RowBox[{"Debug", "\[Rule]", "False"}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataTag", ",", 
    RowBox[{"{", "}"}], ",", "InheritanceMode"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SaveDataStyle", ",", 
    RowBox[{"{", 
     RowBox[{"Debug", "\[Rule]", "False"}], "}"}], ",", "InheritanceMode"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"SetDataStyle", ",", 
    RowBox[{"{", 
     RowBox[{"Debug", "\[Rule]", "False"}], "}"}], ",", "InheritanceMode"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataLabel", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "TextOpts"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"LabLOpts", ",", 
      RowBox[{"PosnL", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      "LabROpts", ",", 
      RowBox[{"PosnR", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      "LabTOpts", ",", 
      RowBox[{"PosnT", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferT", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabBOpts", ",", 
      RowBox[{"PosnB", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"BufferB", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]",
       "LabCOpts", ",", 
      RowBox[{"PosnC", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataLine", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LineShape", "\[Rule]", "\"\<Straight\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "3"}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataSymbol", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{"BasicOpts", ",", "OutlineOpts", ",", "FillOpts"}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SymbolSize", "\[Rule]", "2.5"}], ",", 
      RowBox[{"SymbolShape", "\[Rule]", "\"\<Circle\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "16"}]}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataTransformation", ",", 
    RowBox[{"{", 
     RowBox[{"DataFilters", "\[Rule]", "None"}], "}"}], ",", 
    "InheritanceMode"}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"DataLegend", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BasicOpts", ",", "OutlineOpts", ",", "FillOpts", ",", "TextOpts"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"LabOpts", ",", 
      RowBox[{"Length", "\[Rule]", "10"}], ",", 
      RowBox[{"Gap", "\[Rule]", "5"}], ",", 
      RowBox[{"LineSpacing", "\[Rule]", "1.1"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "InheritanceMode"}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Figure display", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"Figure", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Color", ",", "Opacity"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LineColor", ",", "LineOpacity", ",", "Thickness", ",", "Dashing", 
          ",", "DashingGap", ",", "DashingCorrection"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "FontFamily", ",", "FontSize", ",", "FontWeight", ",", "FontSlant", 
          ",", "FontTracking", ",", "FontColor", ",", "FontOpacity"}], 
         "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "inherited", " ", "outline", " ", "and", " ", "text", " ", "options", 
       " ", "control", " ", "frame", " ", "line", " ", "and", " ", "labels", 
       " ", "but", " ", "not", " ", "frame", " ", "ticks"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plot", " ", "region", " ", "control"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtendRange", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Axes", " ", "and", " ", "frame", " ", "control"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Frame", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LabB", "\[Rule]", "None"}], ",", 
      RowBox[{"LabL", "\[Rule]", "None"}], ",", 
      RowBox[{"LabT", "\[Rule]", "None"}], ",", 
      RowBox[{"LabR", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Tick", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ticks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      "TickTextOpts", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TickOutlineOpts", " ", "not", " ", "supported"}], " ", "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Rendering", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Background", "\[Rule]", "None"}], ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"BackgroundOpacity", " ", "not", " ", "supported"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Option", " ", "control"}], " ", "*)"}], "\[IndentingNewLine]",
       
      RowBox[{"BlockOptions", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Conditional", " ", "inclusion"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeFlags", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"UNDOCUMENTED", " ", "debugging", " ", "options"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Information", "\[Rule]", "False"}], ",", "\[IndentingNewLine]",
       
      RowBox[{"Debug", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395089240171875*^9, 3.395089242*^9}, {
  3.395520033515625*^9, 3.39552003390625*^9}, {3.396634492796875*^9, 
  3.396634496671875*^9}, {3.39663483340625*^9, 3.396634847453125*^9}, {
  3.396636853234375*^9, 3.3966368624375*^9}, {3.396637299125*^9, 
  3.396637317609375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"LineStyle", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{
       "Color", ",", "Opacity", ",", "LineColor", ",", "LineOpacity", ",", 
        "Thickness", ",", "Dashing", ",", "DashingGap", ",", 
        "DashingCorrection"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineOptions", "[", 
   RowBox[{"FillStyle", ",", 
    RowBox[{"{", 
     RowBox[{"SchemeObject", ",", 
      RowBox[{"{", 
       RowBox[{
       "Color", ",", "Opacity", ",", "FillColor", ",", "FillOpacity"}], 
       "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "InheritanceMode"}], 
   "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520038015625*^9, 3.39552003846875*^9}, {
  3.39663485534375*^9, 3.396634875828125*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coordinate system arithmetic", "Section"],

Cell[CellGroupData[{

Cell["Coordinate arithmetic definitions", "Subsection"],

Cell["\<\
Global coordinate system parameters
   $AbsSize={x size,y size}
   $P1C={x1C,y1C};$P2C={x2C,y2C}     equivalent to \
$CanvasRange={{x1C,x2C},{y1C,y2C}}
   $P3C={x3C,y3C};$P4C={x4C,y4C}     equivalent to \
$RegionRange={{x3C,x4C},{y3C,y4C}} 
   $P3R={x3R,y3R};$P4R={x4R,y4R}\
\>", "Text"],

Cell["Coordinate system nomenclature", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoordinateSystems", "=", 
   RowBox[{"{", 
    RowBox[{
    "CanvasCoords", ",", "AbsoluteCoords", ",", "RegionCoords", ",", 
     "ScaledCoords", ",", "UserCoords"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemAbbreviation", "[", "CanvasCoords", "]"}], "=", 
   "\"\<C\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemAbbreviation", "[", "AbsoluteCoords", "]"}], "=", 
   "\"\<A\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemAbbreviation", "[", "RegionCoords", "]"}], "=", 
   "\"\<R\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemAbbreviation", "[", "ScaledCoords", "]"}], "=", 
   "\"\<S\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemAbbreviation", "[", "UserCoords", "]"}], "=", 
   "\"\<U\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateSystemQ", "[", "SystemA_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"CoordinateSystems", ",", "SystemA"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Set up special context for coordinate arithmetic variables
\tThe following code serves to establish the symbols CoordA and CoordB and \
the symbols for shorthand conversion functions in a separate context \
LevelScheme`Coord`.
\tThe definition of ConversionFunctionSymbols, it is necessary that the \
symbols for the shorthand functions have no values associated yet, so that \
when ToExpression is applied to the name strings it evaluates just to the \
symbols, not to actual function definitions.  The check on \
ValueQ[ConversionFunctionSymbols] is so that if the package is loaded over \
itself, any leftover values will not cause the definition to fail.
\tHoldPattern facilitates use on LHS of assignment in DefineCoordinates.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Hold", "[", "LevelScheme`Coord`CoordA", "]"}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hold", "[", "LevelScheme`Coord`CoordB", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ConversionFunctionSymbols", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ConversionFunctionSymbols", "=", 
     RowBox[{"HoldPattern", "/@", 
      RowBox[{"ToExpression", "/@", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"TableForEach", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<P\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<P\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<X\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<X\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<Y\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<Y\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<DP\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<P\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<DX\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<X\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<LevelScheme`Coord`\>\"", "<>", "\"\<DY\>\"", "<>", 
             RowBox[{"CoordinateSystemAbbreviation", "[", "SystemG", "]"}], 
             "<>", "\"\<Of\>\"", "<>", "\"\<Y\>\"", "<>", 
             RowBox[{
             "CoordinateSystemAbbreviation", "[", "SystemF", "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"SystemF", ",", "CoordinateSystems"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"SystemG", ",", "CoordinateSystems"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$ContextPath", ",", "\"\<LevelScheme`Coord`\>\""}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Generic conversion function
\tCoordinates must be defined as _ rather than _?NumericQ for proper creation \
of compiled functions below.  This allows pattern matching to occur when \
referenced inside Evalute with still symbolic arguments, so a compilable \
algebraic expression results.  In compiled expression, point must be given as \
explicit coordinate pair rather than single symbol to prevent erroneous \
threading of multiplication.\
\>", "Text",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", "C"}], ",", 
     RowBox[{"PF", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CoordA", "[", 
     RowBox[{"SystemF", ",", "SystemG"}], "]"}], "+", 
    RowBox[{
     RowBox[{"CoordB", "[", 
      RowBox[{"SystemF", ",", "SystemG"}], "]"}], "*", "PF"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", "D"}], ",", 
     RowBox[{"PF", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CoordB", "[", 
     RowBox[{"SystemF", ",", "SystemG"}], "]"}], "*", "PF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", "C"}], ",", "x_", ",", 
     RowBox[{"Index", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordA", "[", 
      RowBox[{"SystemF", ",", "SystemG"}], "]"}], "[", 
     RowBox[{"[", "Index", "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"CoordB", "[", 
       RowBox[{"SystemF", ",", "SystemG"}], "]"}], "[", 
      RowBox[{"[", "Index", "]"}], "]"}], "*", "x"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{"SystemF_", ",", "SystemG_", ",", 
     RowBox[{"Type", ":", "D"}], ",", "x_", ",", 
     RowBox[{"Index", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordB", "[", 
      RowBox[{"SystemF", ",", "SystemG"}], "]"}], "[", 
     RowBox[{"[", "Index", "]"}], "]"}], "*", "x"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", 
      RowBox[{"(", 
       RowBox[{"C", "|", "D"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RF1", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], ",", 
       RowBox[{"RF2", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ConvertCoordinate", "[", 
      RowBox[{"SystemF", ",", "SystemG", ",", "Type", ",", "RF1", ",", "1"}], 
      "]"}], ",", 
     RowBox[{"ConvertCoordinate", "[", 
      RowBox[{"SystemF", ",", "SystemG", ",", "Type", ",", "RF2", ",", "2"}], 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCoordinate", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", 
      RowBox[{"(", 
       RowBox[{"C", "|", "D"}], ")"}]}], ",", 
     RowBox[{"RF", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], ",", 
     RowBox[{"Index", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvertCoordinate", "[", 
      RowBox[{
      "SystemF", ",", "SystemG", ",", "Type", ",", "#", ",", "Index"}], "]"}],
      "&"}], "/@", "RF"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConvertRange", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", 
      RowBox[{"(", 
       RowBox[{"C", "|", "D"}], ")"}]}], ",", 
     RowBox[{"RF", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Index", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConvertCoordinate", "[", 
        RowBox[{
        "SystemF", ",", "SystemG", ",", "Type", ",", "#", ",", "Index"}], 
        "]"}], "&"}], ")"}], ",", "RF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertRegion", "[", 
    RowBox[{
     RowBox[{"SystemF_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"SystemG_", "?", "CoordinateSystemQ"}], ",", 
     RowBox[{"Type", ":", 
      RowBox[{"(", 
       RowBox[{"C", "|", "D"}], ")"}]}], ",", 
     RowBox[{"RF", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConvertRange", "[", 
        RowBox[{"SystemF", ",", "SystemG", ",", "Type", ",", "#1", ",", 
         RowBox[{"First", "[", "#2", "]"}]}], "]"}], "&"}], ")"}], ",", 
     "RF"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Point saving and retrieval", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SavePoint", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"GivenSystem", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "CoordinateSystemQ"}], ")"}], ":", 
       "UserCoords"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckValue", "[", 
       RowBox[{"ID", ",", 
        RowBox[{"_", "?", "LevelIdentifierQ"}], ",", 
        "\"\<a point identifier symbol (cannot be list or number)\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`P", "[", "ID", "]"}], "=", 
       RowBox[{"ConvertCoordinate", "[", 
        RowBox[{"GivenSystem", ",", "CanvasCoords", ",", "C", ",", "P"}], 
        "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GetPoint", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"GivenSystem", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "CoordinateSystemQ"}], ")"}], ":", 
       "UserCoords"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckPoint", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ConvertCoordinate", "[", 
       RowBox[{"CanvasCoords", ",", "GivenSystem", ",", "C", ",", 
        RowBox[{"LevelScheme`Data`P", "[", "ID", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Coordinate system implementation
\t- calculating conversion constants
\t- defining shorthand functions\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DefineCoordinates", "[", 
    RowBox[{
    "AbsSize_List", ",", "P1C_List", ",", "P2C_List", ",", "P3C_List", ",", 
     "P4C_List", ",", "P3R_List", ",", "P4R_List", ",", "AUR_List", ",", 
     "BUR_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "SystemF", ",", "SystemG", ",", "FunctionNameStrings", ",", "P", ",", 
       "X", ",", "Y"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "define", " ", "conversion", " ", "constants", " ", "to", " ", "canvas",
        " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"CoordA", "[", 
        RowBox[{"CanvasCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordB", "[", 
        RowBox[{"CanvasCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1."}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordA", "[", 
        RowBox[{"AbsoluteCoords", ",", "CanvasCoords"}], "]"}], "=", "P1C"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordB", "[", 
        RowBox[{"AbsoluteCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"P2C", "-", "P1C"}], ")"}], "/", "AbsSize"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordA", "[", 
        RowBox[{"RegionCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"P3C", "-", 
        RowBox[{"P3R", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"P4C", "-", "P3C"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"P4R", "-", "P3R"}], ")"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordB", "[", 
        RowBox[{"RegionCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"P4C", "-", "P3C"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"P4R", "-", "P3R"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordA", "[", 
        RowBox[{"ScaledCoords", ",", "CanvasCoords"}], "]"}], "=", "P3C"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordB", "[", 
        RowBox[{"ScaledCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"P4C", "-", "P3C"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordA", "[", 
        RowBox[{"UserCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"P3C", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"AUR", "-", "P3R"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"P4C", "-", "P3C"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"P4R", "-", "P3R"}], ")"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoordB", "[", 
        RowBox[{"UserCoords", ",", "CanvasCoords"}], "]"}], "=", 
       RowBox[{"BUR", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"P4C", "-", "P3C"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"P4R", "-", "P3R"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "deduce", " ", "conversion", " ", "constants", " ", "to", " ", "any", 
        " ", "other", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DoForEach", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CoordA", "[", 
           RowBox[{"SystemF", ",", "SystemG"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"CoordA", "[", 
              RowBox[{"SystemF", ",", "CanvasCoords"}], "]"}], "-", 
             RowBox[{"CoordA", "[", 
              RowBox[{"SystemG", ",", "CanvasCoords"}], "]"}]}], ")"}], "/", 
           RowBox[{"CoordB", "[", 
            RowBox[{"SystemG", ",", "CanvasCoords"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CoordB", "[", 
           RowBox[{"SystemF", ",", "SystemG"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoordB", "[", 
            RowBox[{"SystemF", ",", "CanvasCoords"}], "]"}], "/", 
           RowBox[{"CoordB", "[", 
            RowBox[{"SystemG", ",", "CanvasCoords"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"SystemF", ",", "CoordinateSystems"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"SystemG", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{"CoordinateSystems", ",", 
            RowBox[{"{", "CanvasCoords", "}"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"define", " ", "private", " ", "shorthand", " ", "operators"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Evaluate", "[", "ConversionFunctionSymbols", "]"}], "=", 
       "\[IndentingNewLine]", 
       RowBox[{"SuppressMessage", "[", 
        RowBox[{
         RowBox[{"Part", "::", "partd"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"TableForEach", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"P", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{"SystemF", ",", "SystemG", ",", "C", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", "X", "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{
                  "SystemF", ",", "SystemG", ",", "C", ",", "X", ",", "1"}], 
                  "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", "Y", "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{
                  "SystemF", ",", "SystemG", ",", "C", ",", "Y", ",", "2"}], 
                  "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"P", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{"SystemF", ",", "SystemG", ",", "D", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", "X", "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{
                  "SystemF", ",", "SystemG", ",", "D", ",", "X", ",", "1"}], 
                  "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", "Y", "}"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ConvertCoordinate", "[", 
                  RowBox[{
                  "SystemF", ",", "SystemG", ",", "D", ",", "Y", ",", "2"}], 
                  "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"SystemF", ",", "CoordinateSystems"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"SystemG", ",", "CoordinateSystems"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.395092913421875*^9}],

Cell[TextData[{
 "Functions for scaling tick length\n\t",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " uses scaled coordinates for tick lengths.\n\tHere we use an \"averaged\" \
scaled coordinate based upon the average of the full plot's horizontal and \
vertical sizes, to ensure consistent tick lengths between horizontal and \
vertical axes and between panels."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DXCTick", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DXCOfXA", "[", 
      RowBox[{"$TickScaleFactor", "*", "#"}], "]"}], "&"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DYCTick", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DYCOfYA", "[", 
      RowBox[{"$TickScaleFactor", "*", "#"}], "]"}], "&"}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["User control of graphics coordinates", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetOrigin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$AUR", "=", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DefineCoordinates", "[", 
       RowBox[{
       "$AbsSize", ",", "$P1C", ",", "$P2C", ",", "$P3C", ",", "$P4C", ",", 
        "$P3R", ",", "$P4R", ",", "$AUR", ",", "$BUR"}], "]"}], ";", 
      "\[IndentingNewLine]", "Null"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOrigin", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"SetOrigin", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOrigin", "[", "]"}], ":=", 
   RowBox[{"SetOrigin", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetScale", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$BUR", "=", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "[", 
          RowBox[{"Min", "[", "$BUR", "]"}], "]"}]}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"SetScale", "::", "nonpositive"}], ",", "$BUR"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DefineCoordinates", "[", 
       RowBox[{
       "$AbsSize", ",", "$P1C", ",", "$P2C", ",", "$P3C", ",", "$P4C", ",", 
        "$P3R", ",", "$P4R", ",", "$AUR", ",", "$BUR"}], "]"}], ";", 
      "\[IndentingNewLine]", "Null"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScale", "[", 
    RowBox[{"y_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"SetScale", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "y"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScale", "[", "]"}], ":=", 
   RowBox[{"SetScale", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x3C_", "?", "NumericQ"}], ",", 
         RowBox[{"x4C_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y3C_", "?", "NumericQ"}], ",", 
         RowBox[{"y4C_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x3R_", "?", "NumericQ"}], ",", 
         RowBox[{"x4R_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y3R_", "?", "NumericQ"}], ",", 
         RowBox[{"y4R_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Differences", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$RegionRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x3C", ",", "x4C"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y3C", ",", "y4C"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$P3C", "=", 
       RowBox[{"{", 
        RowBox[{"x3C", ",", "y3C"}], "}"}]}], ";", 
      RowBox[{"$P4C", "=", 
       RowBox[{"{", 
        RowBox[{"x4C", ",", "y4C"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"$P3R", "=", 
       RowBox[{"{", 
        RowBox[{"x3R", ",", "y3R"}], "}"}]}], ";", 
      RowBox[{"$P4R", "=", 
       RowBox[{"{", 
        RowBox[{"x4R", ",", "y4R"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"$AUR", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", 
      RowBox[{"$BUR", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Differences", "=", 
       RowBox[{"-", 
        RowBox[{"Subtract", "@@@", "$RegionRange"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "[", 
          RowBox[{"Min", "[", "Differences", "]"}], "]"}]}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"SetRegion", "::", "nonpositive"}], ",", "$RegionRange"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DefineCoordinates", "[", 
       RowBox[{
       "$AbsSize", ",", "$P1C", ",", "$P2C", ",", "$P3C", ",", "$P4C", ",", 
        "$P3R", ",", "$P4R", ",", "$AUR", ",", "$BUR"}], "]"}], ";", 
      "\[IndentingNewLine]", "Null"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetRegion", "[", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"$Background", "=", "None"}], ";", 
     RowBox[{"SetRegion", "[", 
      RowBox[{"$CanvasRange", ",", "$CanvasRange"}], "]"}]}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section"],

Cell[CellGroupData[{

Cell["Listable logic operations", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ListableNot", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListableNot", "[", "Args___", "]"}], ":=", 
   RowBox[{"Not", "[", "Args", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ListableAnd", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListableAnd", "[", "Args___", "]"}], ":=", 
   RowBox[{"And", "[", "Args", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ListableOr", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListableOr", "[", "Args___", "]"}], ":=", 
   RowBox[{"Or", "[", "Args", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ListableXor", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListableXor", "[", "Args___", "]"}], ":=", 
   RowBox[{"Xor", "[", "Args", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trigonometry for 2D vectors", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", "0.", ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorLength", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SegmentArcTan", "[", 
    RowBox[{"{", 
     RowBox[{"X1_List", ",", "X2_List"}], "}"}], "]"}], ":=", 
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"X2", "-", "X1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentLength", "[", 
    RowBox[{"{", 
     RowBox[{"X1_List", ",", "X2_List"}], "}"}], "]"}], ":=", 
   RowBox[{"VectorLength", "[", 
    RowBox[{"X2", "-", "X1"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolation", "Subsection"],

Cell["from package MCArithmetic", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Interpolate", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "y1_", ",", "y2_", ",", "x_"}], "]"}], ":=",
    
   RowBox[{"y1", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "x1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"x2", "-", "x1"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"y2", "-", "y1"}], ")"}]}]}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Range checking and expansion", "Subsection"],

Cell["from package MCGraphics", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x1", "\[LessEqual]", "x"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"x", "\[LessEqual]", "x2"}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "x"}], "]"}], "&&", 
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], ",", "y"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "x"}], "]"}], "&&", 
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], ",", "y"}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRange", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_", "?", "NumericQ"}], ",", 
        RowBox[{"x2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx1_", "?", "NumericQ"}], ",", 
        RowBox[{"fx2_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@", "PRange"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRange", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_", "?", "NumericQ"}], ",", 
        RowBox[{"x2_", "?", "NumericQ"}]}], "}"}]}], ",", "fx_"}], "]"}], ":=",
    
   RowBox[{"ExtendRange", "[", 
    RowBox[{"PRange", ",", 
     RowBox[{"{", 
      RowBox[{"fx", ",", "fx"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1_", "?", "NumericQ"}], ",", 
          RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y1_", "?", "NumericQ"}], ",", 
          RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fx1_", "?", "NumericQ"}], ",", 
          RowBox[{"fx2_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fy1_", "?", "NumericQ"}], ",", 
          RowBox[{"fy2_", "?", "NumericQ"}]}], "}"}]}], "}"}]}]}], "]"}], ":=",
    
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@@", "PRange"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1_", "?", "NumericQ"}], ",", 
          RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y1_", "?", "NumericQ"}], ",", 
          RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fx_", "?", "NumericQ"}], ",", 
       RowBox[{"fy_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"ExtendRegion", "[", 
    RowBox[{"PRange", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fx", ",", "fx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fy", ",", "fy"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1_", "?", "NumericQ"}], ",", 
          RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y1_", "?", "NumericQ"}], ",", 
          RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"f_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"ExtendRegion", "[", 
    RowBox[{"PRange", ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", "f"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number testing", "Subsection"],

Cell["from package MCArithmetic", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RealNumericQ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "===", 
        RowBox[{"-", "Infinity"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"#", "===", 
        RowBox[{"+", "Infinity"}]}], ")"}], "||", 
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"N", "[", "#", "]"}], "]"}], "===", "Real"}]}], "&"}], 
    ")"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Message suppression", "Subsection"],

Cell["\<\
SuppressMessage is a scoping structure which temporarily suppresses a \
specified message while evaluating an expression, without affecting the \
global On/Off status of the message.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"SuppressMessage", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuppressMessage", "[", 
    RowBox[{"MessageID_", ",", "Body_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"WasOn", ",", "Value"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WasOn", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Head", "[", "MessageID", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"String", "|", "MessageName"}], ",", "True", ",", 
         "\[IndentingNewLine]", "$Off", ",", "False"}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", "MessageID", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Value", "=", "Body"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WasOn", ",", 
        RowBox[{"On", "[", "MessageID", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "Value"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["List augmentation", "Subsection"],

Cell["\<\
UpgradeScalarX, UpgradeScalarY, and UpgradeScalarXY upgrade a numeric \
argument to a 2D list, or passes a 2D list through unchanged\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalarX", "[", "P_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"P", ",", "\[IndentingNewLine]", 
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"P", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "P"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalarY", "[", "P_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"P", ",", "\[IndentingNewLine]", 
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "P"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "P"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalarXY", "[", "P_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"P", ",", "\[IndentingNewLine]", 
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"P", ",", "P"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "P"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Margin upgrade", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MarginQ", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], ":=", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MarginQ", "[", "_", "]"}], ":=", "False"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeMargin", "[", 
    RowBox[{"xy_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"UpgradeMargin", "[", 
    RowBox[{"{", 
     RowBox[{"xy", ",", "xy"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeMargin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"UpgradeMargin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "x"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "y"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeMargin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_", "?", "NumericQ"}], ",", 
        RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y1_", "?", "NumericQ"}], ",", 
        RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y2"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
AugmentList augments a list to a specified length
\tIt is assumed that the list is not already longer than the specified \
length.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AugmentList", "[", 
    RowBox[{"NumEntries_Integer", ",", "L_List", ",", "Filler_"}], "]"}], ":=",
    
   RowBox[{"Join", "[", 
    RowBox[{"L", ",", 
     RowBox[{"Table", "[", 
      RowBox[{"Filler", ",", 
       RowBox[{"{", 
        RowBox[{"NumEntries", "-", 
         RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Entry interspersing", "Subsection"],

Cell["from MCList", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Intersperse", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"First", "\[Rule]", "False"}], ",", 
     RowBox[{"Last", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Intersperse", "[", 
    RowBox[{"L_List", ",", "Separator_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"Opts", ",", 
          RowBox[{"Options", "[", "Intersperse", "]"}]}], "}"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Insert", "[", "\[IndentingNewLine]", 
      RowBox[{
      "L", ",", "\[IndentingNewLine]", "Separator", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "i", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"First", "/.", "FullOpts"}], ",", "1", ",", "2"}], "]"}],
            ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Last", "/.", "FullOpts"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "L", "]"}], "+", "1"}], ",", 
             RowBox[{"Length", "[", "L", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Intersperse", "[", 
    RowBox[{"Item_", ",", "Separator_", ",", 
     RowBox[{"Num_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Intersperse", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"Item", ",", 
       RowBox[{"{", "Num", "}"}]}], "]"}], ",", "Separator", ",", "Opts"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radius testing and conversion", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SingleRadiusQ", "[", "P_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"P", ",", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], "|", 
      RowBox[{"Horizontal", "[", 
       RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
      RowBox[{"Vertical", "[", 
       RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
      RowBox[{"Point", "[", 
       RowBox[{"_", "?", "NumericQ"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DoubleRadiusQ", "[", "P_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"P", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
      RowBox[{"Horizontal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}], "|", 
      RowBox[{"Vertical", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}], "|", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadiusQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SingleRadiusQ", "[", "P", "]"}], "||", 
    RowBox[{"DoubleRadiusQ", "[", "P", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConvertRadiusToCanvas", "[", 
    RowBox[{"R_", "?", "RadiusQ"}], "]"}], ":=", 
   RowBox[{"Switch", "[", "\[IndentingNewLine]", 
    RowBox[{"R", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], "|", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "\[IndentingNewLine]",
      
     RowBox[{"DPCOfPU", "@", 
      RowBox[{"UpgradeScalarXY", "[", "R", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Horizontal", "[", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DPCOfPA", "@", 
      RowBox[{"(", 
       RowBox[{"DXAOfXU", "/@", 
        RowBox[{"UpgradeScalarXY", "[", 
         RowBox[{"First", "[", "R", "]"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Vertical", "[", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DPCOfPA", "@", 
      RowBox[{"(", 
       RowBox[{"DYAOfYU", "/@", 
        RowBox[{"UpgradeScalarXY", "[", 
         RowBox[{"First", "[", "R", "]"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Point", "[", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DPCOfPA", "@", 
      RowBox[{"UpgradeScalarXY", "[", 
       RowBox[{"First", "[", "R", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Input validation and error message generation", "Subsection"],

Cell["\<\
ErrorMessage
\tError flagging and trapping mechanism in Scheme:
\tAn Abort would prevent Scheme from restoring the saved global option \
values, so must use a Throw out to Scheme.
\tAbort is provided for use by standalone utilities which can be used outside \
of scheme.  Necessary so utilities can safely make use of CheckOption, etc.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ErrorMessage", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErrorMessage", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", "Args", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`Private`$InScheme", ",", "\[IndentingNewLine]", 
        RowBox[{"Throw", "[", "$ErrorFlag", "]"}], ",", "\[IndentingNewLine]",
         
        RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["CatchError", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CatchError", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CatchError", "[", "Body_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Catch", "[", "Body", "]"}], "===", "$ErrorFlag"}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
CheckInScheme
\tDisplay warning if object is evaluated outside a scheme.
\tEach user-callable scheme object should check this first thing before any \
calculations or other parameter checks, since these may yield garbage or \
create and uncaught throw if evaluated outside a scheme.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckInScheme", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"LevelScheme`Private`$InScheme", "=!=", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LevelScheme", "::", "notinscheme"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
CheckInScheme test is so that an object used with wrong syntax but outside of \
scheme will produce a notinscheme error instead of an lsargs error.
Previously, inclusion of this test in ErrorMessage necessitated that the \
global $InScheme flag be set for most of the body of Scheme, since otherwise \
ErrorMessage calls generated by Scheme itself will produce notinscheme \
errors.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FallThroughError", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FallThroughError", "[", 
    RowBox[{"Object_Symbol", ",", "Expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Hold", "[", "Expr", "]"}], ",", "Null", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Object", "::", "lsargsnull"}], ",", 
          RowBox[{"HoldForm", "[", "Expr", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ErrorMessage", "[", 
       RowBox[{
        RowBox[{"Object", "::", "lsargs"}], ",", 
        RowBox[{"HoldForm", "[", "Expr", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["CheckOption, CheckValue", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CheckOption", "[", 
    RowBox[{"Param_", ",", "TestPattern_", ",", "FullOpts_List"}], "]"}], ":=",
    
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Param", "/.", "FullOpts"}], ",", "TestPattern"}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ErrorMessage", "[", 
        RowBox[{
         RowBox[{"LevelScheme", "::", "badparam"}], ",", "Param", ",", 
         RowBox[{"Param", "/.", "FullOpts"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckValue", "[", 
    RowBox[{"Value_", ",", "TestPattern_", ",", "Description_String"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"Value", ",", "TestPattern"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ErrorMessage", "[", 
        RowBox[{
         RowBox[{"LevelScheme", "::", "badvalue"}], ",", "Description", ",", 
         "Value"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Checks for defined identifiers", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckLevel", "[", "ID_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"LevelScheme`Data`UserEnergy", "[", "ID", "]"}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ErrorMessage", "[", 
        RowBox[{
         RowBox[{"LevelScheme", "::", "badlevel"}], ",", "ID"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckPoint", "[", "ID_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"VectorQ", "[", 
         RowBox[{"LevelScheme`Data`P", "[", "ID", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ErrorMessage", "[", 
        RowBox[{
         RowBox[{"LevelScheme", "::", "badpoint"}], ",", "ID"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckDataSet", "[", "ID_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"TrueQ", "[", 
         RowBox[{"LevelScheme`Data`DataTagDefined", "[", "ID", "]"}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"ErrorMessage", "[", 
        RowBox[{
         RowBox[{"LevelScheme", "::", "baddataset"}], ",", "ID"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
LevelIdentifierQ -- test for expression permitted as level identifier\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LevelIdentifierQ", "[", "Expr_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Head", "[", "Expr", "]"}], "=!=", "List"}], ")"}], "&&", 
     RowBox[{"!", 
      RowBox[{"NumericQ", "[", "Expr", "]"}]}]}], ")"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics construction functions", "Section"],

Cell[CellGroupData[{

Cell["Directive patterns for option validation", "Subsection",
 CellChangeTimes->{{3.3955204599375*^9, 3.395520466828125*^9}}],

Cell[TextData[{
 "Note that Opacity is not allowed here as a color directive, since it is \
preferred that the Opacity, LineOpacity, ",
 StyleBox["etc.",
  FontSlant->"Italic"],
 " options be used instead."
}], "Text",
 CellChangeTimes->{{3.3966349168125*^9, 3.3966349643125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ColorDirectivePattern", "=", 
    RowBox[{"(", 
     RowBox[{"_GrayLevel", "|", "_RGBColor", "|", "_Hue", "|", "_CMYKColor"}],
      ")"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520471*^9, 3.395520493953125*^9}, {
  3.395520539328125*^9, 3.395520569640625*^9}, {3.39663491028125*^9, 
  3.396634914140625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outlines", "Subsection"],

Cell[TextData[{
 "MakeOutline takes a list Art of line art objects, and returns a graphics \
object containing of this list with appropriate graphics directives prepended \
according to the option list FullOpts, \nexcept returning null if the \
ShowLine option is set to False.\n\tArguments:\n\t\tArt -- list of graphics \
primatives\n\tRequired options:\n\t\tShowLine\n\t\tColor, Opacity,\n\t\t\
LineColor, LineOpacity, Thickness (interpreted as an absolute thickness, \
contrary to ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " convention) -- line properties\n\t\tDashing, DashingGap, DashingCorrection \
 -- implements smart dashing which allows for pen diameter\n\t\t\
ClipToRectangle, Layer (Automatic yields drawn object default)"
}], "Text",
 CellChangeTimes->{{3.3955200445*^9, 3.3955200449375*^9}, {3.3966349833125*^9,
   3.396634984546875*^9}, {3.39663509253125*^9, 3.3966351233125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CorrectedDash", "[", "Thickness_", "]"}], "[", 
    RowBox[{"Length_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "Index_Integer", ")"}], "?", "OddQ"}], "}"}]}], "]"}], ":=",
    
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Length", "-", "Thickness"}], ",", "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CorrectedDash", "[", "Thickness_", "]"}], "[", 
    RowBox[{"Length_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "Index_Integer", ")"}], "?", "EvenQ"}], "}"}]}], "]"}], ":=",
    
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Length", "+", "Thickness"}], ",", "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeOutlineDirectives", "[", "FullOpts_List", "]"}], " ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "DashLengths", ",", "DefaultGapLength", ",", "DefaultGapFactor"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckOption", "[", 
        RowBox[{"Color", ",", "ColorDirectivePattern", ",", "FullOpts"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Opacity", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"LineColor", ",", 
         RowBox[{"Automatic", "|", "ColorDirectivePattern"}], ",", 
         "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"LineOpacity", ",", 
         RowBox[{"Automatic", "|", 
          RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Thickness", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Dashing", ",", 
         RowBox[{"None", "|", "Automatic", "|", "True", "|", 
          RowBox[{"(", 
           RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "..."}], "}"}], "|", 
          RowBox[{"AbsoluteDashing", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "..."}], "}"}], "]"}]}], 
         ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"DashingGap", ",", 
         RowBox[{"Automatic", "|", 
          RowBox[{"(", 
           RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"DashingCorrection", ",", 
         RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DefaultGapFactor", "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DefaultGapLength", "=", 
        RowBox[{"GetAutoOption", "[", "\[IndentingNewLine]", 
         RowBox[{"DashingGap", ",", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dashing", "/.", "FullOpts"}], ")"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"None", "|", "0", "|", "_AbsoluteDashing"}], ",", "None", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Automatic", "|", "True"}], ",", 
            RowBox[{"DefaultGapFactor", "*", "4"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"DefaultGapFactor", "*", 
             RowBox[{"(", 
              RowBox[{"Dashing", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"_", "?", "NumericQ"}], ")"}], "..."}], "}"}], ",", 
            RowBox[{"DefaultGapFactor", "*", 
             RowBox[{
              RowBox[{"Plus", "@@", 
               RowBox[{"(", 
                RowBox[{"Dashing", "/.", "FullOpts"}], ")"}]}], "/", 
              RowBox[{"Length", "[", 
               RowBox[{"(", 
                RowBox[{"Dashing", "/.", "FullOpts"}], ")"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "_AbsoluteDashing", ",", "None"}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DashLengths", "=", 
        RowBox[{"Switch", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Dashing", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          RowBox[{"None", "|", "0"}], ",", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Automatic", "|", "True"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "DefaultGapLength"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dashing", "/.", "FullOpts"}], ")"}], ",", 
            "DefaultGapLength"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "..."}], "}"}], ",", 
          RowBox[{"Intersperse", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dashing", "/.", "FullOpts"}], ")"}], ",", 
            "DefaultGapLength", ",", 
            RowBox[{"Last", "\[Rule]", "True"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "_AbsoluteDashing", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Dashing", "/.", "FullOpts"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DashLengths", "=", 
        RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CorrectedDash", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"DashingCorrection", "/.", "FullOpts"}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"Thickness", "/.", "FullOpts"}], ")"}], ",", "0"}], 
            "]"}], "]"}], ",", "\[IndentingNewLine]", "DashLengths"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GetAutoOption", "[", 
          RowBox[{"LineColor", ",", 
           RowBox[{"Color", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"Opacity", "[", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"LineOpacity", ",", 
            RowBox[{"Opacity", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AbsoluteThickness", "[", 
          RowBox[{"Thickness", "/.", "FullOpts"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AbsoluteDashing", "[", "DashLengths", "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeOutline", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "Opts", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "CroppedArt"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLine", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Layer", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ClipToRectangle", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ShowLine", "/.", "FullOpts"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CroppedArt", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ClipToRectangle", "/.", "FullOpts"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"First", "@", 
             RowBox[{"ClipToRectangle", "[", 
              RowBox[{"$RegionRange", ",", 
               RowBox[{"Graphics", "[", "Art", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "Art"}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MakeOutlineDirectives", "[", "FullOpts", "]"}], ",", 
           "\[IndentingNewLine]", "CroppedArt", ",", "\[IndentingNewLine]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"Layer", ",", "$SchemeDrawingLayer", ",", "FullOpts"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39552005190625*^9, 3.395520062359375*^9}, 
   3.3955205121875*^9, 3.395520576703125*^9, {3.39663499453125*^9, 
   3.396635037265625*^9}}],

Cell["\<\
MakeOutline3D -- 3D analogue of MakeOutline
\tignores option Layer\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeOutline3D", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "Opts", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLine", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ShowLine", "/.", "FullOpts"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeOutlineDirectives", "[", "FullOpts", "]"}], ",", 
            "\[IndentingNewLine]", "Art"}], "\[IndentingNewLine]", "}"}], 
          "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fills", "Subsection"],

Cell["\<\
MakeFill returns graphics with prepended directives (or Null)
\tArguments:
\t\tArt -- list of graphics primatives
\tRequired options:
\t\tShowFill
\t\tColor, Opacity,
\t\tFillColor, FillOpacity,
\t\tClipToRectangle, Layer (Automatic yields drawn object default)\
\>", "Text",
 CellChangeTimes->{{3.396635127875*^9, 3.3966351371875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeFillDirectives", "[", "FullOpts_List", "]"}], " ", ":=", " ",
     "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"CheckOption", "[", 
        RowBox[{"Color", ",", "ColorDirectivePattern", ",", "FullOpts"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Opacity", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"FillColor", ",", 
         RowBox[{"Automatic", "|", "ColorDirectivePattern"}], ",", 
         "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"FillOpacity", ",", 
         RowBox[{"Automatic", "|", 
          RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"FillColor", ",", 
         RowBox[{"Color", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Opacity", "[", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"FillOpacity", ",", 
         RowBox[{"Opacity", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}], 
       "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeFill", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "Opts", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "CroppedArt"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowFill", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Layer", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ClipToRectangle", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ShowFill", "/.", "FullOpts"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CroppedArt", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ClipToRectangle", "/.", "FullOpts"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"First", "@", 
             RowBox[{"ClipToRectangle", "[", 
              RowBox[{"$RegionRange", ",", 
               RowBox[{"Graphics", "[", "Art", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "Art"}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MakeFillDirectives", "[", "FullOpts", "]"}], ",", 
           "\[IndentingNewLine]", "CroppedArt", ",", "\[IndentingNewLine]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"Layer", ",", "$SchemeDrawingLayer", ",", "FullOpts"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39552059484375*^9, 3.39552059778125*^9}, {
   3.39663514575*^9, 3.396635187421875*^9}, 3.39663555353125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Text", "Subsection"],

Cell["\<\
MakeText returns a text label (or Null)
\tArguments:
\t\tArt -- expression to display
\t\t\tPuts text in DisplayForm.
\t\t\tReturns Null if text is Null.
\t\tPosn -- position in regular coordinates
\t\tDefaultAngle -- angle (CCW from normal horizontal) to use as default \
orientation and basis for calculations based on Orientation option
\tRequired options:
\t\tShowText
\t\tOffset,
\t\tNudge,\t
\t\tOrientation,
\t\tBackground, BackgroundFontSizeFactor
\t\tFontFamily, FontSize,  FontSlant, FontWeight, FontColor, FontOpacity, \
defaulting to Color and Opacity if values are Automatic
\t\tClipToRectangle, Layer (Automatic yields text defaults)\t\
\>", "Text",
 CellChangeTimes->{{3.396634502640625*^9, 3.39663453021875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeTextStyle", "[", "FullOpts_List", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckOption", "[", 
        RowBox[{"Color", ",", "ColorDirectivePattern", ",", "FullOpts"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Opacity", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"FontColor", ",", 
         RowBox[{"Automatic", "|", "ColorDirectivePattern"}], ",", 
         "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"FontOpacity", ",", 
         RowBox[{"Automatic", "|", 
          RowBox[{"(", 
           RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"FontSize", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FontFamily", " ", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"FontFamily", "/.", "FullOpts"}], ")"}]}], ",", 
         RowBox[{"FontSize", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}], ",", 
         RowBox[{"FontSlant", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"FontSlant", "/.", "FullOpts"}], ")"}]}], ",", 
         RowBox[{"FontTracking", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"FontTracking", "/.", "FullOpts"}], ")"}]}], ",", 
         RowBox[{"FontWeight", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"FontWeight", "/.", "FullOpts"}], ")"}]}], ",", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"FontColor", ",", 
            RowBox[{"Color", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"FontOpacity", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"FontOpacity", ",", 
            RowBox[{"Opacity", "/.", "FullOpts"}], ",", "FullOpts"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"ShowAutoStyles", "\[Rule]", "False"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeTextOrientation", "[", 
     RowBox[{"OrientationOption_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", "]"}], " ", "is", " ", "necessary", " ", "to", 
          " ", "make", " ", "sure", " ", "straight"}], "-", 
         RowBox[{
         "down", " ", "labels", " ", "by", " ", "default", " ", "have", " ", 
          "their", " ", "bottom", " ", "to", " ", "the", " ", "right"}]}], 
        ",", " ", 
        RowBox[{
        "like", " ", "for", " ", "labels", " ", "to", " ", "the", " ", "left",
          " ", "of", " ", "straight", " ", 
         RowBox[{"down", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "OrientationOption", ",", "\[IndentingNewLine]", "Automatic", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{"Cos", "[", "theta", "]"}], "]"}], "]"}], "-", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"Sign", "[", 
              RowBox[{"Chop", "[", 
               RowBox[{"Cos", "[", "theta", "]"}], "]"}], "]"}], "]"}]}], 
           ")"}]}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "Inverted", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"Cos", "[", "theta", "]"}], "]"}], "-", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"Sign", "[", 
              RowBox[{"Cos", "[", "theta", "]"}], "]"}], "]"}]}], ")"}]}], 
         "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "Horizontal", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        "Vertical", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "OrientationOption", "]"}], ",", 
          RowBox[{"Sin", "[", "OrientationOption", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "_List", ",", "\[IndentingNewLine]", 
        "OrientationOption"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeText", "[", 
    RowBox[{"Art_", ",", "Posn_", ",", "DefaultAngle_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "Opts", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "CalculatedOffset", ",", "\[IndentingNewLine]", "CalculatedPosn", ",", 
       "\[IndentingNewLine]", "CalculatedOrientation", ",", 
       "\[IndentingNewLine]", "StyleList", ",", "\[IndentingNewLine]", 
       "OptOffset", ",", "\[IndentingNewLine]", "OptNudge", ",", 
       "\[IndentingNewLine]", "OptBackground", ",", "\[IndentingNewLine]", 
       "IsInRegion"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowText", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ClipToRectangle", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"OptOffset", "=", 
       RowBox[{"(", 
        RowBox[{"Offset", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptNudge", "=", 
       RowBox[{"(", 
        RowBox[{"Nudge", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptBackground", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"Background", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$Background", "===", "None"}], ",", "Automatic", ",", 
           "$Background"}], "]"}], ",", "FullOpts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CalculatedOffset", "=", "OptOffset"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CalculatedPosn", "=", 
       RowBox[{"Posn", "+", 
        RowBox[{"DPCOfPA", "[", 
         RowBox[{"UpgradeScalarY", "[", "OptNudge", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CalculatedOrientation", "=", 
       RowBox[{"MakeTextOrientation", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Orientation", "/.", "FullOpts"}], ")"}], " ", ",", 
         "DefaultAngle"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StyleList", "=", 
       RowBox[{"MakeTextStyle", "[", "FullOpts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IsInRegion", "=", 
       RowBox[{"InRegion", "[", 
        RowBox[{"$RegionRange", ",", "Posn"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ShowText", "/.", "FullOpts"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"Art", "=!=", "None"}], ")"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IsInRegion", "||", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"ClipToRectangle", "/.", "FullOpts"}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"background", " ", "block"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Note", ":", " ", 
              RowBox[{
              "If", " ", "FontSize", " ", "is", " ", "specified", " ", "in", 
               " ", "TextStyle", " ", "option", " ", "to", " ", 
               RowBox[{"Text", "[", "]"}]}]}], ",", " ", 
             RowBox[{
             "then", " ", "background", " ", "box", " ", "can", " ", "still", 
              " ", "shrink", " ", "horizontally", " ", "but", " ", "can", " ",
               "never", " ", "shrink", " ", "below", " ", "the", " ", 
              RowBox[{"font", "'"}], "s", " ", "height", " ", 
              RowBox[{"(", 
               RowBox[{"with", " ", "generous", " ", "margins"}], ")"}]}], 
             ",", " ", 
             RowBox[{
             "whether", " ", "adjusted", " ", "with", " ", "an", " ", 
              "AdjustmentBox", " ", "or", " ", "set", " ", "in", " ", "a", 
              " ", "different", " ", "font", " ", "size", " ", "using", " ", 
              "they", " ", 
              RowBox[{"StyleBox", ".", "  ", "Vertical"}], " ", "height", " ",
               "seems", " ", "not", " ", "to", " ", "shrink", " ", "much", 
              " ", "in", " ", "general", " ", "for", " ", "smaller", " ", 
              RowBox[{"fonts", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OptBackground", "=!=", "None"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"DisplayForm", "[", 
                    RowBox[{"StyleBox", "[", 
                    RowBox[{"Art", ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"BackgroundFontSizeFactor", "/.", "FullOpts"}], 
                    ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ",", 
                    RowBox[{"ShowContents", "\[Rule]", "False"}]}], "]"}], 
                    "]"}], ",", "\[IndentingNewLine]", "CalculatedPosn", ",", 
                   "\[IndentingNewLine]", "CalculatedOffset", ",", 
                   "\[IndentingNewLine]", "CalculatedOrientation", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "StyleList"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Background", "\[Rule]", "OptBackground"}]}], 
                  "\[IndentingNewLine]", "]"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"GetAutoOption", "[", 
                 RowBox[{
                 "Layer", ",", "$SchemeBlankingLayer", ",", "FullOpts"}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"text", " ", "itself"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"DisplayForm", "[", "Art", "]"}], ",", 
                 "\[IndentingNewLine]", "CalculatedPosn", ",", 
                 "\[IndentingNewLine]", "CalculatedOffset", ",", 
                 "\[IndentingNewLine]", "CalculatedOrientation", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaseStyle", "\[Rule]", "StyleList"}]}], 
                "\[IndentingNewLine]", "]"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"Layer", ",", "$SchemeTextLayer", ",", "FullOpts"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39508980746875*^9, 3.395089811546875*^9}, {
  3.395520606171875*^9, 3.395520609015625*^9}, {3.396634539125*^9, 
  3.39663457575*^9}, {3.39663520575*^9, 3.39663521278125*^9}}],

Cell["\<\
MakeText3D -- 3D analogue of MakeText
\tignores options Nudge, Layer\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeText3D", "[", 
    RowBox[{"Art_", ",", "Posn_", ",", "DefaultAngle_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "Opts", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "CalculatedOffset", ",", "\[IndentingNewLine]", "CalculatedPosn", ",", 
       "\[IndentingNewLine]", "CalculatedOrientation", ",", 
       "\[IndentingNewLine]", "StyleList", ",", "\[IndentingNewLine]", 
       "OptBackground"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowText", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"OptBackground", "=", 
       RowBox[{"(", 
        RowBox[{"Background", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "properties"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CalculatedOffset", "=", 
       RowBox[{"(", 
        RowBox[{"Offset", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CalculatedPosn", "=", "Posn"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CalculatedOrientation", "=", 
       RowBox[{"MakeTextOrientation", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Orientation", "/.", "FullOpts"}], ")"}], " ", ",", 
         "DefaultAngle"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StyleList", "=", 
       RowBox[{"MakeTextStyle", "[", "FullOpts", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"background", " ", "block"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Note", ":", " ", 
            RowBox[{
            "If", " ", "FontSize", " ", "is", " ", "specified", " ", "in", 
             " ", "TextStyle", " ", "option", " ", "to", " ", 
             RowBox[{"Text", "[", "]"}]}]}], ",", " ", 
           RowBox[{
           "then", " ", "background", " ", "box", " ", "can", " ", "still", 
            " ", "shrink", " ", "horizontally", " ", "but", " ", "can", " ", 
            "never", " ", "shrink", " ", "below", " ", "the", " ", 
            RowBox[{"font", "'"}], "s", " ", "height", " ", 
            RowBox[{"(", 
             RowBox[{"with", " ", "generous", " ", "margins"}], ")"}]}], ",", 
           " ", 
           RowBox[{
           "whether", " ", "adjusted", " ", "with", " ", "an", " ", 
            "AdjustmentBox", " ", "or", " ", "set", " ", "in", " ", "a", " ", 
            "different", " ", "font", " ", "size", " ", "using", " ", "they", 
            " ", 
            RowBox[{"StyleBox", ".", "  ", "Vertical"}], " ", "height", " ", 
            "seems", " ", "not", " ", "to", " ", "shrink", " ", "much", " ", 
            "in", " ", "general", " ", "for", " ", "smaller", " ", 
            RowBox[{"fonts", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowText", "/.", "FullOpts"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"Art", "=!=", "None"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"OptBackground", "=!=", "None"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Text", "[", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"StyleBox", "[", 
                  RowBox[{
                   RowBox[{"AdjustmentBox", "[", 
                    RowBox[{"Art", ",", 
                    RowBox[{"BoxMargins", "\[Rule]", "$BackgroundMargins"}]}],
                     "]"}], ",", 
                   RowBox[{"ShowContents", "\[Rule]", "False"}]}], "]"}], "//",
                  "DisplayForm"}], ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"DisplayForm", "[", 
                RowBox[{"StyleBox", "[", 
                 RowBox[{"Art", ",", 
                  RowBox[{"FontSize", "\[Rule]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"BackgroundFontSizeFactor", "/.", "FullOpts"}], 
                    ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ",", 
                  RowBox[{"ShowContents", "\[Rule]", "False"}]}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "CalculatedPosn", ",", 
               "\[IndentingNewLine]", "CalculatedOffset", ",", 
               "\[IndentingNewLine]", "CalculatedOrientation", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", "StyleList"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "\[Rule]", "OptBackground"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"text", " ", "itself"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Show", "/.", "FullOpts"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowText", "/.", "FullOpts"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"Art", "=!=", "None"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Text", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"DisplayForm", "[", "Art", "]"}], ",", 
               "\[IndentingNewLine]", "CalculatedPosn", ",", 
               "\[IndentingNewLine]", "CalculatedOffset", ",", 
               "\[IndentingNewLine]", "CalculatedOrientation", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", "StyleList"}]}], 
              "\[IndentingNewLine]", "]"}], "}"}], ",", "\[IndentingNewLine]",
             
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395089289671875*^9, 3.39508929334375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Raw graphics", "Subsection"],

Cell["\<\
MakeRawGraphics returns graphics with prepended directives (or Null)
\tArguments:
\t\tArt -- list of graphics primatives
\t\tArt is assumed to be \"safe\", with no directives at top level, and so \
should be quarantined by the calling routine.
\tRequired options:
\t\tShow
\t\tColor, Opacity
\t\toutline directive options except LineColor and LineOpacity
\t\tLayer (Automatic yields background layer default)\
\>", "Text",
 CellChangeTimes->{{3.396635250515625*^9, 3.396635259859375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeRawGraphicsDirectives", "[", "FullOpts_List", "]"}], " ", ":=",
     
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckOption", "[", 
        RowBox[{"Color", ",", "ColorDirectivePattern", ",", "FullOpts"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckOption", "[", 
        RowBox[{"Opacity", ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakeOutlineDirectives", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"FullOpts", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LineColor", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"LineOpacity", "\[Rule]", "Automatic"}]}], "}"}]}], "]"}],
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeRawGraphics", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "Opts", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Layer", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Show", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
        RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MakeRawGraphicsDirectives", "[", "FullOpts", "]"}], ",", 
          "\[IndentingNewLine]", "Art", ",", "\[IndentingNewLine]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Layer", ",", "$SchemeDrawingLayer", ",", "FullOpts"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3955206215*^9, {3.3966352624375*^9, 3.396635286328125*^9}}],

Cell["\<\
MakeRawGraphics3D -- 3D analogue of RawGraphics
\tignores option Layer\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRawGraphics3D", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "Opts", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeRawGraphicsDirectives", "[", "FullOpts", "]"}], ",", 
            "\[IndentingNewLine]", "Art"}], "\[IndentingNewLine]", "}"}], 
          "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Verbatim", "Subsection"],

Cell["\<\
MakeVerbatim returns graphics with no prepended directives (or Null)
\tArguments:
\t\tArt -- list of graphics primatives
\t\tArt is assumed to be \"safe\", with no directives at top level, and so \
should be quarantined by the calling routine.
\tRequired options:
\t\tShow
\t\tLayer (Automatic yields background layer default)\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeVerbatim", "[", 
    RowBox[{"Art_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "Opts", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Layer", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Show", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
        RowBox[{"SchemeGraphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "Art", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Layer", ",", "$SchemeDrawingLayer", ",", "FullOpts"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing objects", "Section"],

Cell[CellGroupData[{

Cell["Basic curve annotation", "Subsection"],

Cell["\<\
TO DO: Fix label geometry calculation for curve (data set) with just one \
point and gracefully handle null curve.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicLineAnnotations", "[", 
    RowBox[{"Points_List", ",", "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "AbsPoints", ",", "Lengths", ",", "LengthSoFar", ",", "CurveParam", ",",
        "\[IndentingNewLine]", "AbsXFcn", ",", "AbsYFcn", ",", "AbsPFcn", ",",
        "AbsTangentFcn", ",", "\[IndentingNewLine]", "HalfWidthForLabels", 
       ",", "\[IndentingNewLine]", "bufft", ",", "offt", ",", "OptPosnT", ",",
        "PointT", ",", "AngleT", ",", "\[IndentingNewLine]", "buffb", ",", 
       "offb", ",", "OptPosnB", ",", "PointB", ",", "AngleB", ",", 
       "\[IndentingNewLine]", "OptPosnL", ",", "PointL", ",", "AngleL", ",", 
       "\[IndentingNewLine]", "OptPosnR", ",", "PointR", ",", "AngleR", ",", 
       "\[IndentingNewLine]", "OptPosnC", ",", "PointC", ",", "AngleC"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"option", " ", "processing"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnL", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnR", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnT", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnB", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnC", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"parametrize", " ", "data", " ", "curve"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"AbsPoints", "=", 
       RowBox[{"PAOfPC", "/@", "Points"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lengths", "=", 
       RowBox[{"VectorLength", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"AbsPoints", ",", 
            RowBox[{"-", "1"}]}], "]"}], "-", 
          RowBox[{"Drop", "[", 
           RowBox[{"AbsPoints", ",", "1"}], "]"}]}], ")"}]}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"i", ".", "e", "."}], ",", " ", 
        RowBox[{"Most", "-", "Rest"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LengthSoFar", "=", "0."}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveParam", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LengthSoFar", "+=", "#"}], "&"}], ")"}], "/@", 
         RowBox[{"Prepend", "[", 
          RowBox[{"Lengths", ",", "0."}], "]"}]}], "/", "LengthSoFar"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"AbsXFcn", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParam", ",", 
            RowBox[{"First", "/@", "AbsPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AbsYFcn", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParam", ",", 
            RowBox[{"Last", "/@", "AbsPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AbsPFcn", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsXFcn", "[", "#", "]"}], ",", 
           RowBox[{"AbsYFcn", "[", "#", "]"}]}], "}"}], "&"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AbsTangentFcn", "=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", "1", "]"}], "[", "AbsXFcn", "]"}], 
             "[", "#", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", "1", "]"}], "[", "AbsYFcn", "]"}], 
             "[", "#", "]"}]}], "}"}], "/", 
          RowBox[{"VectorLength", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], "[", "AbsXFcn", "]"}], 
              "[", "#", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], "[", "AbsYFcn", "]"}], 
              "[", "#", "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "&"}],
         ")"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"AbsNormalFcn", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ".", 
          RowBox[{"AbsTangentFcn", "[", "#", "]"}]}], "&"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HalfWidthForLabels", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SuppressMessage", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "silently", " ", "allow", " ", "linear", " ", "extrapolation", " ", 
         "of", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InterpolatingFunction", "::", "\"\<dmval\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabT", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"offt", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"OffsetT", ",", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Horizontal", "|", "Vertical"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "|", "Inverted", "|", "_"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                 "]"}], ",", "\[IndentingNewLine]", "FullOpts"}], 
               "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bufft", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"BufferT", ",", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Horizontal", "|", "Vertical"}], ",", "0", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "|", "Inverted", "|", "_"}], ",", 
                  "1.1"}], "\[IndentingNewLine]", "]"}], ",", 
                "\[IndentingNewLine]", "FullOpts"}], "\[IndentingNewLine]", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"OptPosnT", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"PosnT", ",", "0.5", ",", "FullOpts"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"PointT", "=", 
              RowBox[{"PCOfPA", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"AbsPFcn", "[", "OptPosnT", "]"}], "+", 
                 RowBox[{
                  RowBox[{"AbsNormalFcn", "[", "OptPosnT", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"HalfWidthForLabels", "+", 
                    RowBox[{
                    RowBox[{"bufft", "/", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], 
                   ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AngleT", "=", 
              RowBox[{"VectorArcTan", "[", 
               RowBox[{"AbsTangentFcn", "[", "OptPosnT", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeText", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", "PointT", ",",
                "AngleT", ",", "\[IndentingNewLine]", 
               RowBox[{"ShowText", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Offset", "\[Rule]", "offt"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Nudge", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Orientation", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "->", 
                RowBox[{"(", 
                 RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "FullOpts"}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabB", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"offb", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"OffsetB", ",", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Horizontal", "|", "Vertical"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"+", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "|", "Inverted", "|", "_"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                 "]"}], ",", "\[IndentingNewLine]", "FullOpts"}], 
               "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"buffb", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"BufferB", ",", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Horizontal", "|", "Vertical"}], ",", "0", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "|", "Inverted", "|", "_"}], ",", 
                  "1.1"}], "\[IndentingNewLine]", "]"}], ",", 
                "\[IndentingNewLine]", "FullOpts"}], "\[IndentingNewLine]", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"OptPosnB", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"PosnB", ",", "0.5", ",", "FullOpts"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"PointB", "=", 
              RowBox[{"PCOfPA", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"AbsPFcn", "[", "OptPosnB", "]"}], "-", 
                 RowBox[{
                  RowBox[{"AbsNormalFcn", "[", "OptPosnB", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"HalfWidthForLabels", "+", 
                    RowBox[{
                    RowBox[{"buffb", "/", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], 
                   ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AngleB", "=", 
              RowBox[{"VectorArcTan", "[", 
               RowBox[{"AbsTangentFcn", "[", "OptPosnB", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeText", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", "PointB", ",",
                "AngleB", ",", "\[IndentingNewLine]", 
               RowBox[{"ShowText", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Offset", "\[Rule]", "offb"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Nudge", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Orientation", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "->", 
                RowBox[{"(", 
                 RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "FullOpts"}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabL", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptPosnL", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"PosnL", ",", "0.0", ",", "FullOpts"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"PointL", "=", 
              RowBox[{"PCOfPA", "@", 
               RowBox[{"AbsPFcn", "[", "OptPosnL", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AngleL", "=", 
              RowBox[{"VectorArcTan", "[", 
               RowBox[{"AbsTangentFcn", "[", "OptPosnL", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeText", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", "PointL", ",",
                "AngleL", ",", "\[IndentingNewLine]", 
               RowBox[{"ShowText", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Offset", "\[Rule]", 
                RowBox[{"GetAutoOption", "[", 
                 RowBox[{"OffsetL", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Nudge", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Orientation", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "->", 
                RowBox[{"(", 
                 RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "FullOpts"}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabR", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptPosnR", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"PosnR", ",", "1.0", ",", "FullOpts"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"PointR", "=", 
              RowBox[{"PCOfPA", "@", 
               RowBox[{"AbsPFcn", "[", "OptPosnR", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AngleR", "=", 
              RowBox[{"VectorArcTan", "[", 
               RowBox[{"AbsTangentFcn", "[", "OptPosnR", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeText", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", "PointR", ",",
                "AngleR", ",", "\[IndentingNewLine]", 
               RowBox[{"ShowText", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Offset", "\[Rule]", 
                RowBox[{"GetAutoOption", "[", 
                 RowBox[{"OffsetR", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Nudge", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Orientation", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "->", 
                RowBox[{"(", 
                 RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "FullOpts"}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabC", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptPosnC", "=", 
              RowBox[{"GetAutoOption", "[", 
               RowBox[{"PosnC", ",", "0.5", ",", "FullOpts"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"PointC", "=", 
              RowBox[{"PCOfPA", "@", 
               RowBox[{"AbsPFcn", "[", "OptPosnC", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AngleC", "=", 
              RowBox[{"VectorArcTan", "[", 
               RowBox[{"AbsTangentFcn", "[", "OptPosnC", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeText", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", "PointC", ",",
                "AngleC", ",", "\[IndentingNewLine]", 
               RowBox[{"ShowText", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Offset", "\[Rule]", 
                RowBox[{"GetAutoOption", "[", 
                 RowBox[{"OffsetC", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"Nudge", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Orientation", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "->", 
                RowBox[{"(", 
                 RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "FullOpts"}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic arrow object", "Subsection"],

Cell["\<\
ArrowPoint calculates the absolute coordinates of a point with its lateral \
position along the arrow (denoted by x, since the arrow is constructed \"on \
its side\") and transverse displacement relative to the arrow axis (denoted \
by y) specified in various ways.  Position along the axis may be specified \
according to various modes: as a fraction of the length of the arrow, as an \
explicit absolute coordinate, on the beveled tail surface, on a horizontal \
tail surface, or various places in relation to the arrow head.

Calculation of position FromHeadVertical/FromTailVertical will fail for \
horizontal arrow, and similarly calculation \
FromHeadHorizontal/FromTailHorizontal will fail for vertical arrow.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{"Caller_Symbol", ",", 
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtUserPosition", 
     ",", "x_", ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d", ",", "xa"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckValue", "[", "\[IndentingNewLine]", 
       RowBox[{"x", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
         RowBox[{"FromHead", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
         RowBox[{"FromTail", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
         RowBox[{"FromHeadVertical", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
         RowBox[{"FromTailVertical", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
         RowBox[{"FromHeadHorizontal", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
         RowBox[{"FromTailHorizontal", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\"\<a label position\>\""}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xa", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"x", ",", "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"x", "*", "d"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FromHead", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{"d", "-", 
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FromTail", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FromHeadVertical", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"Sin", "[", "theta", "]"}], "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"ErrorMessage", "[", 
             RowBox[{"Caller", "::", "fromvert"}], "]"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "-", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Csc", "[", "theta", "]"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromTailVertical", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"Sin", "[", "theta", "]"}], "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"ErrorMessage", "[", 
             RowBox[{"Caller", "::", "fromvert"}], "]"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Csc", "[", "theta", "]"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromHeadHorizontal", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"Cos", "[", "theta", "]"}], "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"ErrorMessage", "[", 
             RowBox[{"Caller", "::", "fromhoriz"}], "]"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "-", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sec", "[", "theta", "]"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromTailHorizontal", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"Cos", "[", "theta", "]"}], "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"ErrorMessage", "[", 
             RowBox[{"Caller", "::", "fromhoriz"}], "]"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sec", "[", "theta", "]"}]}], ")"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xa", ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtPosition", ",", 
     "xa_", ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xa", ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtTail", ",", 
     "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtTailHorizontal", 
     ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "theta", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "ya"}], "*", 
          RowBox[{"Csc", "[", "theta", "]"}]}], ",", "0"}], "}"}]}]}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtHead", ",", 
     "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d", ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtHeadHorizontal", 
     ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "theta", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pfa", "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "ya"}], "*", 
          RowBox[{"Csc", "[", "theta", "]"}]}], ",", "0"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtLip", ",", 
     "HeadLength_", ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "-", "HeadLength"}], ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtTailLip", ",", 
     "HeadLength_", ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"HeadLength", ",", "ya"}], "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", "AtEdge", ",", 
     "HeadLength_", ",", "HeadHalfWidth_", ",", "ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pia", "+", 
       RowBox[{"LegacyRotate2D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "-", 
            RowBox[{
             RowBox[{"Abs", "[", "ya", "]"}], "*", 
             RowBox[{"HeadLength", "/", "HeadHalfWidth"}]}]}], ",", "ya"}], 
          "}"}], ",", 
         RowBox[{"-", "theta"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395091061953125*^9, 3.39509106553125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SquigglePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pia_List", ",", "Pfa_List"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MinBuffer1_", ",", "MinBuffer2_"}], "}"}], ",", "HalfWidth_", 
     ",", "SquiggleWavelength_", ",", "SquiggleSide_", ",", "PlotPoints_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "d", ",", "dp", ",", "Delta", ",", "x", ",", "PointList", 
       ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"SquiggleSide", ",", "Right", ",", 
         RowBox[{"+", "1"}], ",", "Left", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"VectorLength", "[", 
        RowBox[{"Pfa", "-", "Pia"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"SquiggleWavelength", "/", "2"}], ")"}], "*", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "-", "MinBuffer1", "-", "MinBuffer2"}], ")"}], ",", 
            "0"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"SquiggleWavelength", "/", "2"}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Delta", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", "MinBuffer1", "-", "MinBuffer2", "-", "dp"}], 
         ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PointList", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Pia", "+", 
          RowBox[{"LegacyRotate2D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "MinBuffer1", "+", "Delta"}], ",", 
              RowBox[{"s", "*", "HalfWidth", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", "*", 
                 RowBox[{"Pi", "/", "SquiggleWavelength"}], "*", "x"}], 
                "]"}]}]}], "}"}], ",", 
            RowBox[{"-", "theta"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "dp", ",", 
           RowBox[{"SquiggleWavelength", "/", "PlotPoints"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "Pia", "}"}], ",", "PointList", ",", 
        RowBox[{"{", "Pfa", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.395091066171875*^9}],

Cell["\<\
ArrowHeadPoints
\tReturns list of three points defining an arrow head at the end of the given \
segment.  All coordinates are absolute.
\tArrowHeadPoints[{P1a,P2a},...], defined with segment, reduces to \
ArrowHeadPoints[Pa,theta,...].\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ArrowHeadPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P1a", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
       RowBox[{"P2a", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"HeadLength_", "?", "NumericQ"}], ",", 
     RowBox[{"HeadLip_", "?", "NumericQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"ArrowHeadPoints", "[", 
    RowBox[{"P2a", ",", 
     RowBox[{"VectorArcTan", "[", 
      RowBox[{"P2a", "-", "P1a"}], "]"}], ",", "HeadLength", ",", "HeadLip"}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowHeadPoints", "[", 
    RowBox[{
     RowBox[{"Pa", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"theta_", "?", "NumericQ"}], ",", 
     RowBox[{"HeadLength_", "?", "NumericQ"}], ",", 
     RowBox[{"HeadLip_", "?", "NumericQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pa", "+", 
        RowBox[{"LegacyRotate2D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "HeadLength"}], ",", 
            RowBox[{"+", "HeadLip"}]}], "}"}], ",", 
          RowBox[{"-", "theta"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Pa", "+", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "0."}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Pa", "+", 
        RowBox[{"LegacyRotate2D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "HeadLength"}], ",", 
            RowBox[{"-", "HeadLip"}]}], "}"}], ",", 
          RowBox[{"-", "theta"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3950910666875*^9, 3.39509106709375*^9}}],

Cell[TextData[{
 "Shape arrow geometry and kink geometry\n                                    \
            5",
 StyleBox["\n     7               |\\                       \n     \
----------------- \\                      \n     |               6  \\        \
  \n     |0 (=i     )        ) 4 (=f)                                Segment \
\n     |               2  /                      i -----*-----*---*-------> f \
  \n     ----------------- /                              k1    k2  k3 ...\n  \
   1               |/\n                     3\n     <-------- d ------->\n    \
 ",
  FontFamily->"Courier"],
 "\nArrow points are calculated in horizontal orientation, rotated to correct \
theta, then displaced to put origin at tail point.  All calculations must be \
done in absolute units (printer's points), for which x and y metrics on \
screen are the same, so that arrow won't be skewed under rotation.\n\nFor a \
conversion electron shaded area, extending from one side to a line at height \
y above the centerline, the width is ConversionWidth=(Width/2 \[PlusMinus] \
y), and the ratio of shaded width to total width should be \
ConversionWidth/Width = alpha/(1+alpha)."
}], "Text"],

Cell["\<\
Calculating label positions

\t1. calculate position along arrow axis (dl,...)
\t\tThis is based upon the fractional position up from the bottom of the \
arrow.
\t\tFor the top label, it also includes an extra buffer (buffer factor)*(font \
size), mainly so a white-out box will not overlap the level line.
\t2. calculate displacement perpendicular to arrow axis (wl,...)
  \t\tThis is (arrow width)/2 + (buffer \"offset\")/2*(font size) for side \
labels, or 0 for central labels.
      \t3. add displacement to arrow start point to obtain absolute \
coordinates (xl,yl,...)

\"Left\" is defined as CW side, and \"right\" is defined as CCW side, \
therefore having their natural senses for an energy descending transition.

Default label offsets and buffers are set depending upon text orientation:
\tHorizontal/vertical text positioning is most easily controlled using the \
Mathematica offset mechanism, while tilted text is most easily positioned by \
calculating \"buffered\" coordinates for its center relative to the arrow \
edge.
\t
Debugging: Do not name initial point Pi, as this overloads the constant Pi.  \
Including all text calculations inside If prevents unnecessary error \
conditions when position specification is bad (e.g., horizontal distance \
specified on vertical arrow) but no label is actually to be drawn.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicArrow", "[", 
    RowBox[{"Caller_Symbol", ",", "Nodes_List", ",", "FullOpts_List"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "PointList", ",", "\[IndentingNewLine]", "AbsNodes", ",", "AbsSegments",
        ",", "Segment", ",", "\[IndentingNewLine]", "ConversionPointList", 
       ",", "ConversionP0", ",", "ConversionP4", ",", "ConversionWidth", ",", 
       "Conversiony", ",", "ConversionSideSign", ",", "\[IndentingNewLine]", 
       "d", ",", "dp", ",", "dk", ",", "Delta", ",", "\[IndentingNewLine]", 
       "ShaftPosition", ",", "ShaftPoints", ",", "\[IndentingNewLine]", 
       "LineArt", ",", "TextArt", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "HalfWidthForLabels", ",", 
       "\[IndentingNewLine]", "PLa", ",", "PRa", ",", "PCa", ",", "PTa", ",", 
       "\[IndentingNewLine]", "offl", ",", "offr", ",", "offc", ",", "offkc", 
       ",", "offt", ",", "\[IndentingNewLine]", "buffl", ",", "buffr", ",", 
       "\[IndentingNewLine]", "SegmentPointsL", ",", "SegmentPointsC", ",", 
       "SegmentPointsR", ",", "SegmentPointsT", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "OptWidth", ",", "\[IndentingNewLine]", 
       "OptThickness", ",", "\[IndentingNewLine]", "OptHeadLength", ",", 
       "\[IndentingNewLine]", "OptShaftLines", ",", "\[IndentingNewLine]", 
       "OptHeadLip"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"option", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"ArrowType", ",", 
        RowBox[{
        "LineArrow", "|", "MultilineArrow", "|", "SquiggleArrow", "|", 
         "ShapeArrow"}], ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]",
       
      RowBox[{"CheckOption", "[", 
       RowBox[{"ArrowHalf", ",", 
        RowBox[{"All", "|", "Left", "|", "Right"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLip", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Width", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"TailBevel", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShaftLines", ",", 
        RowBox[{
         RowBox[{"(", "x_Integer", ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"x", "\[GreaterEqual]", "2"}], ")"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PlotPoints", ",", 
        RowBox[{
         RowBox[{"(", "x_Integer", ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"x", "\[GreaterEqual]", "4"}], ")"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SquiggleBuffer", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x_", "?", "NumericQ"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"x", ">=", "0"}], ")"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SquiggleWavelength", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x_", "?", "NumericQ"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"x", ">", "0"}], ")"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SquiggleSide", ",", 
        RowBox[{"Left", "|", "Right"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SegmentL", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"x_Integer", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "!=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "x", "]"}], "<", 
               RowBox[{"Length", "[", "Nodes", "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SegmentR", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"x_Integer", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "!=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "x", "]"}], "<", 
               RowBox[{"Length", "[", "Nodes", "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SegmentC", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"x_Integer", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "!=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "x", "]"}], "<", 
               RowBox[{"Length", "[", "Nodes", "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"ArrowType", "/.", "FullOpts"}], ",", "LineArrow"}], 
            "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "Nodes", "]"}], ">", "2"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{"Caller", "::", "kinks"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowHead", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTail", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"ArrowType", "/.", "FullOpts"}], ",", 
           RowBox[{"LineArrow", "|", "SquiggleArrow"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CheckOption", "[", 
         RowBox[{"ShowTail", ",", "False", ",", "FullOpts"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ConversionSide", ",", 
        RowBox[{"Left", "|", "Right"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ConversionCoeff", ",", 
        RowBox[{"None", "|", 
         RowBox[{"_", "?", "NumericQ"}], "|", "Infinity"}], ",", "FullOpts"}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ConversionCoeff", "/.", "FullOpts"}], ")"}], "=!=", 
           "None"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}], "=!=", "0"}], 
          ")"}]}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{"Caller", "::", "conversionlip"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"AboveKinkL", "/.", "FullOpts"}], ")"}], "=!=", "False"}], 
        ",", 
        RowBox[{"Message", "[", 
         RowBox[{"LevelScheme", "::", "abovekinkx"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"AboveKinkR", "/.", "FullOpts"}], ")"}], "=!=", "False"}], 
        ",", 
        RowBox[{"Message", "[", 
         RowBox[{"LevelScheme", "::", "abovekinkx"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"AboveKinkC", "/.", "FullOpts"}], ")"}], "=!=", "False"}], 
        ",", 
        RowBox[{"Message", "[", 
         RowBox[{"LevelScheme", "::", "abovekinkx"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"calculate", " ", "arrow", " ", 
        RowBox[{"geometry", " ", "--"}], " ", "absolute", " ", 
        "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AbsNodes", "=", 
       RowBox[{"PAOfPC", "/@", "Nodes"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbsSegments", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"AbsNodes", ",", "2", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Chop", "/@", 
           RowBox[{"SegmentLength", "/@", "AbsSegments"}]}], ",", "0"}], 
         "]"}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Caller", "::", "nullsegment"}], ",", "Nodes"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Segment", "=", 
       RowBox[{"AbsSegments", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"shorthand", " ", "useful", " ", "for", " ", "single"}], "-", 
        
        RowBox[{"segment", " ", "arrow", " ", "types"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"OptWidth", "=", 
       RowBox[{"(", 
        RowBox[{"Width", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptHeadLength", "=", 
       RowBox[{"(", 
        RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptHeadLip", "=", 
       RowBox[{"(", 
        RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptShaftLines", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"ShaftLines", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptThickness", "=", 
       RowBox[{"(", 
        RowBox[{"Thickness", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"make", " ", "arrow"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LineArt", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ArrowType", "/.", "FullOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", "LineArrow", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "shaft", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MakeOutline", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", 
               RowBox[{"PCOfPA", "/@", "AbsNodes"}], "]"}], "}"}], ",", 
             "FullOpts"}], "]"}], " ", ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ShowHead", "/.", "FullOpts"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeOutline", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ArrowHeadPoints", "[", 
                   RowBox[{
                    RowBox[{"AbsSegments", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "OptHeadLength", 
                    ",", "OptHeadLip"}], "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ShowTail", "/.", "FullOpts"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeOutline", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ArrowHeadPoints", "[", 
                   RowBox[{
                    RowBox[{"Reverse", "@", 
                    RowBox[{"AbsSegments", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "OptHeadLength", 
                    ",", "OptHeadLip"}], "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "MultilineArrow", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ShaftPoints", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"ShaftPosition", "=", 
                 RowBox[{"OptWidth", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], "+", 
                    RowBox[{"i", "/", 
                    RowBox[{"(", 
                    RowBox[{"OptShaftLines", "-", "1"}], ")"}]}]}], ")"}]}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TailBevel", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ArrowPoint", "[", 
                    RowBox[{"Segment", ",", "AtTail", ",", "ShaftPosition"}], 
                    "]"}], ",", 
                    RowBox[{"ArrowPoint", "[", 
                    RowBox[{
                    "Segment", ",", "AtEdge", ",", "OptHeadLength", ",", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], ",", 
                    "ShaftPosition"}], "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ArrowPoint", "[", 
                    RowBox[{
                    "Segment", ",", "AtTailHorizontal", ",", 
                    "ShaftPosition"}], "]"}], ",", 
                    RowBox[{"ArrowPoint", "[", 
                    RowBox[{
                    "Segment", ",", "AtEdge", ",", "OptHeadLength", ",", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], ",", 
                    "ShaftPosition"}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{"OptShaftLines", "-", "1"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "fill", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"Polygon", "[", 
                RowBox[{"PCOfPA", "/@", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"First", "[", "ShaftPoints", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Last", "[", "Segment", "]"}], "}"}], ",", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "ShaftPoints", "]"}], "]"}]}], 
                  "]"}]}], "]"}], "\[IndentingNewLine]", "}"}], ",", 
              "\[IndentingNewLine]", "FullOpts"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"shaft", " ", "lines"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ShaftPoints", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "OptShaftLines"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
             ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], " ", ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ShowHead", "/.", "FullOpts"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeOutline", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ArrowHeadPoints", "[", 
                   RowBox[{"Segment", ",", "OptHeadLength", ",", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}]}], 
                   "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", "SquiggleArrow", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"main", " ", "segment"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PointList", "=", 
             RowBox[{"SquigglePoints", "[", "\[IndentingNewLine]", 
              RowBox[{"Segment", ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ShowTail", "/.", "FullOpts"}], ")"}], ",", 
                    "OptHeadLength", ",", "0"}], "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"SquiggleBuffer", "/.", "FullOpts"}], ")"}]}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ShowHead", "/.", "FullOpts"}], ")"}], ",", 
                    "OptHeadLength", ",", "0"}], "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"SquiggleBuffer", "/.", "FullOpts"}], ")"}]}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"OptWidth", "/", "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"SquiggleWavelength", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"SquiggleSide", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"PlotPoints", "/.", "FullOpts"}], ")"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"MakeOutline", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Line", "[", 
                RowBox[{"PCOfPA", "/@", "PointList"}], "]"}], "}"}], ",", 
              "FullOpts"}], "]"}]}], " ", ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ShowHead", "/.", "FullOpts"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeOutline", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ArrowHeadPoints", "[", 
                   RowBox[{
                   "Segment", ",", "OptHeadLength", ",", "OptHeadLip"}], 
                   "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ShowTail", "/.", "FullOpts"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MakeOutline", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"PCOfPA", "/@", 
                  RowBox[{"ArrowHeadPoints", "[", 
                   RowBox[{
                    RowBox[{"Reverse", "@", "Segment"}], ",", "OptHeadLength",
                     ",", "OptHeadLip"}], "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "ShapeArrow", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PointList", "=", 
             RowBox[{"Switch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TailBevel", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
               " ", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"First", "[", "Segment", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{"Segment", ",", "AtTail", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Last", "[", "Segment", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{"Segment", ",", "AtTail", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               "True", ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"First", "[", "Segment", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{"Segment", ",", "AtTailHorizontal", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Last", "[", "Segment", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{
                  "Segment", ",", "AtLip", ",", "OptHeadLength", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ArrowPoint", "[", 
                  RowBox[{"Segment", ",", "AtTailHorizontal", ",", 
                   RowBox[{"+", 
                    RowBox[{"(", 
                    RowBox[{"OptWidth", "/", "2"}], ")"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"PointList", "=", 
             RowBox[{"Switch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ArrowHalf", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", "All", ",", "PointList", ",", 
               "\[IndentingNewLine]", "Left", ",", 
               RowBox[{"Take", "[", 
                RowBox[{"PointList", ",", "5"}], "]"}], ",", 
               "\[IndentingNewLine]", "Right", ",", 
               RowBox[{"Take", "[", 
                RowBox[{
                 RowBox[{"RotateLeft", "[", "PointList", "]"}], ",", 
                 RowBox[{"-", "5"}]}], "]"}]}], "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ConversionCoeff", "/.", "FullOpts"}], ")"}], "=!=", 
               "None"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ConversionSideSign", "=", 
                RowBox[{"Switch", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ConversionSide", "/.", "FullOpts"}], ")"}], ",", 
                  "Left", ",", 
                  RowBox[{"+", "1"}], ",", "Right", ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"ConversionWidth", "=", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ConversionCoeff", "/.", "FullOpts"}], ")"}], "==",
                    "Infinity"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Width", "/.", "FullOpts"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Width", "*", 
                    RowBox[{"ConversionCoeff", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ConversionCoeff"}], ")"}]}]}], ")"}], "/.",
                    "FullOpts"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Conversiony", "=", 
                RowBox[{"ConversionSideSign", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ConversionWidth", "-", 
                    RowBox[{"Width", "/", "2"}]}], ")"}], "/.", "FullOpts"}], 
                  ")"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"ConversionP0", "=", 
                RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TailBevel", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"ArrowPoint", "[", 
                   RowBox[{"Segment", ",", "AtTail", ",", "Conversiony"}], 
                   "]"}], ",", "\[IndentingNewLine]", "True", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ArrowPoint", "[", 
                   RowBox[{
                   "Segment", ",", "AtTailHorizontal", ",", "Conversiony"}], 
                   "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ConversionP4", "=", 
                RowBox[{"ArrowPoint", "[", 
                 RowBox[{
                 "Segment", ",", "AtEdge", ",", "OptHeadLength", ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"OptWidth", "/", "2"}], "+", "OptHeadLip"}], 
                   ")"}], ",", "Conversiony"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ConversionPointList", "=", 
                RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ConversionSide", "/.", "FullOpts"}], ")"}], ",", 
                  "\[IndentingNewLine]", "Left", ",", "\[IndentingNewLine]", 
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"PointList", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Conversiony", ">", "0"}], ",", 
                    RowBox[{"PointList", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", "4", "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ConversionP4", ",", "ConversionP0"}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                  "Right", ",", "\[IndentingNewLine]", 
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"PointList", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "6", ",", "5"}], "}"}], "]"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Conversiony", "<", "0"}], ",", 
                    RowBox[{"PointList", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", "4", "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ConversionP4", ",", "ConversionP0"}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"Polygon", "[", 
                RowBox[{"PCOfPA", "/@", "PointList"}], "]"}], 
               "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
              "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ConversionCoeff", "/.", "FullOpts"}], ")"}], "=!=", 
              "None"}], ",", "\[IndentingNewLine]", 
             RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"Polygon", "[", 
                 RowBox[{"PCOfPA", "/@", "ConversionPointList"}], "]"}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"FillColor", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ConversionColor", "/.", "FullOpts"}], ")"}]}], ",", 
               "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"Line", "[", 
               RowBox[{"PCOfPA", "/@", 
                RowBox[{"(", 
                 RowBox[{"PointList", "~", "Append", "~", 
                  RowBox[{"First", "[", "PointList", "]"}]}], ")"}]}], "]"}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"make", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"HalfWidthForLabels", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ArrowType", "/.", "FullOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", "LineArrow", ",", 
         RowBox[{"OptThickness", "/", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MultilineArrow", "|", "SquiggleArrow", "|", "ShapeArrow"}], 
         ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"OptWidth", "+", "OptThickness"}], ")"}], "/", "2"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"TextArt", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabL", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offl", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetL", ",", "\[IndentingNewLine]", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}], ",", 
                 "\[IndentingNewLine]", "Automatic", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "Inverted", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "Horizontal", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "Vertical", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "_", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                "]"}], ",", "\[IndentingNewLine]", "FullOpts"}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"buffl", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"BufferL", ",", "\[IndentingNewLine]", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}], ",", 
                 "\[IndentingNewLine]", "Automatic", ",", "1.1", ",", 
                 "\[IndentingNewLine]", "Inverted", ",", "1.1", ",", 
                 "\[IndentingNewLine]", "Horizontal", ",", "0", ",", 
                 "\[IndentingNewLine]", "Vertical", ",", "0", ",", 
                 "\[IndentingNewLine]", "_", ",", " ", "1.1"}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"SegmentPointsL", "=", 
             RowBox[{"Switch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SegmentL", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", "Automatic", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
                "_Integer", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"(", 
                  RowBox[{"SegmentL", "/.", "FullOpts"}], ")"}], "]"}], 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"PLa", "=", 
             RowBox[{"ArrowPoint", "[", 
              RowBox[{
              "Caller", ",", "SegmentPointsL", ",", "AtUserPosition", ",", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"PosnL", ",", "0.5", ",", "FullOpts"}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"HalfWidthForLabels", "+", 
                  RowBox[{
                   RowBox[{"buffl", "/", "2"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], 
                 ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"MakeText", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", 
              RowBox[{"PCOfPA", "[", "PLa", "]"}], ",", 
              RowBox[{"SegmentArcTan", "[", "SegmentPointsL", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowText", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Offset", "\[Rule]", "offl"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Nudge", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Orientation", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Background", "->", 
               RowBox[{"(", 
                RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]",
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabR", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offr", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetR", ",", "\[IndentingNewLine]", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}], ",", 
                 "\[IndentingNewLine]", "Automatic", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "Inverted", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "Horizontal", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                 "\[IndentingNewLine]", "Vertical", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 "_", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                "]"}], ",", "\[IndentingNewLine]", "FullOpts"}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"buffr", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"BufferR", ",", "\[IndentingNewLine]", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}], ",", 
                 "\[IndentingNewLine]", "Automatic", ",", "1.1", ",", 
                 "\[IndentingNewLine]", "Inverted", ",", "1.1", ",", 
                 "\[IndentingNewLine]", "Horizontal", ",", "0", ",", 
                 "\[IndentingNewLine]", "Vertical", ",", "0", ",", 
                 "\[IndentingNewLine]", "_", ",", " ", "1.1"}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"SegmentPointsR", "=", 
             RowBox[{"Switch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SegmentR", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", "Automatic", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
                "_Integer", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"(", 
                  RowBox[{"SegmentR", "/.", "FullOpts"}], ")"}], "]"}], 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"PRa", "=", 
             RowBox[{"ArrowPoint", "[", 
              RowBox[{
              "Caller", ",", "SegmentPointsR", ",", "AtUserPosition", ",", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"PosnR", ",", "0.5", ",", "FullOpts"}], "]"}], ",", 
               RowBox[{"+", 
                RowBox[{"(", 
                 RowBox[{"HalfWidthForLabels", "+", 
                  RowBox[{
                   RowBox[{"buffr", "/", "2"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], 
                 ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"MakeText", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", " ", 
              RowBox[{"PCOfPA", "[", "PRa", "]"}], ",", 
              RowBox[{"SegmentArcTan", "[", "SegmentPointsR", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowText", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Offset", "\[Rule]", "offr"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Nudge", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Orientation", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Background", "->", 
               RowBox[{"(", 
                RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]",
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabC", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offc", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetC", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
               "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"SegmentPointsC", "=", 
             RowBox[{"Switch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SegmentC", "/.", "FullOpts"}], ")"}], ",", 
               "\[IndentingNewLine]", "Automatic", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
                "_Integer", ",", 
               RowBox[{"AbsSegments", "[", 
                RowBox[{"[", 
                 RowBox[{"(", 
                  RowBox[{"SegmentC", "/.", "FullOpts"}], ")"}], "]"}], 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"PCa", "=", 
             RowBox[{"ArrowPoint", "[", 
              RowBox[{
              "Caller", ",", "SegmentPointsC", ",", "AtUserPosition", ",", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"PosnC", ",", "0.5", ",", "FullOpts"}], "]"}], ",", 
               "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"MakeText", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", " ", 
              RowBox[{"PCOfPA", "[", "PCa", "]"}], ",", 
              RowBox[{"SegmentArcTan", "[", "SegmentPointsC", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowText", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Offset", "\[Rule]", "offc"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Nudge", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Orientation", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Background", "->", 
               RowBox[{"(", 
                RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]",
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabT", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offt", "=", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetT", ",", "\[IndentingNewLine]", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}], ",", 
                 "\[IndentingNewLine]", "Automatic", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 "Inverted", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 "Horizontal", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 "Vertical", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 "_", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                "]"}], ",", "\[IndentingNewLine]", "FullOpts"}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"SegmentPointsT", "=", 
             RowBox[{"AbsSegments", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"PTa", "=", 
             RowBox[{"ArrowPoint", "[", 
              RowBox[{
              "Caller", ",", "SegmentPointsT", ",", "AtUserPosition", ",", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"PosnT", ",", "0", ",", "FullOpts"}], "]"}], ",", 
               "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"MakeText", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", " ", 
              RowBox[{"PCOfPA", "[", "PTa", "]"}], ",", 
              RowBox[{"SegmentArcTan", "[", "SegmentPointsT", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowText", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Offset", "\[Rule]", "offt"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Nudge", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Orientation", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Background", "->", 
               RowBox[{"(", 
                RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]",
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "completed", " ", "artwork"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"LineArt", ",", "TextArt"}], "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520081078125*^9, 3.395520122609375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Level objects", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lev", "[", 
    RowBox[{
     RowBox[{"ID_:", "Dummy"}], ",", 
     RowBox[{"xa0_", "?", "NumericQ"}], ",", 
     RowBox[{"xb0_", "?", "NumericQ"}], ",", 
     RowBox[{"EnergyStr", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], "|", "_String"}], ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Lev", ",", "Opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "WingRiseWidthL", ",", "WingRiseWidthR", ",", "\[IndentingNewLine]", 
       "WingTipWidthL", ",", "WingTipWidthR", ",", "\[IndentingNewLine]", 
       "PointList", ",", "\[IndentingNewLine]", "IDExpr"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckValue", "[", 
       RowBox[{"ID", ",", 
        RowBox[{"IDExpr_", "?", "LevelIdentifierQ"}], ",", 
        "\"\<a level identifier symbol (cannot be list or number)\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"EnergyNudge", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"WingHeight", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"WingRiseWidth", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"WingTipWidth", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"MakeWingL", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"MakeWingR", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"label", " ", "validation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLabL", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLabR", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLabT", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLabB", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowLabC", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Store", " ", "level", " ", "parameters"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"$LastLevel", "=", "ID"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`xa0", "[", "ID", "]"}], "=", 
       RowBox[{"XCOfXU", "[", "xa0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`xb0", "[", "ID", "]"}], "=", 
       RowBox[{"XCOfXU", "[", "xb0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "=", " ", 
       RowBox[{"XCOfXU", "[", 
        RowBox[{"xa0", "+", 
         RowBox[{"(", 
          RowBox[{"Margin", "/.", "FullOpts"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], "=", " ", 
       RowBox[{"XCOfXU", "[", 
        RowBox[{"xb0", "-", 
         RowBox[{"(", 
          RowBox[{"Margin", "/.", "FullOpts"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`UserEnergy", "[", "ID", "]"}], "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"EnergyStr", ",", "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", "EnergyStr", ",", 
         "\[IndentingNewLine]", "_String", ",", 
         RowBox[{"ToExpression", "[", "EnergyStr", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"LevelScheme`Data`UserEnergy", "[", "ID", "]"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Lev", "::", "energystr"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ID", "===", "Dummy"}], ",", "\"\<no ID given\>\"", ",", 
            "ID"}], "]"}], ",", "EnergyStr"}], "]"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"YCOfYU", "[", 
         RowBox[{"LevelScheme`Data`UserEnergy", "[", "ID", "]"}], "]"}], "+", 
        
        RowBox[{"DYCOfYA", "[", 
         RowBox[{"EnergyNudge", "/.", "FullOpts"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}], " ", "=", 
       RowBox[{
        RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}], "+", 
        RowBox[{"DYCOfYA", "[", 
         RowBox[{"WingHeight", "/.", "FullOpts"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"WingRiseWidthL", ",", "WingRiseWidthR"}], "}"}], "=", 
          RowBox[{"UpgradeScalarXY", "[", 
           RowBox[{"WingRiseWidth", "/.", "FullOpts"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"WingTipWidthL", ",", "WingTipWidthR"}], "}"}], "=", 
          RowBox[{"UpgradeScalarXY", "[", 
           RowBox[{"WingTipWidth", "/.", "FullOpts"}], "]"}]}], ";", 
         RowBox[{"PointList", "=", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"MakeWingL", "/.", "FullOpts"}], ")"}], "&&", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"WingHeight", "/.", "FullOpts"}], ")"}], "=!=", 
                "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"LevelScheme`Data`EnergyL", "[", "ID", "]"}], "=", 
                RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], " ", ",", 
                   
                   RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
                    RowBox[{"DXCOfXA", "[", "WingTipWidthL", "]"}]}], " ", 
                   ",", 
                   RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
                    RowBox[{"DXCOfXA", "[", "WingTipWidthL", "]"}], " ", "+", 
                    
                    RowBox[{"DXCOfXA", "[", "WingRiseWidthL", "]"}]}], " ", 
                   ",", 
                   RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], 
                  "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"LevelScheme`Data`EnergyL", "[", "ID", "]"}], "=", 
                RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], " ", ",", 
                  RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], 
                 "}"}], "\[IndentingNewLine]", "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"MakeWingR", "/.", "FullOpts"}], ")"}], "&&", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"WingHeight", "/.", "FullOpts"}], ")"}], "=!=", 
                "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"LevelScheme`Data`EnergyR", "[", "ID", "]"}], "=", 
                RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], "-", 
                    RowBox[{"DXCOfXA", "[", "WingTipWidthR", "]"}], " ", "-", 
                    
                    RowBox[{"DXCOfXA", "[", "WingRiseWidthR", "]"}]}], " ", 
                   ",", 
                   RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], "-", 
                    RowBox[{"DXCOfXA", "[", "WingTipWidthR", "]"}]}], " ", 
                   ",", 
                   RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], ",", 
                   RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                  "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"LevelScheme`Data`EnergyR", "[", "ID", "]"}], "=", 
                RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], " ", ",", 
                  RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], 
                 "}"}], "\[IndentingNewLine]", "}"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", "PointList", "]"}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"LineToFront", "/.", "FullOpts"}], ")"}], ",", 
             RowBox[{"Layer", "\[Rule]", "$SchemeTextLayer"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Labels", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DefaultLabel", "=", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
           "EnergyStr", ",", "\[IndentingNewLine]", "_String", ",", 
            "EnergyStr", ",", "\[IndentingNewLine]", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"EnergyLabelFunction", "/.", "FullOpts"}], ")"}], "@", 
             "EnergyStr"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MakeText", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"LabL", ",", "DefaultLabel", ",", "FullOpts"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], ",", 
             RowBox[{"LevelScheme`Data`EnergyL", "[", "ID", "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"ShowText", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Offset", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"OffsetL", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", ".75"}]}], "}"}], ",", "FullOpts"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Nudge", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Orientation", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"OrientationL", ",", "Horizontal", ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Background", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"LabC", ",", "DefaultLabel", ",", "FullOpts"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
               RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}]}], ")"}], "/", 
             "2"}], ",", 
            RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetC", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", ".75"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OrientationC", ",", "Horizontal", ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"LabR", ",", "DefaultLabel", ",", "FullOpts"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], ",", 
            RowBox[{"LevelScheme`Data`EnergyR", "[", "ID", "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetR", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{"-", ".75"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OrientationR", ",", "Horizontal", ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"LabT", ",", "DefaultLabel", ",", "FullOpts"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
               RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}]}], ")"}], "/", 
             "2"}], ",", 
            RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetT", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", ".75"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OrientationT", ",", "Horizontal", ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"LabB", ",", "DefaultLabel", ",", "FullOpts"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
               RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}]}], ")"}], "/", 
             "2"}], ",", 
            RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetC", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"+", ".75"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OrientationB", ",", "Horizontal", ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LastLevel", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "$LastLevel"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelEnergy", "[", 
    RowBox[{"ID_", "?", "LevelIdentifierQ"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Data`UserEnergy", "[", "ID", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicExtensionLine", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", "x1_", ",", "x2_", ",", 
     "FullOpts_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ToWing", "/.", "FullOpts"}], ")"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", ",", 
                 RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x2", ",", 
                 RowBox[{"LevelScheme`Data`WingEnergy", "[", "ID", "]"}]}], 
                "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", ",", 
                 RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"x2", ",", 
                 RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], 
                "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "FullOpts"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLine", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posn1_", "?", "NumericQ"}], ",", 
     RowBox[{"Posn2_", "?", "NumericQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
   RowBox[{"BasicExtensionLine", "[", 
    RowBox[{"ID", ",", 
     RowBox[{
      RowBox[{"LevelScheme`Data`xa0", "[", "ID", "]"}], " ", "+", 
      RowBox[{"DXCOfXU", "[", "Posn1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"LevelScheme`Data`xa0", "[", "ID", "]"}], " ", "+", 
      RowBox[{"DXCOfXU", "[", "Posn2", "]"}]}], ",", 
     RowBox[{"RealizeOptions", "[", 
      RowBox[{"ExtensionLine", ",", "Opts"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLine", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", "Left", ",", "Length_", 
     ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BasicExtensionLine", "[", 
    RowBox[{"ID", ",", 
     RowBox[{
      RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "-", 
      RowBox[{"DXCOfXU", "[", "Length", "]"}]}], ",", 
     RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], ",", 
     RowBox[{"RealizeOptions", "[", 
      RowBox[{"ExtensionLine", ",", "Opts"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLine", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", "Right", ",", "Length_", 
     ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BasicExtensionLine", "[", 
    RowBox[{"ID", ",", 
     RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], ",", 
     RowBox[{
      RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], "+", 
      RowBox[{"DXCOfXU", "[", "Length", "]"}]}], ",", 
     RowBox[{"RealizeOptions", "[", 
      RowBox[{"ExtensionLine", ",", "Opts"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Connector", "[", 
    RowBox[{
     RowBox[{"IDi_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"IDf_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"Connector", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDi", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDf", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LevelScheme`Data`xb", "[", "IDi", "]"}], ",", 
              RowBox[{"LevelScheme`Data`EnergyR", "[", "IDi", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LevelScheme`Data`xa", "[", "IDf", "]"}], ",", 
              RowBox[{"LevelScheme`Data`EnergyL", "[", "IDf", "]"}]}], 
             "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "FullOpts"}], "\[IndentingNewLine]", "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition arrows", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ArrowNodeQ", "[", "P_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"P", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
      RowBox[{"FromHead", "[", 
       RowBox[{"_", "?", "DoubleRadiusQ"}], "]"}], "|", 
      RowBox[{"FromTail", "[", 
       RowBox[{"_", "?", "DoubleRadiusQ"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "[", 
    RowBox[{
     RowBox[{"RawNodes", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PI", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], ",", 
        RowBox[{"Pf", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Trans", ",", "Opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "Nodes", ",", "R", ",", "P"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Kink", ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Nodes", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"RawNodes", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"P", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ":>", 
            RowBox[{"PCOfPU", "@", "P"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromHead", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "Pf"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromTail", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "PI"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicArrow", "[", 
       RowBox[{"Trans", ",", "Nodes", ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "[", 
    RowBox[{
     RowBox[{"PI", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Pf", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Trans", ",", "Opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "RawNodes", ",", "Nodes", ",", "R", ",", "P"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Kink", ",", 
        RowBox[{"None", "|", 
         RowBox[{"_", "?", "ArrowNodeQ"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RawNodes", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "PI", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Kink", "/.", "FullOpts"}], ")"}], ",", 
           "\[IndentingNewLine]", "None", ",", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"_", "?", "ArrowNodeQ"}], ",", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{"Kink", "/.", "FullOpts"}], ")"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], "}"}], ",", 
           RowBox[{"(", 
            RowBox[{"Kink", "/.", "FullOpts"}], ")"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "Pf", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nodes", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"RawNodes", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"P", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ":>", 
            RowBox[{"PCOfPU", "@", "P"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromHead", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "Pf"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromTail", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "PI"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicArrow", "[", 
       RowBox[{"Trans", ",", "Nodes", ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "[", 
    RowBox[{
     RowBox[{"IDi_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"IDf_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Trans", ",", "Opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "xi", ",", "yi", ",", "xf", ",", "yf", ",", "\[IndentingNewLine]", 
       "PI", ",", "Pf", ",", "\[IndentingNewLine]", "Posni", ",", "Posnf"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"EndPositions", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ")"}]}], 
         "}"}], ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDi", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDf", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Posni", ",", "Posnf"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"EndPositions", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Calculate", " ", "start"}], ",", " ", "end", ",", " ", 
        RowBox[{"and", " ", "optional", " ", "kink", " ", "points"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "PI", " ", "and", " ", "Pf", " ", "are", " ", "distance", " ", "in", 
        " ", "band", " ", "units", " ", "from", " ", "left", " ", "origin", 
        " ", "of", " ", "band"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xi", ",", "xf"}], "}"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Posni", "=!=", "Automatic"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"Posnf", "=!=", "Automatic"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LevelScheme`Data`xa0", "[", "IDi", "]"}], ",", 
            RowBox[{"LevelScheme`Data`xa0", "[", "IDf", "]"}]}], "}"}], "+", 
          RowBox[{"DXCOfXU", "/@", 
           RowBox[{"{", 
            RowBox[{"Posni", ",", "Posnf"}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Posni", "=!=", "Automatic"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"Posnf", "===", "Automatic"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LevelScheme`Data`xa0", "[", "IDi", "]"}], ",", 
            RowBox[{"LevelScheme`Data`xa0", "[", "IDi", "]"}]}], "}"}], "+", 
          RowBox[{"DXCOfXU", "/@", 
           RowBox[{"{", 
            RowBox[{"Posni", ",", "Posni"}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Posni", "===", "Automatic"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"Posnf", "=!=", "Automatic"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LevelScheme`Data`xa0", "[", "IDf", "]"}], ",", 
            RowBox[{"LevelScheme`Data`xa0", "[", "IDf", "]"}]}], "}"}], "+", 
          RowBox[{"DXCOfXU", "/@", 
           RowBox[{"{", 
            RowBox[{"Posnf", ",", "Posnf"}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
         RowBox[{"ErrorMessage", "[", 
          RowBox[{"Trans", "::", "twoautos"}], "]"}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yi", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FromWing", "/.", "FullOpts"}], ",", 
         RowBox[{"LevelScheme`Data`WingEnergy", "[", "IDi", "]"}], ",", 
         RowBox[{"LevelScheme`Data`Energy", "[", "IDi", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"yf", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ToWing", "/.", "FullOpts"}], ",", 
         RowBox[{"LevelScheme`Data`WingEnergy", "[", "IDf", "]"}], ",", 
         RowBox[{"LevelScheme`Data`Energy", "[", "IDf", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"PI", "=", 
       RowBox[{"{", 
        RowBox[{"xi", ",", "yi"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pf", "=", 
       RowBox[{"{", 
        RowBox[{"xf", ",", "yf"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Trans", "[", 
       RowBox[{
        RowBox[{"PUOfPC", "@", "PI"}], ",", 
        RowBox[{"PUOfPC", "@", "Pf"}], ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "[", 
    RowBox[{
     RowBox[{"IDi_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posni", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ")"}]}], ",", 
     RowBox[{"IDf_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posnf", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Trans", "[", 
    RowBox[{"IDi", ",", "IDf", ",", 
     RowBox[{"EndPositions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Posni", ",", "Posnf"}], "}"}]}], ",", "Opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Label primatives", "Subsection"],

Cell["\<\
User-level label command must construct FullOpts from user and default \
options and must provide an explicit numerical value for option Offset\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicLabel", "[", 
    RowBox[{"P_", ",", "Contents_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "Opts", "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"MakeText", "[", 
      RowBox[{"Contents", ",", "P", ",", "0", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"pass", " ", "on", " ", "ShowText"}], ",", " ", "Offset", 
         ",", " ", "Nudge", ",", " ", "Orientation", ",", " ", "Background", 
         ",", " ", 
         RowBox[{"font", " ", "style", " ", "parameters"}], ",", " ", 
         RowBox[{"and", " ", "Layer", " ", "from", " ", "FullOpts"}]}], 
        "*)"}], "\[IndentingNewLine]", "FullOpts"}], " ", 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ManualLabel", "[", 
     RowBox[{"P_", ",", "Contents_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"ManualLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]",
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"BasicLabel", "[", 
        RowBox[{
         RowBox[{"PCOfPU", "[", "P", "]"}], ",", "Contents", ",", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Offset", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "   "}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BandLabel", "[", 
     RowBox[{
      RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", "Contents_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"BandLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckLevel", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"BasicLabel", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
              RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}]}], ")"}], "/", 
            "2"}], ",", 
           RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",", 
         "Contents", ",", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Offset", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"+", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BandLabel", "[", 
     RowBox[{
      RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", 
      RowBox[{"Posn_", "?", "NumericQ"}], ",", "Contents_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"BandLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CheckLevel", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"BasicLabel", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"LevelScheme`Data`xa0", "[", "ID", "]"}], "+", 
            RowBox[{"DXCOfXU", "[", "Posn", "]"}]}], ",", 
           RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",", 
         "Contents", ",", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Offset", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"+", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledLabel", "[", 
    RowBox[{"Pr_", ",", "Contents_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"ScaledLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BasicLabel", "[", 
       RowBox[{
        RowBox[{"PCOfPS", "[", "Pr", "]"}], ",", "Contents", ",", 
        RowBox[{"Offset", "\[Rule]", 
         RowBox[{"GetAutoOption", "[", 
          RowBox[{"Offset", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
        "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicLevelLabel", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posn", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right"}], ")"}]}], ",", "Contents_", ",", 
     "FullOpts_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "P0", ",", "P1", ",", "P2", ",", "PLabel", ",", "Sense", ",", 
       "NeedLine", ",", "GapValues"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"CallOutVector", ",", 
        RowBox[{"None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Gap", ",", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NeedLine", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CallOutVector", "/.", "FullOpts"}], ")"}], "=!=", 
        "None"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GapValues", "=", 
       RowBox[{"UpgradeScalarXY", "[", 
        RowBox[{"Gap", "/.", "FullOpts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sense", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Posn", ",", "Left", ",", 
         RowBox[{"-", "1"}], ",", "Right", ",", 
         RowBox[{"+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P0", " ", "=", " ", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "Posn", ",", "\[IndentingNewLine]", "Left", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], ",", 
           RowBox[{"LevelScheme`Data`EnergyL", "[", "ID", "]"}]}], "}"}], ",",
          "\[IndentingNewLine]", "Right", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}], ",", 
           RowBox[{"LevelScheme`Data`EnergyR", "[", "ID", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"NeedLine", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P1", " ", "=", 
          RowBox[{"P0", "+", 
           RowBox[{"Sense", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DXCOfXA", " ", "@", 
               RowBox[{"GapValues", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}]}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"P2", " ", "=", 
          RowBox[{"P1", "+", 
           RowBox[{"DPCOfPA", "@", 
            RowBox[{"(", 
             RowBox[{"CallOutVector", "/.", "FullOpts"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PLabel", " ", "=", 
          RowBox[{"P2", "+", 
           RowBox[{"Sense", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DXCOfXA", " ", "@", 
               RowBox[{"GapValues", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "}"}]}]}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PLabel", "=", 
         RowBox[{"P0", "+", 
          RowBox[{"Sense", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DXCOfXA", " ", "@", 
              RowBox[{"GapValues", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "}"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Optional", " ", "call"}], "-", 
         RowBox[{"out", " ", "line"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"NeedLine", ",", "\[IndentingNewLine]", 
          RowBox[{"MakeOutline", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"P1", ",", "P2"}], "}"}], "]"}], "}"}], ",", 
            "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Label", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"BasicLabel", "[", 
         RowBox[{"PLabel", ",", "Contents", ",", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"Offset", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Sense"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
            "]"}]}], ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicLevelLabel", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posn", ":", 
      RowBox[{"(", 
       RowBox[{"Bottom", "|", "Top"}], ")"}]}], ",", "Contents_", ",", 
     "FullOpts_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "P0", ",", "P1", ",", "P2", ",", "PLabel", ",", "Sense", ",", 
       "NeedLine", ",", "GapValues"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"CallOutVector", ",", 
        RowBox[{"None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Gap", ",", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Sense", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Posn", ",", "Bottom", ",", 
         RowBox[{"-", "1"}], ",", "Top", ",", 
         RowBox[{"+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Label", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BasicLabel", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"LevelScheme`Data`xa", "[", "ID", "]"}], "+", 
              RowBox[{"LevelScheme`Data`xb", "[", "ID", "]"}]}], ")"}], "/", 
            "2"}], ",", 
           RowBox[{"LevelScheme`Data`Energy", "[", "ID", "]"}]}], "}"}], ",", 
         "Contents", ",", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"Offset", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "Sense"}]}], "}"}], ",", "FullOpts"}], "]"}]}], 
         ",", "FullOpts"}], "]"}], "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LevelLabel", "[", 
    RowBox[{
     RowBox[{"ID_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Posn", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right", "|", "Top", "|", "Bottom"}], ")"}]}], 
     ",", "Contents_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"LevelLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BasicLevelLabel", "[", 
       RowBox[{"ID", ",", "Posn", ",", "Contents", ",", "FullOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
3D label
\tRespects only those options recognized by MakeText3D, produces graphics \
primatives (rather than SchemeGraphics)\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicLabel3D", "[", 
    RowBox[{"P_", ",", "Contents_", ",", "FullOpts_List"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeText3D", "[", 
      RowBox[{"Contents", ",", "P", ",", "0", ",", "FullOpts"}], " ", "]"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ManualLabel3D", "[", 
     RowBox[{"P_", ",", "Contents_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"ManualLabel3D", ",", "Opts"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"BasicLabel3D", "[", 
       RowBox[{"P", ",", "Contents", ",", 
        RowBox[{"OptionsUnion", "[", 
         RowBox[{
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"Offset", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "FullOpts"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "   "}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing objects", "Subsection"],

Cell["Simple elements", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicLine", "[", 
    RowBox[{"Points_List", ",", "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"option", " ", "processing"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLip", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowHead", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTail", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "outline", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", "Points", "]"}], "\[IndentingNewLine]", "}"}],
           ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowHead", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"PCOfPA", "/@", 
               RowBox[{"ArrowHeadPoints", "[", 
                RowBox[{
                 RowBox[{"PAOfPC", "/@", 
                  RowBox[{"Take", "[", 
                   RowBox[{"Points", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], "]"}]}], 
              "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowTail", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"PCOfPA", "/@", 
               RowBox[{"ArrowHeadPoints", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Reverse", "@", "PAOfPC"}], "/@", 
                  RowBox[{"Take", "[", 
                   RowBox[{"Points", ",", "2"}], "]"}]}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], "]"}]}], 
              "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "text", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"BasicLineAnnotations", "[", 
         RowBox[{"Points", ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeLine", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeLine", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BasicLine", "[", 
       RowBox[{
        RowBox[{"PCOfPU", "/@", "Points"}], ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3955201269375*^9, 3.395520130609375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicPolygon", "[", 
    RowBox[{"Points_List", ",", "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Fill", " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Polygon", "[", "Points", "]"}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"Points", ",", 
             RowBox[{"First", "[", "Points", "]"}]}], "]"}], "]"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemePolygon", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemePolygon", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BasicPolygon", "[", 
       RowBox[{
        RowBox[{"PCOfPU", "/@", "Points"}], ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", "FullOpts_List"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Fill", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Polygon", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "y2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y1"}], "}"}]}], "}"}], "]"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "y2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}]}], "}"}], "]"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Labels", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"MakeText", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y1", "+", "y2"}], ")"}], "/", "2"}]}], "}"}], ",", "0", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ShowText", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"OffsetL", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Nudge", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Orientation", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"(", 
           RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakeText", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y1", "+", "y2"}], ")"}], "/", "2"}]}], "}"}], ",", "0", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ShowText", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"OffsetR", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Nudge", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Orientation", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"(", 
           RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakeText", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x1", "+", "x2"}], ")"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y1", "+", "y2"}], ")"}], "/", "2"}]}], "}"}], ",", "0", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ShowText", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"OffsetC", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Nudge", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Orientation", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"(", 
           RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakeText", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x1", "+", "x2"}], ")"}], "/", "2"}], ",", "y2"}], "}"}],
          ",", "0", ",", "\[IndentingNewLine]", 
         RowBox[{"ShowText", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"OffsetT", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Nudge", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Orientation", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"(", 
           RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakeText", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x1", "+", "x2"}], ")"}], "/", "2"}], ",", "y1"}], "}"}],
          ",", "0", ",", "\[IndentingNewLine]", 
         RowBox[{"ShowText", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Offset", "\[Rule]", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"OffsetB", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"+", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Nudge", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Orientation", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"(", 
           RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1_", "?", "NumericQ"}], ",", 
         RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y1_", "?", "NumericQ"}], ",", 
         RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeBox", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BasicBox", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"XCOfXU", "/@", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], "}"}]}], ",", 
          RowBox[{"YCOfYU", "/@", 
           RowBox[{"{", 
            RowBox[{"y1", ",", "y2"}], "}"}]}]}], "}"}], ",", "FullOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1_", "?", "NumericQ"}], ",", 
       RowBox[{"y1_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x2_", "?", "NumericQ"}], ",", 
       RowBox[{"y2_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SchemeBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1", ",", "y2"}], "}"}]}], "}"}], ",", "Opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeSquare", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R_", "?", "RadiusQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "PC", ",", "xc", ",", "yc", ",", "RC", ",", "xr", ",", "yr", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeBox", ",", "Opts"}], "]"}]}]}], "\[IndentingNewLine]",
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PC", "=", 
       RowBox[{"PCOfPU", "@", "P"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RC", "=", 
       RowBox[{"ConvertRadiusToCanvas", "@", "R"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RC", "===", "None"}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"SchemeSquare", "::", "badr"}], ",", "R"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xc", ",", "yc"}], "}"}], "=", "PC"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xr", ",", "yr"}], "}"}], "=", "RC"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicBox", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xc", "-", "xr"}], ",", 
            RowBox[{"xc", "+", "xr"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"yc", "-", "yr"}], ",", 
            RowBox[{"yc", "+", "yr"}]}], "}"}]}], "}"}], ",", "FullOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[TextData[{
 "SchemeCircle follows the basic ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notation of Circle and Disk for the radius, accepting either a number R \
(for a circle) or as a pair {Rxa,Rya} for an ellipse, but accepts special \
heads Horizontal, Vertical, and Point, instead of Offset.  BasicCircle \
requires a pair of x and y radii in canvas displacements."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicCircle", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theta1_", "?", "NumericQ"}], ",", 
       RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}], ",", "FullOpts_List"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "OptPosnX", ",", "OptBufferX", ",", "theta", ",", "RX", ",", "PX", ",", 
       "AngleX"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"option", " ", "processing"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLip", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowHead", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTail", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnX", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "fill", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Disk", "[", 
            RowBox[{"P", ",", "R", ",", 
             RowBox[{"{", 
              RowBox[{"theta1", ",", "theta2"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "outline", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Circle", "[", 
            RowBox[{"P", ",", "R", ",", 
             RowBox[{"{", 
              RowBox[{"theta1", ",", "theta2"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowHead", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"PCOfPA", "/@", 
               RowBox[{"ArrowHeadPoints", "[", 
                RowBox[{
                 RowBox[{"PAOfPC", "[", 
                  RowBox[{"P", "+", 
                   RowBox[{"R", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "theta2", "]"}], ",", 
                    RowBox[{"Sin", "[", "theta2", "]"}]}], "}"}]}]}], "]"}], 
                 ",", 
                 RowBox[{"VectorArcTan", "[", 
                  RowBox[{"-", 
                   RowBox[{"DPAOfPC", "[", 
                    RowBox[{"R", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "theta2", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "theta2", "]"}]}]}], "}"}]}], "]"}]}],
                   "]"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], "]"}]}], 
              "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowTail", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"PCOfPA", "/@", 
               RowBox[{"ArrowHeadPoints", "[", 
                RowBox[{
                 RowBox[{"PAOfPC", "[", 
                  RowBox[{"P", "+", 
                   RowBox[{"R", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "theta1", "]"}], ",", 
                    RowBox[{"Sin", "[", "theta1", "]"}]}], "}"}]}]}], "]"}], 
                 ",", 
                 RowBox[{"VectorArcTan", "[", 
                  RowBox[{"+", 
                   RowBox[{"DPAOfPC", "[", 
                    RowBox[{"R", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "theta1", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "theta1", "]"}]}]}], "}"}]}], "]"}]}],
                   "]"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], "]"}]}], 
              "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "labels", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetL", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetR", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", ",",
           "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetC", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetT", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetB", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"+", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptPosnX", "=", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"PosnX", ",", "0.5", ",", "FullOpts"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"OptBufferX", "=", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"BufferX", ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrientationX", "/.", "FullOpts"}], ")"}], ",", 
              "\[IndentingNewLine]", "Automatic", ",", "1.1", ",", 
              "\[IndentingNewLine]", "Inverted", ",", "1.1", ",", 
              "\[IndentingNewLine]", "Horizontal", ",", "0", ",", 
              "\[IndentingNewLine]", "Vertical", ",", "0", ",", 
              "\[IndentingNewLine]", "_", ",", " ", "1.1"}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"theta", "=", 
          RowBox[{"Interpolate", "[", 
           RowBox[{
           "0", ",", "1", ",", "theta1", ",", "theta2", ",", "OptPosnX"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"RX", "=", 
          RowBox[{"R", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "theta", "]"}], ",", 
             RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AngleX", "=", 
          RowBox[{"VectorArcTan", "[", 
           RowBox[{"DPAOfPC", "[", 
            RowBox[{"R", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "theta", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PX", "=", 
          RowBox[{"P", "+", "RX", "+", 
           RowBox[{"DPCOfPA", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Thickness", "/.", "FullOpts"}], ")"}], "/", "2"}], 
               "+", 
               RowBox[{
                RowBox[{"OptBufferX", "/", "2"}], "*", 
                RowBox[{"(", 
                 RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ")"}], 
             "*", 
             RowBox[{"RX", "/", 
              RowBox[{"VectorLength", "[", "RX", "]"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MakeText", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"LabX", "/.", "FullOpts"}], ")"}], ",", "PX", ",", 
           "AngleX", ",", "\[IndentingNewLine]", 
           RowBox[{"ShowText", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ShowLabX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Offset", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"OffsetX", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Nudge", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"NudgeX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Orientation", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"OrientationX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Background", "->", 
            RowBox[{"(", 
             RowBox[{"BackgroundX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeCircle", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R_", "?", "RadiusQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theta1_", "?", "NumericQ"}], ",", 
       RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeCircle", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "RC"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RC", "=", 
       RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RC", "===", "None"}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"SchemeCircle", "::", "badr"}], ",", "R"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BasicCircle", "[", 
       RowBox[{
        RowBox[{"PCOfPU", "[", "P", "]"}], ",", "RC", ",", 
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2"}], "}"}], ",", "FullOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeCircle", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R_", "?", "RadiusQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SchemeCircle", "[", 
    RowBox[{"P", ",", "R", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "Opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520134296875*^9, 3.395520139109375*^9}}],

Cell["\<\
BasicEllipse breaks convention and takes R in user coordinates, for major and \
minor axis lengths to be meaningful\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicEllipse", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a_", "?", "NumericQ"}], ",", 
        RowBox[{"b_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"theta0_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theta1_", "?", "NumericQ"}], ",", 
       RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Closed", ":", 
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}]}], ",", "FullOpts_List"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "OptPosnX", ",", "OptBufferX", ",", "theta", ",", "r", ",", "RX", ",", 
       "PX", ",", "AngleX", ",", "Points"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"option", " ", "processing"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLip", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowHead", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTail", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnX", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TO", " ", 
        RowBox[{"DO", ":", " ", 
         RowBox[{"validity", " ", "checks", " ", "on", " ", "angles"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"PlotPoints", "/.", "FullOpts"}], ")"}]}]}], ">", 
         RowBox[{"(", 
          RowBox[{"theta2", "-", "theta1"}], ")"}]}], ",", 
        RowBox[{"ErrorMessage", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "*", 
             RowBox[{
              RowBox[{"b", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "^", "2"}], "*", 
                 RowBox[{
                  RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}]}], "+", 
                RowBox[{
                 RowBox[{"b", "^", "2"}], "*", 
                 RowBox[{
                  RowBox[{"Cos", "[", "theta", "]"}], "^", "2"}]}]}], 
               ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"P", "+", 
           RowBox[{"DPCOfPU", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"theta", "+", "theta0"}], "]"}]}], ",", 
              RowBox[{"r", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"theta", "+", "theta0"}], "]"}]}]}], "}"}]}]}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"theta", ",", "theta1", ",", "theta2", ",", 
           RowBox[{"2", "*", 
            RowBox[{"Pi", "/", 
             RowBox[{"(", 
              RowBox[{"PlotPoints", "/.", "FullOpts"}], ")"}]}]}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "fill", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Polygon", "[", 
            RowBox[{"If", "[", 
             RowBox[{"Closed", ",", "Points", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"Points", ",", "P"}], "]"}]}], "]"}], "]"}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "FullOpts"}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "outline", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"If", "[", 
             RowBox[{"Closed", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"Points", ",", 
                RowBox[{"First", "[", "Points", "]"}]}], "]"}], ",", 
              "Points"}], "]"}], "]"}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"TO", " ", 
          RowBox[{"DO", ":", " ", 
           RowBox[{
           "Implement", " ", "arrowheads", " ", "and", " ", "labels"}]}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowHead", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ShowTail", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "labels", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetL", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetR", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "FullOpts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", ",",
           "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetC", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetT", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MakeText", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", 
          RowBox[{"P", "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ShowText", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Offset", "\[Rule]", 
           RowBox[{"GetAutoOption", "[", 
            RowBox[{"OffsetB", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"+", "1"}]}], "}"}], ",", "FullOpts"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Nudge", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Orientation", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "->", 
           RowBox[{"(", 
            RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptPosnX", "=", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"PosnX", ",", "0.5", ",", "FullOpts"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"OptBufferX", "=", 
          RowBox[{"GetAutoOption", "[", 
           RowBox[{"BufferX", ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrientationX", "/.", "FullOpts"}], ")"}], ",", 
              "\[IndentingNewLine]", "Automatic", ",", "1.1", ",", 
              "\[IndentingNewLine]", "Inverted", ",", "1.1", ",", 
              "\[IndentingNewLine]", "Horizontal", ",", "0", ",", 
              "\[IndentingNewLine]", "Vertical", ",", "0", ",", 
              "\[IndentingNewLine]", "_", ",", " ", "1.1"}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "FullOpts"}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"theta", "=", 
          RowBox[{"Interpolate", "[", 
           RowBox[{
           "0", ",", "1", ",", "theta1", ",", "theta2", ",", "OptPosnX"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"RX", "=", 
          RowBox[{"R", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "theta", "]"}], ",", 
             RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AngleX", "=", 
          RowBox[{"VectorArcTan", "[", 
           RowBox[{"DPAOfPC", "[", 
            RowBox[{"R", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "theta", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PX", "=", 
          RowBox[{"P", "+", "RX", "+", 
           RowBox[{"DPCOfPA", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Thickness", "/.", "FullOpts"}], ")"}], "/", "2"}], 
               "+", 
               RowBox[{
                RowBox[{"OptBufferX", "/", "2"}], "*", 
                RowBox[{"(", 
                 RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ")"}], 
             "*", 
             RowBox[{"RX", "/", 
              RowBox[{"VectorLength", "[", "RX", "]"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MakeText", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"LabX", "/.", "FullOpts"}], ")"}], ",", "PX", ",", 
           "AngleX", ",", "\[IndentingNewLine]", 
           RowBox[{"ShowText", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ShowLabX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Offset", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"OffsetX", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Nudge", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"NudgeX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Orientation", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"OrientationX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Background", "->", 
            RowBox[{"(", 
             RowBox[{"BackgroundX", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeEllipse", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"theta0_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theta1_", "?", "NumericQ"}], ",", 
       RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeEllipse", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicEllipse", "[", 
       RowBox[{
        RowBox[{"PCOfPU", "[", "P", "]"}], ",", "R", ",", "theta0", ",", 
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2"}], "}"}], ",", "False", ",", 
        "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeEllipse", "[", 
    RowBox[{
     RowBox[{"P", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"R", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"theta0_", "?", "NumericQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeEllipse", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicEllipse", "[", 
       RowBox[{
        RowBox[{"PCOfPU", "[", "P", "]"}], ",", "R", ",", "theta0", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "True", ",", "FullOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520143578125*^9, 3.39552014725*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeArrow", "[", 
    RowBox[{
     RowBox[{"RawNodes", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PI", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], ",", 
        RowBox[{"Pf", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeArrow", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "Nodes", ",", "R", ",", "P"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Kink", ",", "None", ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Nodes", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"RawNodes", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"P", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ":>", 
            RowBox[{"PCOfPU", "@", "P"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromHead", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "Pf"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromTail", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "PI"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicArrow", "[", 
       RowBox[{"SchemeArrow", ",", "Nodes", ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeArrow", "[", 
    RowBox[{
     RowBox[{"PI", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Pf", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeArrow", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "RawNodes", ",", "Nodes", ",", "R", ",", "P"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Kink", ",", 
        RowBox[{"None", "|", 
         RowBox[{"_", "?", "ArrowNodeQ"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RawNodes", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "PI", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Kink", "/.", "FullOpts"}], ")"}], ",", 
           "\[IndentingNewLine]", "None", ",", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"_", "?", "ArrowNodeQ"}], ",", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{"Kink", "/.", "FullOpts"}], ")"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "ArrowNodeQ"}], ")"}], "..."}], "}"}], ",", 
           RowBox[{"(", 
            RowBox[{"Kink", "/.", "FullOpts"}], ")"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "Pf", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nodes", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"RawNodes", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"P", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ":>", 
            RowBox[{"PCOfPU", "@", "P"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromHead", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "Pf"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FromTail", "[", "R_", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"PCOfPU", "@", "PI"}], "+", 
              RowBox[{"ConvertRadiusToCanvas", "[", "R", "]"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicArrow", "[", 
       RowBox[{"SchemeArrow", ",", "Nodes", ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicSchemeBracket", "[", 
    RowBox[{"Caller_Symbol", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", 
     RowBox[{"Axis", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2", "|", "3", "|", "4"}], ")"}]}], ",", 
     "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "Segment", ",", "HalfWidthForLabels", ",", "Buffer", ",", "Posn", ",", 
       "P", ",", "\[IndentingNewLine]", "LabelGraphics", ",", 
       "\[IndentingNewLine]", "ArrowHeadSign", ",", "\[IndentingNewLine]", 
       "Points"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"calculate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Segment", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Axis", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "y2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "4", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x2", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ArrowHeadSign", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Axis", ",", "\[IndentingNewLine]", 
         RowBox[{"1", "|", "4"}], ",", 
         RowBox[{"+", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"2", "|", "3"}], ",", 
         RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "axis", " ", "label"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "basic", " ", "spacing", " ", "provided", " ", "by", " ", "Offset"}], 
        ",", " ", 
        RowBox[{"additional", " ", "by", " ", "Buffer"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"HalfWidthForLabels", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Thickness", "/.", "FullOpts"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Buffer", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
          "Axis", ",", "1", ",", "BufferB", ",", "2", ",", "BufferL", ",", 
           "3", ",", "BufferT", ",", "4", ",", "BufferR"}], "]"}], ",", "1.1",
          ",", "FullOpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Posn", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
          "Axis", ",", "1", ",", "PosnB", ",", "2", ",", "PosnL", ",", "3", 
           ",", "PosnT", ",", "4", ",", "PosnR"}], "]"}], ",", "0.5", ",", 
         "FullOpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"PCOfPA", "@", 
        RowBox[{"ArrowPoint", "[", 
         RowBox[{"Caller", ",", 
          RowBox[{"PAOfPC", "/@", "Segment"}], ",", "AtUserPosition", ",", 
          "Posn", ",", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{"Axis", ",", 
             RowBox[{"1", "|", "4"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"2", "|", "3"}], ",", 
             RowBox[{"+", "1"}]}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"HalfWidthForLabels", "+", 
             RowBox[{
              RowBox[{"Buffer", "/", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ")"}]}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LabelGraphics", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", "\[IndentingNewLine]", 
         RowBox[{
         "Axis", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetB", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", "P", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetL", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetT", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", "P", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetR", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Combine", " ", "ticks", " ", "with", " ", "axis", " ", "line"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"PCOfPA", "/@", 
            RowBox[{"ArrowHeadPoints", "[", 
             RowBox[{
              RowBox[{"PAOfPC", "/@", 
               RowBox[{"Reverse", "@", "Segment"}]}], ",", 
              RowBox[{
               RowBox[{"-", "HeadLength"}], "/.", "FullOpts"}], ",", 
              RowBox[{"HeadLip", "/.", "FullOpts"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", "ArrowHeadSign"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Segment", ",", "\[IndentingNewLine]", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"PCOfPA", "/@", 
            RowBox[{"ArrowHeadPoints", "[", 
             RowBox[{
              RowBox[{"PAOfPC", "/@", "Segment"}], ",", 
              RowBox[{
               RowBox[{"-", "HeadLength"}], "/.", "FullOpts"}], ",", 
              RowBox[{"HeadLip", "/.", "FullOpts"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"+", "1"}], "*", "ArrowHeadSign"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"axis", " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MakeOutline", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Line", "[", "Points", "]"}], "}"}], ",", "FullOpts"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "labels", " ", "*)"}], "\[IndentingNewLine]", 
         "LabelGraphics"}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBracket", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Bottom", "|", "Top"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xa_", "?", "NumericQ"}], ",", 
       RowBox[{"xb_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"y_", "?", "NumericQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeBracket", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
       "Side", ",", "\[IndentingNewLine]", "Bottom", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BasicSchemeBracket", "[", 
         RowBox[{"SchemeBracket", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "xa", "]"}], ",", 
              RowBox[{"XCOfXU", "[", "xb", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "y", "]"}], ",", "Null"}], "}"}]}], 
           "}"}], ",", "1", ",", "FullOpts"}], "]"}], ",", 
        "\[IndentingNewLine]", "Top", ",", "\[IndentingNewLine]", 
        RowBox[{"BasicSchemeBracket", "[", 
         RowBox[{"SchemeBracket", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "xa", "]"}], ",", 
              RowBox[{"XCOfXU", "[", "xb", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"YCOfYU", "[", "y", "]"}]}], "}"}]}], "}"}], ",", "3", 
          ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBracket", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ya_", "?", "NumericQ"}], ",", 
       RowBox[{"yb_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SchemeBracket", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
       "Side", ",", "\[IndentingNewLine]", "Left", ",", "\[IndentingNewLine]",
         
        RowBox[{"BasicSchemeBracket", "[", 
         RowBox[{"SchemeBracket", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "x", "]"}], ",", "Null"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "ya", "]"}], ",", 
              RowBox[{"YCOfYU", "[", "yb", "]"}]}], "}"}]}], "}"}], ",", "2", 
          ",", "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", "Right", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BasicSchemeBracket", "[", 
         RowBox[{"SchemeBracket", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"XCOfXU", "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "ya", "]"}], ",", 
              RowBox[{"YCOfYU", "[", "yb", "]"}]}], "}"}]}], "}"}], ",", "4", 
          ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBracket", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Bottom", "|", "Top"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IDi_", "?", "LevelIdentifierQ"}], ",", 
       RowBox[{"IDf_", "?", "LevelIdentifierQ"}]}], "}"}], ",", 
     RowBox[{"y_", "?", "NumericQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDi", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDf", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeBracket", "[", 
       RowBox[{"Side", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"XUOfXC", "@", 
           RowBox[{"LevelScheme`Data`xa", "[", "IDi", "]"}]}], ",", 
          RowBox[{"XUOfXC", "@", 
           RowBox[{"LevelScheme`Data`xb", "[", "IDf", "]"}]}]}], "}"}], ",", 
        "y", ",", "Opts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeBracket", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IDi_", "?", "LevelIdentifierQ"}], ",", 
       RowBox[{"IDf_", "?", "LevelIdentifierQ"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDi", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckLevel", "[", "IDf", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeBracket", "[", 
       RowBox[{"Side", ",", "x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"YUOfYC", "@", 
           RowBox[{"LevelScheme`Data`Energy", "[", "IDi", "]"}]}], ",", 
          RowBox[{"YUOfYC", "@", 
           RowBox[{"LevelScheme`Data`Energy", "[", "IDf", "]"}]}]}], "}"}], 
        ",", "Opts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell["\<\
3D arrow
\tRespects only those options recognized by MakeOutline3D (no Layer), \
produces graphics primatives (rather than SchemeGraphics)
\tOnly LineArrow implemented, with no labels

Note on arrow head rotation calculation:  RotationMatrix3D for (\[Alpha],\
\[Beta],\[Gamma]) uses Euler angle convention (-z,-x,-z), if considered as an \
active transformation, and rotates with respect to the original unrotated \
frame coordinates if rotations are carried out in the order written. \
Therefore a point on the z-axis is rotated under (\[Alpha],\[Beta],\[Gamma]) \
to polar angle \[Theta]=\[Beta] and azimuthal angle \[Phi]=\[Pi]/2-\[Gamma], \
independent of \[Alpha].\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ArrowHeadPoints3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P1_", ",", "P2_"}], "}"}], ",", "HeadLength_", ",", "HeadLip_",
      ",", "HeadAngle_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "Normv", ",", "u", ",", "\[IndentingNewLine]", "alpha", ",", 
       "beta", ",", "gamma", ",", "\[IndentingNewLine]", "R"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"P2", "-", "P1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Normv", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "^", "2"}], "&"}], ")"}], "/@", "v"}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Normv", "==", "0."}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"v", "/", "Normv"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", "HeadAngle"}], ";", "\[IndentingNewLine]", 
      RowBox[{"beta", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"u", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"gamma", "=", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", 
        RowBox[{"VectorArcTan", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"u", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       RowBox[{"RotationMatrix3D", "[", 
        RowBox[{"alpha", ",", "beta", ",", "gamma"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P2", "+", 
         RowBox[{"R", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "HeadLip"}], ",", "0.", ",", 
            RowBox[{"-", "HeadLength"}]}], "}"}]}]}], ",", 
        "\[IndentingNewLine]", "P2", ",", "\[IndentingNewLine]", 
        RowBox[{"P2", "+", 
         RowBox[{"R", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "HeadLip"}], ",", "0.", ",", 
            RowBox[{"-", "HeadLength"}]}], "}"}]}]}]}], "\[IndentingNewLine]",
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicArrow3D", "[", 
    RowBox[{
    "Caller_Symbol", ",", "PI_", ",", "Pf_", ",", "HeadAngle_", ",", 
     "FullOpts_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "OptWidth", ",", "OptHeadLength", ",", "OptHeadLip", ",", 
       "OptThickness", ",", "Segment", ",", "TailSegment", ",", "PC", ",", 
       "Art"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"ArrowType", ",", "LineArrow", ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"HeadLip", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowHead", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTail", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PosnC", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"calculate", " ", "arrow", " ", "geometry"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"OptWidth", "=", 
       RowBox[{"(", 
        RowBox[{"Width", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptHeadLength", "=", 
       RowBox[{"(", 
        RowBox[{"HeadLength", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptHeadLip", "=", 
       RowBox[{"(", 
        RowBox[{"HeadLip", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptThickness", "=", 
       RowBox[{"(", 
        RowBox[{"Thickness", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Segment", "=", 
       RowBox[{"{", 
        RowBox[{"PI", ",", "Pf"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TailSegment", "=", "Segment"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"PC", "=", 
       RowBox[{"PI", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pf", "-", "PI"}], ")"}], "*", 
         RowBox[{"GetAutoOption", "[", 
          RowBox[{"PosnC", ",", "0.5", ",", "FullOpts"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Art", "=", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"main", " ", "segment"}], " ", "*)"}], "\[IndentingNewLine]",
         
        RowBox[{
         RowBox[{"MakeOutline3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Line", "[", "Segment", "]"}], "}"}], ",", "FullOpts"}], 
          "]"}], " ", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ShowHead", "/.", "FullOpts"}], ",", "\[IndentingNewLine]",
            
           RowBox[{"MakeOutline3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", 
               RowBox[{"ArrowHeadPoints3D", "[", 
                RowBox[{
                "Segment", ",", "OptHeadLength", ",", "OptHeadLip", ",", 
                 "HeadAngle"}], "]"}], "]"}], "}"}], ",", 
             RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ShowTail", "/.", "FullOpts"}], ",", "\[IndentingNewLine]",
            
           RowBox[{"MakeOutline3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", 
               RowBox[{"ArrowHeadPoints3D", "[", 
                RowBox[{
                 RowBox[{"Reverse", "@", "TailSegment"}], ",", 
                 "OptHeadLength", ",", "OptHeadLip", ",", "HeadAngle"}], 
                "]"}], "]"}], "}"}], ",", 
             RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "label", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MakeText3D", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"LabC", "/.", "FullOpts"}], ")"}], ",", " ", "PC", ",", 
           "0", ",", "\[IndentingNewLine]", 
           RowBox[{"ShowText", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ShowLabC", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Offset", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"OffsetC", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Orientation", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"OrientationC", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Background", "->", 
            RowBox[{"(", 
             RowBox[{"BackgroundC", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "Art", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520155734375*^9, 3.3955201593125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SchemeArrow3D", "[", 
     RowBox[{
      RowBox[{"PI", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"Pf", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"HeadAngle", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], ":", "0"}]}], ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeArrow3D", ",", "Opts"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"BasicArrow3D", "[", 
       RowBox[{
       "SchemeArrow3D", ",", "PI", ",", "Pf", ",", "HeadAngle", ",", 
        "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "   "}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicLine3D", "[", 
    RowBox[{"Points_List", ",", "FullOpts_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "outline", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"MakeOutline3D", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", "Points", "]"}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SchemeLine3D", "[", 
     RowBox[{
      RowBox[{"Points", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeLine3D", ",", "Opts"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"BasicLine3D", "[", 
       RowBox[{"Points", ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "   "}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics inclusion", "Section"],

Cell[CellGroupData[{

Cell["Raw graphics", "Subsection"],

Cell[TextData[{
 "Conversion of user to canvas coordinates allowing the generalized ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Scaled and Offset coordinates"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeScaleP", "[", 
    RowBox[{"Offset", "[", 
     RowBox[{
      RowBox[{"DPA", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "GeneralP_"}], "]"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"DPCOfPA", "[", "DPA", "]"}], "+", 
    RowBox[{"SchemeScaleP", "[", "GeneralP", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeScaleP", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{
      RowBox[{"DPS", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"PU", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DPCOfPS", "[", "DPS", "]"}], "+", 
    RowBox[{"PCOfPU", "[", "PU", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeScaleP", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"PS", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"PCOfPS", "[", "PS", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeScaleP", "[", 
    RowBox[{"PU", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"PCOfPU", "[", "PU", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeScaleP", "[", "x_", "]"}], ":=", 
   RowBox[{"ErrorMessage", "[", 
    RowBox[{
     RowBox[{"RawGraphics", "::", "badpoint"}], ",", "Expr"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Note on conversion of Graphics to SchemeGraphics:
A finished SchemeGraphics is of the form \
SchemeGraphics[{directives},{primatives},LayerSpec], satisfying the following \
assumptions:
\tAll relevant graphics properties are specified by {directives} -- color, \
thickness (if lines present), dashing (if lines present).
\tThe top layer of {primatives} does not contain directives.  (This prevents \
side effects when {primatives} is joined to other lists.)
SchemeGraphics are produced directly in this form by the Make.... functions.  \

The primatives in raw Graphics objects can in general not be trusted and must \
be quarantined in a sublist.\
\>", "Text",
 CellChangeTimes->{3.3955204155*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"basic", " ", 
    RowBox[{"case", " ", "--"}], "Graphics", " ", "with", " ", "only", " ", 
    "primatives", " ", "list", " ", "as", " ", "argument"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{
       RowBox[{"GraphicsSeq", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Graphics", "[", "_List", "]"}], "..."}], ")"}]}], ",", 
       RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FullOpts", "=", 
          RowBox[{"RealizeOptions", "[", 
           RowBox[{"RawGraphics", ",", "Opts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "ScaledGraphicsList", ",", 
         "ClippedGraphicsList", ",", "Result"}], "\[IndentingNewLine]", "}"}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CheckOption", "[", 
         RowBox[{"ClipToRectangle", ",", 
          RowBox[{"True", "|", "False", "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
          "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CheckOption", "[", 
         RowBox[{"Show", ",", 
          RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CheckOption", "[", 
         RowBox[{"Debug", ",", 
          RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", "\"\<RawGraphics: Given\>\"", "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"First", "/@", 
            RowBox[{"{", "GraphicsSeq", "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", "\"\<RawGraphics: Scaling\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ScaledGraphicsList", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TransformGraphics", "[", 
             RowBox[{"#", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"SchemeScaleP", "[", "#", "]"}], "&"}], ")"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"{", "GraphicsSeq", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"First", "/@", "ScaledGraphicsList"}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<RawGraphics: Cropping \>\"", ",", "$RegionRange"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ClippedGraphicsList", "=", 
         RowBox[{"Switch", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ClipToRectangle", "/.", "FullOpts"}], ",", 
           "\[IndentingNewLine]", "True", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ClipToRectangle", "[", 
               RowBox[{"$RegionRange", ",", "#"}], "]"}], "&"}], ")"}], "/@", 
            "ScaledGraphicsList"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ClipToRectangle", "[", 
               RowBox[{
                RowBox[{"ConvertCoordinate", "[", 
                 RowBox[{"RegionCoords", ",", "CanvasCoords", ",", "C", ",", 
                  RowBox[{"ClipToRectangle", "/.", "FullOpts"}]}], "]"}], ",",
                 "#"}], "]"}], "&"}], ")"}], "/@", "ScaledGraphicsList"}], 
           ",", "\[IndentingNewLine]", "False", ",", "ScaledGraphicsList"}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"First", "/@", "ClippedGraphicsList"}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", "\"\<RawGraphics: Making\>\"", "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Result", "=", 
         RowBox[{"MakeRawGraphics", "[", 
          RowBox[{
           RowBox[{"First", "/@", "ClippedGraphicsList"}], ",", "FullOpts"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Debug", "/.", "FullOpts"}], ",", 
          RowBox[{"Print", "[", "Result", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "Result"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "typecast", " ", "ContourGraphics", " ", "or", " ", "DensityGraphics", 
     " ", "to", " ", "Graphics"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{"X___", ",", 
       RowBox[{"G", ":", 
        RowBox[{"(", 
         RowBox[{"_ContourGraphics", "|", "_DensityGraphics"}], ")"}]}], ",", 
       "Y___"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"RawGraphics", "[", 
        RowBox[{"X", ",", 
         RowBox[{"Graphics", "[", "G", "]"}], ",", "Y"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"strip", " ", "graphics", " ", "options"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{"X___", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"Arg_", ",", 
         RowBox[{"__", "?", "OptionQ"}]}], "]"}], ",", "Y___"}], "]"}], ":=", 
     
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"RawGraphics", "[", 
        RowBox[{"X", ",", 
         RowBox[{"Graphics", "[", "Arg", "]"}], ",", "Y"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "discard", " ", "graphics", " ", "with", " ", "no", " ", "argument"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{"X___", ",", 
       RowBox[{"Graphics", "[", "]"}], ",", "Y___"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"RawGraphics", "::", "empty"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RawGraphics", "[", 
         RowBox[{"X", ",", "Y"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"wrap", " ", "any", " ", "non"}], "-", 
     RowBox[{
     "list", " ", "first", " ", "element", " ", "of", " ", "graphics", " ", 
      RowBox[{"object", " ", "--"}], " ", "syntax", " ", "not", " ", 
      "documented", " ", "by", " ", "Mathematica", " ", "but", " ", 
      "supported", " ", "by", " ", "show", " ", "and", " ", "can", " ", 
      "occur", " ", "in", " ", "Graphics", " ", "cast", " ", "of", " ", 
      "DensityGraphics"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{"X___", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"Primative_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "Primative", "]"}], "=!=", "List"}], ")"}]}], 
        "]"}], ",", "Y___"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"RawGraphics", "[", 
        RowBox[{"X", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "Primative", "}"}], "]"}], ",", "Y"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "discard", " ", "graphics", " ", "with", " ", "more", " ", "than", " ", 
      "one", " ", "non"}], "-", 
     RowBox[{"option", " ", "argument"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RawGraphics", "[", 
      RowBox[{"X___", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"_", ",", "___", ",", 
         RowBox[{"Arg", "/;", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"OptionQ", "[", "Arg", "]"}]}], ")"}]}], ",", "___"}], 
        "]"}], ",", "Y___"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"RawGraphics", "::", "multiarg"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RawGraphics", "[", 
         RowBox[{"X", ",", "Y"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39636969540625*^9, 3.396369700890625*^9}, {
  3.396543699984375*^9, 3.3965437014375*^9}, {3.3965522750625*^9, 
  3.396552276296875*^9}, {3.396552318015625*^9, 3.3965523268125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Raw graphics 3D", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RawGraphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsSeq", ":", 
      RowBox[{"(", 
       RowBox[{"___", "?", "Graphics3DQ"}], ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"RawGraphics3D", ",", "Opts"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Debug", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MakeRawGraphics3D", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"{", "GraphicsSeq", "}"}]}], ",", "FullOpts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D viewport", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Graphics3DQ", "[", 
    RowBox[{"Graphics3D", "[", "_List", "]"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphics3DQ", "[", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"_List", ",", 
      RowBox[{"_", "?", "FlatOptionListQ"}]}], "]"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphics3DQ", "[", "_", "]"}], "=", "False"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"drop", " ", "nongraphical"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CombineGraphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"U___", ",", 
        RowBox[{"X_", "/;", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"X", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"_", "?", "Graphics3DQ"}], ")"}], "|", 
              RowBox[{"(", "_SurfaceGraphics", ")"}]}]}], "]"}]}], ")"}]}], 
        ",", "V___"}], "}"}], "]"}], ":=", 
     RowBox[{"CombineGraphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"U", ",", "V"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{"convert", " ", "SurfaceGraphics", " ", "to", " ", "Graphics3D"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CombineGraphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"U___", ",", "X_SurfaceGraphics", ",", "V___"}], "}"}], "]"}], 
     ":=", 
     RowBox[{"CombineGraphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"U", ",", 
        RowBox[{"Graphics3D", "[", "X", "]"}], ",", "V"}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"do", " ", 
     RowBox[{"combination", " ", "--"}], " ", "primatives", " ", 
     "quarantined", " ", "in", " ", "sublists"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CombineGraphics3D", "[", 
      RowBox[{"GList", ":", 
       RowBox[{"{", 
        RowBox[{"___", "?", "Graphics3DQ"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"First", "/@", "GList"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Use Sign +1 for active rotation in RH sense, -1 for passive rotation in RH \
sense.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AxisRotationMatrix", "[", 
    RowBox[{"1", ",", "theta_", ",", 
     RowBox[{"Sign", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"+", "1"}], "|", 
        RowBox[{"-", "1"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "theta", "]"}], ",", 
       RowBox[{
        RowBox[{"-", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"+", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisRotationMatrix", "[", 
    RowBox[{"2", ",", "theta_", ",", 
     RowBox[{"Sign", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"+", "1"}], "|", 
        RowBox[{"-", "1"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"+", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisRotationMatrix", "[", 
    RowBox[{"3", ",", "theta_", ",", 
     RowBox[{"Sign", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"+", "1"}], "|", 
        RowBox[{"-", "1"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", 
       RowBox[{
        RowBox[{"-", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"+", "Sign"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
       RowBox[{"Cos", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RotationMatrix3DActiveY", "[", 
    RowBox[{"{", 
     RowBox[{"alpha_", ",", "beta_", ",", "gamma_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AxisRotationMatrix", "[", 
     RowBox[{"3", ",", "gamma", ",", 
      RowBox[{"+", "1"}]}], "]"}], ".", 
    RowBox[{"AxisRotationMatrix", "[", 
     RowBox[{"2", ",", "beta", ",", 
      RowBox[{"+", "1"}]}], "]"}], ".", 
    RowBox[{"AxisRotationMatrix", "[", 
     RowBox[{"3", ",", "alpha", ",", 
      RowBox[{"+", "1"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"BasicViewPort3D", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicViewPort3D", "[", 
    RowBox[{"GList_List", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1c_", "?", "NumericQ"}], ",", 
         RowBox[{"x2c_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y1c_", "?", "NumericQ"}], ",", 
         RowBox[{"y2c_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
     "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "ScaledGraphicsList", ",", "ClippedGraphicsList", ",", "Result", ",", 
       "\[IndentingNewLine]", "Primatives", ",", "RotationMatrix", ",", 
       "UsedOptions"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Background", ",", 
        RowBox[{"None", "|", "ColorDirectivePattern"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"BackgroundOpacity", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"BlockOptions", ",", 
        RowBox[{"{", "___Symbol", "}"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Debug", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"EulerRotation", ",", 
        RowBox[{"None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"AxisScaling", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"AxisScaling", "/.", "FullOpts"}], ")"}], "=!=", 
           "Automatic"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"PlotRange", "/.", "FullOpts"}], ")"}], "\[Equal]", 
           "Automatic"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{"ViewPort3D", "::", "prange"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Primatives", "=", 
       RowBox[{"BlockOptions", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"OptionSymbols3D", ",", 
           RowBox[{"(", 
            RowBox[{"BlockOptions", "/.", "FullOpts"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"First", "[", 
          RowBox[{"CombineGraphics3D", "[", 
           RowBox[{"Flatten", "[", "GList", "]"}], "]"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"EulerRotation", "/.", "FullOpts"}], ")"}], "=!=", "None"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RotationMatrix", "=", 
          RowBox[{"RotationMatrix3DActiveY", "[", 
           RowBox[{"EulerRotation", "/.", "FullOpts"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Primatives", "=", 
          RowBox[{"First", "@", 
           RowBox[{"TransformGraphics", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", "Primatives", "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RotationMatrix", ".", "#"}], "&"}], ")"}]}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Debug", "/.", "FullOpts"}], ")"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Primatives", "//", "Short"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedOptions", "=", 
       RowBox[{"OptionsUnion", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"AxisScaling", "/.", "FullOpts"}], ")"}], "===", 
             "Automatic"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"BoxRatios", "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"AxisScaling", "/.", "FullOpts"}], ")"}], "*", 
               RowBox[{"-", 
                RowBox[{"Subtract", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"PlotRange", "/.", "FullOpts"}], ")"}]}]}]}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegacyFilterOptions", "[", 
           RowBox[{"Graphics3D", ",", "FullOpts"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Debug", "/.", "FullOpts"}], ")"}], ",", 
        RowBox[{"Print", "[", "UsedOptions", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "background", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Background", "/.", "FullOpts"}], ")"}], "=!=", "None"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1c", ",", "y1c"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x2c", ",", "y2c"}], "}"}]}], "]"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Color", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Background", "/.", "FullOpts"}], ")"}]}], ",", 
            RowBox[{"Opacity", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"BackgroundOpacity", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ShowFill", "\[Rule]", "True"}], ",", 
            RowBox[{"FillColor", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"FillOpacity", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"ClipToRectangle", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "contents", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MakeVerbatim", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1c", ",", "y1c"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2c", ",", "y2c"}], "}"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Primatives", ",", "UsedOptions"}], "]"}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", "FullOpts"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.395089864515625*^9, {3.395091949265625*^9, 3.39509195153125*^9}, {
   3.396636964921875*^9, 3.396636997796875*^9}, {3.396637196*^9, 
   3.396637197234375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ViewPort3D", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ViewPort3D", "[", 
    RowBox[{"GList_List", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1_", "?", "NumericQ"}], ",", 
         RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y1_", "?", "NumericQ"}], ",", 
         RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"ViewPort3D", ",", "Opts"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BasicViewPort3D", "[", 
      RowBox[{"GList", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"XCOfXU", "/@", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], "}"}]}], ",", 
         RowBox[{"YCOfYU", "/@", 
          RowBox[{"{", 
           RowBox[{"y1", ",", "y2"}], "}"}]}]}], "}"}], ",", "FullOpts"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ScaledViewPort3D", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledViewPort3D", "[", 
    RowBox[{"GList_List", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1s_", "?", "NumericQ"}], ",", 
         RowBox[{"x2s_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y1s_", "?", "NumericQ"}], ",", 
         RowBox[{"y2s_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"ScaledViewPort3D", ",", "Opts"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BasicViewPort3D", "[", 
      RowBox[{"GList", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"XCOfXS", "/@", 
          RowBox[{"{", 
           RowBox[{"x1s", ",", "x2s"}], "}"}]}], ",", 
         RowBox[{"YCOfYS", "/@", 
          RowBox[{"{", 
           RowBox[{"y1s", ",", "y2s"}], "}"}]}]}], "}"}], ",", "FullOpts"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39509195228125*^9, 3.395091959875*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axes and panels", "Section"],

Cell[CellGroupData[{

Cell["Basic axis object", "Subsection"],

Cell["\<\
BasicAxis draws a line segment, arrowhead, tick marks, and tick labels.
Ticks must be in full explicit form.  All coordinates, including tick \
lengths, must be in canvas coordinates.
The \"unneeded\" coordinate for the axis may have any value, not necessarily \
even numeric, since it is never referenced\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicAxis", "[", 
    RowBox[{"Caller_Symbol", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", 
     RowBox[{"Axis", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2", "|", "3", "|", "4"}], ")"}]}], ",", 
     RowBox[{"ShowAxis", ":", 
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}]}], ",", 
     RowBox[{"ShowHead", ":", 
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}]}], ",", "Ticks_List", ",", 
     "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "Segment", ",", "HalfWidthForLabels", ",", "Buffer", ",", "Posn", ",", 
       "P", ",", "\[IndentingNewLine]", "TickGraphics", ",", "LabelGraphics", 
       ",", "\[IndentingNewLine]", "TickData", ",", "TickPosn", ",", 
       "TickText", ",", "TickLengths", ",", "TickAttributes", ",", 
       "\[IndentingNewLine]", "TickPoint", ",", "TickEndPoints", ",", 
       "TickOffset"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"calculate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Segment", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Axis", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "y2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "4", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x2", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "ticks"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"TickGraphics", "=", 
       RowBox[{"TableForEach", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "TickPosn", ",", "TickText", ",", "TickLengths", ",", 
             "TickAttributes"}], "}"}], "=", "TickData"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TickText", "===", "\"\<\>\""}], ",", 
            RowBox[{"TickText", "=", "None"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
           "Axis", ",", "\[IndentingNewLine]", "1", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TickPoint", "=", 
              RowBox[{"{", 
               RowBox[{"TickPosn", ",", "y1"}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TickEndPoints", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TickPoint", "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"TickPoint", "-", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"TickOffset", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"+", "1"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
            "2", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TickPoint", "=", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "TickPosn"}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TickEndPoints", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TickPoint", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], ",", 
                
                RowBox[{"TickPoint", "-", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"TickOffset", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", "1"}], ",", "0"}], "}"}]}]}], ",", 
            "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TickPoint", "=", 
              RowBox[{"{", 
               RowBox[{"TickPosn", ",", "y2"}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TickEndPoints", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TickPoint", "-", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"TickPoint", "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"TickOffset", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
            "4", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TickPoint", "=", 
              RowBox[{"{", 
               RowBox[{"x2", ",", "TickPosn"}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TickEndPoints", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TickPoint", "-", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], ",", 
                
                RowBox[{"TickPoint", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TickLengths", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"TickOffset", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeOutline", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{"TickAttributes", ",", 
                 RowBox[{"{", 
                  RowBox[{"Line", "[", "TickEndPoints", "]"}], "}"}]}], "]"}],
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Chop", "[", 
                  RowBox[{"DPAOfPC", "[", 
                   RowBox[{"Subtract", "@@", "TickEndPoints"}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"ShowLine", "\[Rule]", "False"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Dashing", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowLine", "->", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickShowLine", ",", 
                 RowBox[{"ShowLine", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"LineColor", "->", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickLineColor", ",", 
                 RowBox[{"LineColor", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"LineOpacity", "->", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickLineOpacity", ",", 
                 RowBox[{"LineOpacity", "/.", "FullOpts"}], ",", "FullOpts"}],
                 "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Thickness", "->", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickThickness", ",", 
                 RowBox[{"Thickness", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "FullOpts"}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"MakeText", "[", 
             RowBox[{
             "TickText", ",", "TickPoint", ",", "0", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ShowText", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Offset", "\[Rule]", "TickOffset"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Nudge", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TickNudge", "/.", "FullOpts"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Orientation", "\[Rule]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Background", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"FontFamily", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontFamily", ",", 
                 RowBox[{"FontFamily", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontSize", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontSize", ",", 
                 RowBox[{"FontSize", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontWeight", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontWeight", ",", 
                 RowBox[{"FontWeight", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontSlant", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontSlant", ",", 
                 RowBox[{"FontSlant", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontTracking", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontTracking", ",", 
                 RowBox[{"FontTracking", "/.", "FullOpts"}], ",", 
                 "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontColor", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontColor", ",", 
                 RowBox[{"FontColor", "/.", "FullOpts"}], ",", "FullOpts"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FontOpacity", "\[Rule]", 
               RowBox[{"GetAutoOption", "[", 
                RowBox[{"TickFontOpacity", ",", 
                 RowBox[{"FontOpacity", "/.", "FullOpts"}], ",", "FullOpts"}],
                 "]"}]}], ",", "\[IndentingNewLine]", "FullOpts"}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "pass", " ", "on", " ", "default", " ", "color", " ", "and", 
               " ", "optional", " ", "Layer", " ", "from", " ", "FullOpts"}], 
              " ", "*)"}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"TickData", ",", "Ticks"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "axis", " ", "label"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "basic", " ", "spacing", " ", "provided", " ", "by", " ", "Offset"}], 
        ",", " ", 
        RowBox[{"additional", " ", "by", " ", "Buffer"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"HalfWidthForLabels", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Thickness", "/.", "FullOpts"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Buffer", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
          "Axis", ",", "1", ",", "BufferB", ",", "2", ",", "BufferL", ",", 
           "3", ",", "BufferT", ",", "4", ",", "BufferR"}], "]"}], ",", "1.1",
          ",", "FullOpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Posn", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
          "Axis", ",", "1", ",", "PosnB", ",", "2", ",", "PosnL", ",", "3", 
           ",", "PosnT", ",", "4", ",", "PosnR"}], "]"}], ",", "0.5", ",", 
         "FullOpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"PCOfPA", "@", 
        RowBox[{"ArrowPoint", "[", 
         RowBox[{"Caller", ",", 
          RowBox[{"PAOfPC", "/@", "Segment"}], ",", "AtUserPosition", ",", 
          "Posn", ",", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{"Axis", ",", 
             RowBox[{"1", "|", "4"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"2", "|", "3"}], ",", 
             RowBox[{"+", "1"}]}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"HalfWidthForLabels", "+", 
             RowBox[{
              RowBox[{"Buffer", "/", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"FontSize", "/.", "FullOpts"}], ")"}]}]}], ")"}]}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LabelGraphics", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", "\[IndentingNewLine]", 
         RowBox[{
         "Axis", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabB", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetB", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundB", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabL", "/.", "FullOpts"}], ")"}], ",", "P", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetL", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundL", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabT", "/.", "FullOpts"}], ")"}], ",", "P", ",", "0", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetT", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundT", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]",
           
          RowBox[{"MakeText", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LabR", "/.", "FullOpts"}], ")"}], ",", "P", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ShowText", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"ShowLabR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"OffsetR", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Nudge", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"NudgeR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Orientation", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrientationR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "->", 
             RowBox[{"(", 
              RowBox[{"BackgroundR", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "FullOpts"}], " ", "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Combine", " ", "ticks", " ", "with", " ", "axis", " ", "line"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"axis", " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"ShowAxis", ",", "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", "Segment", "]"}], "}"}], ",", "FullOpts"}],
             "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"ShowHead", ",", "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", 
               RowBox[{"PCOfPA", "/@", 
                RowBox[{"ArrowHeadPoints", "[", 
                 RowBox[{
                  RowBox[{"PAOfPC", "/@", "Segment"}], ",", 
                  RowBox[{"HeadLength", "/.", "FullOpts"}], ",", 
                  RowBox[{"HeadLip", "/.", "FullOpts"}]}], "]"}]}], "]"}], 
              "}"}], ",", 
             RowBox[{"Dashing", "\[Rule]", "None"}], ",", "FullOpts"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
          
         RowBox[{"(*", " ", "ticks", " ", "*)"}], "\[IndentingNewLine]", 
         "TickGraphics", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "labels", " ", "*)"}], "\[IndentingNewLine]", 
         "LabelGraphics"}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395520168859375*^9, 3.395520172234375*^9}, {
  3.39663458421875*^9, 3.3966345961875*^9}, {3.396635370375*^9, 
  3.396635382828125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SchemeAxis", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxis", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Bottom", "|", "Top"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"xa_", ",", "xb_"}], "}"}], ",", "y_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeAxis", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "TickList"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTicks", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabels", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ticks", "/.", "FullOpts"}], ")"}], ",", "None", ",", 
         RowBox[{"{", "}"}], ",", "_List", ",", 
         RowBox[{"Ticks", "/.", "FullOpts"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"AugmentTicks", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.0075", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "}"}], ",", "TickList"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"TransformTicks", "[", 
        RowBox[{"XCOfXU", ",", "DYCTick", ",", 
         RowBox[{"LimitTickRange", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xa", ",", "xb"}], "}"}], ",", "TickList"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ShowTickLabels", "/.", "FullOpts"}], ",", "TickList", ",", 
         RowBox[{"StripTickLabels", "[", "TickList", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ShowTicks", "/.", "FullOpts"}], ",", "TickList", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
       "Side", ",", "\[IndentingNewLine]", "Bottom", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BasicAxis", "[", 
         RowBox[{"SchemeAxis", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "xa", "]"}], ",", 
              RowBox[{"XCOfXU", "[", "xb", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "y", "]"}], ",", "Null"}], "}"}]}], 
           "}"}], ",", "1", ",", "True", ",", 
          RowBox[{"(", 
           RowBox[{"ShowHead", "/.", "FullOpts"}], ")"}], ",", "TickList", 
          ",", "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", "Top", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BasicAxis", "[", 
         RowBox[{"SchemeAxis", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "xa", "]"}], ",", 
              RowBox[{"XCOfXU", "[", "xb", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"YCOfYU", "[", "y", "]"}]}], "}"}]}], "}"}], ",", "3", 
          ",", "True", ",", 
          RowBox[{"(", 
           RowBox[{"ShowHead", "/.", "FullOpts"}], ")"}], ",", "TickList", 
          ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxis", "[", 
    RowBox[{
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right"}], ")"}]}], ",", "x_", ",", 
     RowBox[{"{", 
      RowBox[{"ya_", ",", "yb_"}], "}"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemeAxis", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "TickList"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTicks", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabels", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ticks", "/.", "FullOpts"}], ")"}], ",", "None", ",", 
         RowBox[{"{", "}"}], ",", "_List", ",", 
         RowBox[{"Ticks", "/.", "FullOpts"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"AugmentTicks", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.01", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "}"}], ",", "TickList"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"TransformTicks", "[", 
        RowBox[{"YCOfYU", ",", "DXCTick", ",", 
         RowBox[{"LimitTickRange", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ya", ",", "yb"}], "}"}], ",", "TickList"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ShowTickLabels", "/.", "FullOpts"}], ",", "TickList", ",", 
         RowBox[{"StripTickLabels", "[", "TickList", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TickList", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ShowTicks", "/.", "FullOpts"}], ",", "TickList", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
       "Side", ",", "\[IndentingNewLine]", "Left", ",", "\[IndentingNewLine]",
         
        RowBox[{"BasicAxis", "[", 
         RowBox[{"SchemeAxis", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"XCOfXU", "[", "x", "]"}], ",", "Null"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "ya", "]"}], ",", 
              RowBox[{"YCOfYU", "[", "yb", "]"}]}], "}"}]}], "}"}], ",", "2", 
          ",", "True", ",", 
          RowBox[{"(", 
           RowBox[{"ShowHead", "/.", "FullOpts"}], ")"}], ",", "TickList", 
          ",", "FullOpts"}], "]"}], ",", "\[IndentingNewLine]", "Right", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BasicAxis", "[", 
         RowBox[{"SchemeAxis", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"XCOfXU", "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"YCOfYU", "[", "ya", "]"}], ",", 
              RowBox[{"YCOfYU", "[", "yb", "]"}]}], "}"}]}], "}"}], ",", "4", 
          ",", "True", ",", 
          RowBox[{"(", 
           RowBox[{"ShowHead", "/.", "FullOpts"}], ")"}], ",", "TickList", 
          ",", "FullOpts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multipanel", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RangePattern", "=", 
   RowBox[{"(", 
    RowBox[{"Automatic", "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TickPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "Automatic", "|", 
     RowBox[{"_", "?", "TickListQ"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VectorOfQ", "[", 
    RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"VectorQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixOfQ", "[", 
    RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"MatrixQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorPattern", "[", "p_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorOfQ", "[", 
        RowBox[{"#", ",", "p"}], "]"}], "&"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixPattern", "[", "p_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MatrixOfQ", "[", 
        RowBox[{"#", ",", "p"}], "]"}], "&"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpgradeMultipanelArray", "[", 
     RowBox[{"Data_", ",", 
      RowBox[{"Sense", ":", "Horizontal"}], ",", 
      RowBox[{"{", 
       RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
      "OptionName_Symbol", ",", "EntryPattern_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"Data", ",", "EntryPattern"}], "]"}], ")"}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"Data", ",", 
       RowBox[{"{", "Columns", "}"}]}], "]"}], ",", "Sense", ",", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "OptionName", ",", 
     "EntryPattern"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpgradeMultipanelArray", "[", 
     RowBox[{"Data_", ",", 
      RowBox[{"Sense", ":", "Horizontal"}], ",", 
      RowBox[{"{", 
       RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
      "OptionName_Symbol", ",", "EntryPattern_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"Data", ",", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "EntryPattern"}], "]"}], "&"}]}], "]"}], ")"}]}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"Data", ",", 
       RowBox[{"{", "Rows", "}"}]}], "]"}], ",", "Sense", ",", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "OptionName", ",", 
     "EntryPattern"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpgradeMultipanelArray", "[", 
     RowBox[{"Data_", ",", 
      RowBox[{"Sense", ":", "Vertical"}], ",", 
      RowBox[{"{", 
       RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
      "OptionName_Symbol", ",", "EntryPattern_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"Data", ",", "EntryPattern"}], "]"}], ")"}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"Data", ",", 
       RowBox[{"{", "Rows", "}"}]}], "]"}], ",", "Sense", ",", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "OptionName", ",", 
     "EntryPattern"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpgradeMultipanelArray", "[", 
     RowBox[{"Data_", ",", 
      RowBox[{"Sense", ":", "Vertical"}], ",", 
      RowBox[{"{", 
       RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
      "OptionName_Symbol", ",", "EntryPattern_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"Data", ",", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "EntryPattern"}], "]"}], "&"}]}], "]"}], ")"}]}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"Table", "[", 
       RowBox[{"Data", ",", 
        RowBox[{"{", "Columns", "}"}]}], "]"}]}], ",", "Sense", ",", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "OptionName", ",", 
     "EntryPattern"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpgradeMultipanelArray", "[", 
     RowBox[{"Data_", ",", 
      RowBox[{"Sense", ":", 
       RowBox[{"(", 
        RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
      "OptionName_Symbol", ",", "EntryPattern_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"MatrixQ", "[", 
      RowBox[{"Data", ",", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "EntryPattern"}], "]"}], "&"}]}], "]"}], ")"}]}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Dimensions", "[", 
      RowBox[{"Data", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "\[IndentingNewLine]", 
     "Data", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "Columns"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"First", "[", "Data", "]"}], ",", 
       RowBox[{"{", "Rows", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"Transpose", "@", "Data"}], "]"}], ",", 
        RowBox[{"{", "Columns", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "_", ",", "\[IndentingNewLine]", 
     RowBox[{"ErrorMessage", "[", 
      RowBox[{
       RowBox[{"Multipanel", "::", "num"}], ",", "OptionName"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScalarQ", "[", "x_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "=!=", "List"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{"Data_", ",", 
     RowBox[{"Sense", ":", 
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
     "OptionName_Symbol"}], "]"}], ":=", 
   RowBox[{"UpgradeMultipanelArray", "[", 
    RowBox[{"Data", ",", "Sense", ",", 
     RowBox[{"{", 
      RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "OptionName", ",", 
     RowBox[{"_", "?", "ScalarQ"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Multipanel", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OuterBox", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Rows_Integer", ",", "Columns_Integer"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "\[IndentingNewLine]", "]"}], " ",
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Multipanel", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "i", ",", "k", ",", "\[IndentingNewLine]", 
       "RelativeXPanelSizes", ",", "RelativeYPanelSizes", ",", 
       "\[IndentingNewLine]", "RelativeXGapSizes", ",", "RelativeYGapSizes", 
       ",", "\[IndentingNewLine]", "RelativeXMarginSizes", ",", 
       "RelativeYMarginSizes", ",", "\[IndentingNewLine]", 
       "CanvasXPanelSizes", ",", "CanvasYPanelSizes", ",", 
       "\[IndentingNewLine]", "CanvasXGapSizes", ",", "CanvasYGapSizes", ",", 
       "\[IndentingNewLine]", "CanvasXMarginSizes", ",", "CanvasYMarginSizes",
        ",", "\[IndentingNewLine]", "x1", ",", "x2", ",", "y1", ",", "y2"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XPlotRanges", ",", 
        RowBox[{"(", 
         RowBox[{"RangePattern", "|", 
          RowBox[{"VectorPattern", "[", "RangePattern", "]"}], "|", 
          RowBox[{"MatrixPattern", "[", "RangePattern", "]"}]}], ")"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YPlotRanges", ",", 
        RowBox[{"(", 
         RowBox[{"RangePattern", "|", 
          RowBox[{"VectorPattern", "[", "RangePattern", "]"}], "|", 
          RowBox[{"MatrixPattern", "[", "RangePattern", "]"}]}], ")"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XFrameTicks", ",", 
        RowBox[{"(", 
         RowBox[{"TickPattern", "|", 
          RowBox[{"VectorPattern", "[", "TickPattern", "]"}], "|", 
          RowBox[{"MatrixPattern", "[", "TickPattern", "]"}]}], ")"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YFrameTicks", ",", 
        RowBox[{"(", 
         RowBox[{"TickPattern", "|", 
          RowBox[{"VectorPattern", "[", "TickPattern", "]"}], "|", 
          RowBox[{"MatrixPattern", "[", "TickPattern", "]"}]}], ")"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XFrameLabels", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "ScalarQ"}], ")"}], "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "VectorQ"}], ")"}], "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "MatrixQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YFrameLabels", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "ScalarQ"}], ")"}], "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "VectorQ"}], ")"}], "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "MatrixQ"}], ")"}]}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Margin", ",", 
        RowBox[{"_", "?", "MarginQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XPanelSizes", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YPanelSizes", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"_", "?", "NumericQ"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XGapSizes", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YGapSizes", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"XMarginSizes", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"YMarginSizes", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowFrameLabels", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowFrameLabelsInterior", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowFrameLabelsExterior", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabels", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabelsInterior", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabelsExterior", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PanelLetterInset", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "up", " ", "indexing"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`Dimension", "=", 
       RowBox[{"{", 
        RowBox[{"Rows", ",", "Columns"}], "}"}]}], ";", "\[IndentingNewLine]",
       
      RowBox[{"LevelScheme`Multipanel`PanelIndices", "=", "None"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"store", " ", "plot", " ", "ranges"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`XPlotRanges", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"XPlotRanges", "/.", "FullOpts"}], ",", "Horizontal", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "XPlotRanges", ",", 
         "RangePattern"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`YPlotRanges", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"YPlotRanges", "/.", "FullOpts"}], ",", "Vertical", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "YPlotRanges", ",", 
         "RangePattern"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"store", " ", "tick", " ", "mark", " ", "information"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`XFrameTicks", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"XFrameTicks", "/.", "FullOpts"}], ",", "Horizontal", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "XFrameTicks", ",", 
         "TickPattern"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`YFrameTicks", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"YFrameTicks", "/.", "FullOpts"}], ",", "Vertical", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "YFrameTicks", ",", 
         "TickPattern"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"XFrameTicks", "/.", "FullOpts"}], ")"}], ",", 
           "TickPattern"}], "]"}], "&&", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"XFrameTicks", "/.", "FullOpts"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"TickPattern", ".."}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "ambigticks"}], ",", 
          "\"\<XFrameTicks\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"YFrameTicks", "/.", "FullOpts"}], ")"}], ",", 
           "TickPattern"}], "]"}], "&&", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"YFrameTicks", "/.", "FullOpts"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"TickPattern", ".."}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "ambigticks"}], ",", 
          "\"\<YFrameTicks\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`ShowTickLabelsExterior", "=", 
       RowBox[{"(", 
        RowBox[{"ShowTickLabelsExterior", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`ShowTickLabelsInterior", "=", 
       RowBox[{"(", 
        RowBox[{"ShowTickLabelsInterior", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"store", " ", "frame", " ", "label", " ", "information"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`XFrameLabels", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"XFrameLabels", "/.", "FullOpts"}], ",", "Horizontal", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "XFrameLabels"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`YFrameLabels", "=", 
       RowBox[{"UpgradeMultipanelArray", "[", 
        RowBox[{
         RowBox[{"YFrameLabels", "/.", "FullOpts"}], ",", "Vertical", ",", 
         RowBox[{"{", 
          RowBox[{"Rows", ",", "Columns"}], "}"}], ",", "YFrameLabels"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`ShowFrameLabelsExterior", "=", 
       RowBox[{"(", 
        RowBox[{"ShowFrameLabelsExterior", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`ShowFrameLabelsInterior", "=", 
       RowBox[{"(", 
        RowBox[{"ShowFrameLabelsInterior", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"store", " ", "geometry"}], " ", "*)"}], "\[IndentingNewLine]",
       
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y1", ",", "y2"}], "}"}]}], "}"}], "=", 
       RowBox[{"OuterBox", "+", 
        RowBox[{"ConvertRegion", "[", 
         RowBox[{"AbsoluteCoords", ",", "CanvasCoords", ",", "D", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "*", 
           RowBox[{"UpgradeMargin", "[", 
            RowBox[{"Margin", "/.", "FullOpts"}], "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeXPanelSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"XPanelSizes", "/.", "FullOpts"}], ",", 
         "\[IndentingNewLine]", "Automatic", ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"LevelScheme`Multipanel`XPlotRanges", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"_", "?", "NumericQ"}], ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}], 
                  ".."}], "}"}]}], "]"}]}], ",", 
             RowBox[{"ErrorMessage", "[", 
              RowBox[{
               RowBox[{"Multipanel", "::", "autosizes"}], ",", 
               "\"\<XPanelSizes\>\"", ",", "\"\<XPlotRanges\>\""}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"-", 
            RowBox[{"Subtract", "@@@", 
             RowBox[{
             "First", "[", "LevelScheme`Multipanel`XPlotRanges", "]"}]}]}]}], 
          "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"XPanelSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", "Columns", "}"}]}], "]"}], ",", "\[IndentingNewLine]",
          
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", 
         RowBox[{"XPanelSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "RelativeXPanelSizes", "]"}], "=!=", 
         "Columns"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "num"}], ",", "\"\<X panel sizes\>\""}],
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RelativeYPanelSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"YPanelSizes", "/.", "FullOpts"}], ",", 
         "\[IndentingNewLine]", "Automatic", ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"LevelScheme`Multipanel`YPlotRanges", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"_", "?", "NumericQ"}], ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}], 
                  ".."}], "}"}]}], "]"}]}], ",", 
             RowBox[{"ErrorMessage", "[", 
              RowBox[{
               RowBox[{"Multipanel", "::", "autosizes"}], ",", 
               "\"\<YPanelSizes\>\"", ",", "\"\<YPlotRanges\>\""}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"-", 
            RowBox[{"Subtract", "@@@", 
             RowBox[{"First", "[", 
              RowBox[{
              "Transpose", "[", "LevelScheme`Multipanel`YPlotRanges", "]"}], 
              "]"}]}]}]}], "\[IndentingNewLine]", ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"YPanelSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", "Rows", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", 
         RowBox[{"YPanelSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "RelativeYPanelSizes", "]"}], "=!=", "Rows"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "num"}], ",", "\"\<Y panel sizes\>\""}],
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RelativeXGapSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"XGapSizes", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"XGapSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", 
            RowBox[{"Columns", "-", "1"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", 
         RowBox[{"XGapSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "RelativeXGapSizes", "]"}], "=!=", 
         RowBox[{"(", 
          RowBox[{"Columns", "-", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "num"}], ",", "\"\<X panel gaps\>\""}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RelativeYGapSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"YGapSizes", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"YGapSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", 
            RowBox[{"Rows", "-", "1"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], ",", 
         RowBox[{"YGapSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "RelativeYGapSizes", "]"}], "=!=", 
         RowBox[{"(", 
          RowBox[{"Rows", "-", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"Multipanel", "::", "num"}], ",", "\"\<Y panel gaps\>\""}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RelativeXMarginSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"XMarginSizes", "/.", "FullOpts"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"XMarginSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
         RowBox[{"XMarginSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RelativeYMarginSizes", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"YMarginSizes", "/.", "FullOpts"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"YMarginSizes", "/.", "FullOpts"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
         RowBox[{"YMarginSizes", "/.", "FullOpts"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`CanvasXUnit", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Plus", "@@", "RelativeXPanelSizes"}], "+", 
          RowBox[{"Plus", "@@", "RelativeXGapSizes"}], "+", 
          RowBox[{"Plus", "@@", "RelativeXMarginSizes"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasXPanelSizes", "=", 
       RowBox[{
       "RelativeXPanelSizes", "*", "LevelScheme`Multipanel`CanvasXUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasXGapSizes", "=", 
       RowBox[{
       "RelativeXGapSizes", "*", "LevelScheme`Multipanel`CanvasXUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasXMarginSizes", "=", 
       RowBox[{
       "RelativeXMarginSizes", "*", "LevelScheme`Multipanel`CanvasXUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`CanvasYUnit", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Plus", "@@", "RelativeYPanelSizes"}], "+", 
          RowBox[{"Plus", "@@", "RelativeYGapSizes"}], "+", 
          RowBox[{"Plus", "@@", "RelativeYMarginSizes"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasYPanelSizes", "=", 
       RowBox[{
       "RelativeYPanelSizes", "*", "LevelScheme`Multipanel`CanvasYUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasYGapSizes", "=", 
       RowBox[{
       "RelativeYGapSizes", "*", "LevelScheme`Multipanel`CanvasYUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasYMarginSizes", "=", 
       RowBox[{
       "RelativeYMarginSizes", "*", "LevelScheme`Multipanel`CanvasYUnit"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`XRegionRangeList", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x1", "+", 
          RowBox[{"CanvasXMarginSizes", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CanvasXPanelSizes", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+", 
             RowBox[{"CanvasXGapSizes", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"CanvasXPanelSizes", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Columns"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`YRegionRangeList", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y2", "-", 
          RowBox[{"CanvasYMarginSizes", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CanvasYPanelSizes", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+", 
             RowBox[{"CanvasYGapSizes", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"CanvasYPanelSizes", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Rows"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "store", " ", "frozen", " ", "copy", " ", "of", " ", "Panel", " ", 
        "formatting", " ", "option", " ", "defaults"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`PanelOptions", "=", 
       RowBox[{"{", 
        RowBox[{"LegacyFilterOptions", "[", 
         RowBox[{"FigurePanel", ",", "FullOpts"}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "Null"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.395089867125*^9, 3.395092360234375*^9, 3.395521251375*^9}
  ]
}, Open  ]],

Cell[CellGroupData[{

Cell["Panel", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasicFigurePanel", "[", 
    RowBox[{"Caller_Symbol", ",", 
     RowBox[{"RegionRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     "FullOpts_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "ExpandedPlotRange", ",", "XYPlotRange", ",", "UsedPlotRange", ",", 
       "DeducedFrameLabel", ",", "DeducedFrameLabelOptions", ",", 
       "DeducedFrameTicks", ",", "AxisIndex", ",", "PanelLetterPosn"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PlotRange", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Automatic", "|", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
           RowBox[{"Automatic", "|", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Background", ",", 
        RowBox[{"None", "|", "ColorDirectivePattern"}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"BackgroundOpacity", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"FrameLabel", ",", 
        RowBox[{"None", "|", "Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"L_List", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "L", "]"}], "\[LessEqual]", "4"}], 
            ")"}]}], ")"}]}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowFrameLabels", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowEdge", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTicks", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowTickLabels", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}], ",", 
          RowBox[{"True", "|", "False"}]}], "}"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"TickNudge", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], "|", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ")"}], "..."}], 
            "}"}]}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "L", "]"}], "==", "4"}], ")"}]}], ")"}], 
        ",", "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ExtendRange", ",", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"calculate", " ", "plot", " ", "range"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", "1", ")"}], " ", "expand", " ", "PlotRange", " ", 
          "value", " ", "Automatic", " ", "to", " ", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ";", " ", 
         RowBox[{
          RowBox[{"(", "2", ")"}], " ", "for", " ", "each", " ", 
          "coordinate"}]}], ",", " ", 
        RowBox[{
        "use", " ", "explicit", " ", "range", " ", "if", " ", "given", " ", 
         "in", " ", "PlotRange"}], ",", " ", 
        RowBox[{
         RowBox[{
         "or", " ", "for", " ", "Automatic", " ", "default", " ", "to", " ", 
          "separate", " ", "XPlotRange", " ", "and", " ", "YPlotRange"}], ";",
          " ", 
         RowBox[{
          RowBox[{"(", "3", ")"}], " ", "for", " ", "XPlotRange", " ", "and", 
          " ", "YPlotRange"}]}], ",", " ", 
        RowBox[{
        "use", " ", "explicit", " ", "ranges", " ", "if", " ", "given", " ", 
         "or", " ", "else", " ", "for", " ", "Automatic", " ", "default", " ",
          "to", " ", "canvas", " ", "coordinate", " ", "range", " ", 
         "covered", " ", "by", " ", "panel", " ", 
         RowBox[{"(", 
          RowBox[{"dubious", " ", "value"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandedPlotRange", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"PlotRange", ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", "FullOpts"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XYPlotRange", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Automatic", "\[Rule]", "#2"}]}], "]"}], "&"}], ")"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ExpandedPlotRange", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"XPlotRange", ",", "YPlotRange"}], "}"}], "/.", 
            "FullOpts"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedPlotRange", "=", 
       RowBox[{"ExtendRegion", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"Automatic", "\[Rule]", "#2"}]}], "]"}], "&"}], ")"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"XYPlotRange", ",", "RegionRange"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"ExtendRange", "/.", "FullOpts"}], ")"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "up", " ", "global", " ", "properties", " ", "for", " ", 
        "panel"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"$Background", "=", 
       RowBox[{"Background", "/.", "FullOpts"}]}], ";", "\[IndentingNewLine]",
       
      RowBox[{"SetRegion", "[", 
       RowBox[{"RegionRange", ",", "UsedPlotRange"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"obtain", " ", "frame", " ", "labels"}], ",", " ", 
        RowBox[{
        "defaulting", " ", "to", " ", "LabX", " ", "option", " ", 
         "values"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "construct", " ", "explicit", " ", "list", " ", "of", " ", "labels"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameLabel", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FrameLabel", "/.", "FullOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", "Automatic", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LabB", ",", "LabL", ",", "LabT", ",", "LabR"}], "}"}], "/.",
           "FullOpts"}], ",", "\[IndentingNewLine]", "None", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None", ",", "None", ",", "None"}], "}"}], ",",
          "\[IndentingNewLine]", "_List", ",", "\[IndentingNewLine]", 
         RowBox[{"AugmentList", "[", 
          RowBox[{"4", ",", 
           RowBox[{"(", 
            RowBox[{"FrameLabel", "/.", "FullOpts"}], ")"}], ",", "None"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
       
      RowBox[{"(*", " ", 
       RowBox[{
       "remove", " ", "labels", " ", "except", " ", "on", " ", "sides", " ", 
        "where", " ", "allowed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameLabel", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"#2", ",", "#1", ",", "None"}], "]"}], "&"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DeducedFrameLabel", ",", 
           RowBox[{"ShowFrameLabels", "/.", "FullOpts"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "clothe", " ", "frame", " ", "labels", " ", "as", " ", "LabX", " ", 
        "option", " ", "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameLabelOptions", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"LabB", ",", "LabL", ",", "LabT", ",", "LabR"}], "}"}], 
           ",", "DeducedFrameLabel"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"process", " ", "frame", " ", "tick", " ", "specification"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "augment", " ", "specification", " ", "so", " ", "that", " ", "it", 
        " ", "is", " ", "a", " ", "list", " ", "of", " ", "lists"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"FrameTicks", ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic", ",", "None", ",", "None"}], 
          "}"}], ",", "FullOpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"AugmentAxisTickOptions", "[", 
        RowBox[{"4", ",", "DeducedFrameTicks"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "generate", " ", "any", " ", "automatic", " ", "ticks", " ", "with", 
         " ", "LinTicks"}], ",", " ", 
        RowBox[{
        "with", " ", "labels", " ", "on", " ", "for", " ", "the", " ", 
         "bottom", " ", "and", " ", "left", " ", "and", " ", "off", " ", 
         "for", " ", "the", " ", "top", " ", "and", " ", "right"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Automatic", "\[RuleDelayed]", 
              RowBox[{"LinTicks", "[", 
               RowBox[{
                RowBox[{"Sequence", "@@", "#2"}], ",", 
                RowBox[{"ShowLabels", "\[Rule]", "#3"}]}], "]"}]}]}], "]"}], 
           "&"}], ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"DeducedFrameTicks", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
            "}"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"augment", " ", "any", " ", "under"}], "-", 
        RowBox[{"specified", " ", "ticks"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AugmentTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], ")"}], "/@", 
        "DeducedFrameTicks"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"convert", " ", "to", " ", "canvas", " ", "coordinates"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TransformTicks", "[", 
            RowBox[{"#1", ",", "#2", ",", 
             RowBox[{"LimitTickRange", "[", 
              RowBox[{"#3", ",", "#4"}], "]"}]}], "]"}], "&"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"XCOfXU", ",", "YCOfYU", ",", "XCOfXU", ",", "YCOfYU"}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "DYCTick", ",", "DXCTick", ",", "DYCTick", ",", "DXCTick"}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"UsedPlotRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "DeducedFrameTicks"}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "remove", " ", "labels", " ", "except", " ", "on", " ", "sides", " ", 
        "where", " ", "allowed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"#2", ",", "#1", ",", 
             RowBox[{"StripTickLabels", "[", "#1", "]"}]}], "]"}], "&"}], 
          ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DeducedFrameTicks", ",", 
           RowBox[{"ShowTickLabels", "/.", "FullOpts"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "remove", " ", "ticks", " ", "except", " ", "on", " ", "sides", " ", 
        "where", " ", "allowed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"#2", ",", "#1", ",", 
             RowBox[{"{", "}"}]}], "]"}], "&"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DeducedFrameTicks", ",", 
           RowBox[{"(", 
            RowBox[{"ShowTicks", "/.", "FullOpts"}], ")"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "artwork"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "fill", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$Background", "=!=", "None"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Rectangle", "@@", 
              RowBox[{"Transpose", "[", "RegionRange", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Color", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Background", "/.", "FullOpts"}], ")"}]}], ",", 
            RowBox[{"Opacity", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"BackgroundOpacity", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ShowFill", "\[Rule]", "True"}], ",", 
            RowBox[{"FillColor", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"FillOpacity", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"ClipToRectangle", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Layer", "\[Rule]", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{
              "Layer", ",", "$SchemeBackgroundLayer", ",", "FullOpts"}], 
              "]"}]}], ",", "\[IndentingNewLine]", "FullOpts"}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "edges", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "axis", " ", "options", " ", "are", " ", "as", " ", "in", " ", 
           "FullOpts"}], ",", " ", 
          RowBox[{
          "except", " ", "LabX", " ", "is", " ", "overriden", " ", "by", " ", 
           "FrameLabel"}], ",", " ", 
          RowBox[{
           RowBox[{"TickNudge", " ", "is", " ", "an", " ", "edge"}], "-", 
           "by", "-", 
           RowBox[{"edge", " ", "list"}]}], ",", " ", 
          RowBox[{
          "and", " ", "the", " ", "Ticks", " ", "are", " ", "given", " ", 
           "for", " ", "the", " ", "whole", " ", "frame"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Frame", "/.", "FullOpts"}], ")"}], "&&", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ShowEdge", "/.", "FullOpts"}], ")"}], "[", 
              RowBox[{"[", "AxisIndex", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BasicAxis", "[", 
             RowBox[{
             "Caller", ",", "\[IndentingNewLine]", "RegionRange", ",", 
              "\[IndentingNewLine]", "AxisIndex", ",", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ShowEdge", "/.", "FullOpts"}], ")"}], "[", 
               RowBox[{"[", "AxisIndex", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
              RowBox[{"DeducedFrameTicks", "[", 
               RowBox[{"[", "AxisIndex", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"DeducedFrameLabelOptions", ",", 
                 RowBox[{"TickNudge", "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"TickNudge", "/.", "FullOpts"}], ")"}], "[", 
                   RowBox[{"[", "AxisIndex", "]"}], "]"}]}], ",", 
                 "FullOpts"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"AxisIndex", ",", "1", ",", "4"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"panel", " ", "letter"}], " ", "*)"}], "\[IndentingNewLine]",
         
        RowBox[{
         RowBox[{"PanelLetterPosn", "=", 
          RowBox[{
           RowBox[{"PCOfPS", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"PanelLetterCorner", "/.", "FullOpts"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], "\[Rule]", "0"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"PanelLetterCorner", "/.", "FullOpts"}], ")"}], "*", 
            RowBox[{"DPCOfPA", "@", 
             RowBox[{"(", 
              RowBox[{"PanelLetterInset", "/.", "FullOpts"}], ")"}]}]}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"MakeText", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"PanelLetter", "/.", "FullOpts"}], ")"}], ",", " ", 
           "PanelLetterPosn", ",", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"ShowText", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ShowPanelLetter", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Offset", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterOffset", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "FullOpts"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Nudge", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"PanelLetterNudge", "/.", "FullOpts"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Orientation", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"PanelLetterOrientation", "/.", "FullOpts"}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Background", "->", 
            RowBox[{"(", 
             RowBox[{"PanelLetterBackground", "/.", "FullOpts"}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"FontFamily", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontFamily", ",", 
              RowBox[{"FontFamily", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontSize", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontSize", ",", 
              RowBox[{"FontSize", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontWeight", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontWeight", ",", 
              RowBox[{"FontWeight", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontSlant", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontSlant", ",", 
              RowBox[{"FontSlant", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontTracking", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontTracking", ",", 
              RowBox[{"FontTracking", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontColor", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontColor", ",", 
              RowBox[{"FontColor", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontOpacity", "\[Rule]", 
            RowBox[{"GetAutoOption", "[", 
             RowBox[{"PanelLetterFontOpacity", ",", 
              RowBox[{"FontOpacity", "/.", "FullOpts"}], ",", "FullOpts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", "FullOpts"}], " ", 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigurePanel", "[", 
    RowBox[{
     RowBox[{"RegionRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"FigurePanel", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "AugmentedOpts"}], "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AugmentedOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ClipToRectangle", "\[Rule]", "False"}], ",", "FullOpts"}], 
         "}"}], "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"provide", " ", "ClipToRectangle", " ", "value"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"BasicFigurePanel", "[", 
       RowBox[{"FigurePanel", ",", "RegionRange", ",", "AugmentedOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaledFigurePanel", "[", 
    RowBox[{
     RowBox[{"ScaledRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1s_", "?", "NumericQ"}], ",", 
          RowBox[{"x2s_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y1s_", "?", "NumericQ"}], ",", 
          RowBox[{"y2s_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"ScaledFigurePanel", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "AugmentedOpts"}], "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AugmentedOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ClipToRectangle", "\[Rule]", "False"}], ",", "FullOpts"}], 
         "}"}], "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"provide", " ", "ClipToRectangle", " ", "value"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"BasicFigurePanel", "[", 
       RowBox[{"ScaledFigurePanel", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"XCOfXS", "/@", 
           RowBox[{"{", 
            RowBox[{"x1s", ",", "x2s"}], "}"}]}], ",", 
          RowBox[{"YCOfYS", "/@", 
           RowBox[{"{", 
            RowBox[{"y1s", ",", "y2s"}], "}"}]}]}], "}"}], ",", 
        "AugmentedOpts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395092363140625*^9, 3.39509240184375*^9}, {
  3.3955212514375*^9, 3.39552125159375*^9}, {3.396557940734375*^9, 
  3.396557970265625*^9}, {3.39663460271875*^9, 3.39663461853125*^9}, {
  3.39663702675*^9, 3.396637044921875*^9}, {3.3966371118125*^9, 
  3.39663713953125*^9}}],

Cell["\<\
Option processing for Panel[{row,column}]

Since RealizeOptions was already used to generate \
LevelScheme`Multipanel`PanelOptions at the initial Multipanel invocation, it \
is only needed here in case the user now gives Inherited for any explicitly \
specified options and for validation of explicitly specified options.

Before we can obtain the multipanel deduced options, we come up with the \
preliminary option set FullOpts, for which the precedence is 
\t(1) explicitly specified Opts
\t(2) frozen default option values LevelScheme`Multipanel`PanelOptions
\t(3) present defaults for Panel (only affects a handful of options which \
will be superseded anyway by multipanel deduced options)
This preliminary set is needed since the multipanel deduced value of \
PanelLetter is affected by the value of the options First, etc.
The ultimate precedence of options is 
\t(1) explicitly specified Opts
\t(2) multipanel-based deduced options
\t(3) frozen default option values LevelScheme`Multipanel`PanelOptions
\t(X) present defaults for Panel (irrelevant, since guaranteed to be \
superseded by the frozen values or deduced options)
\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigurePanel", "[", 
    RowBox[{
     RowBox[{"PanelIndices", ":", 
      RowBox[{"{", 
       RowBox[{"Row_Integer", ",", "Column_Integer"}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"FigurePanel", ",", 
          RowBox[{"{", 
           RowBox[{"Opts", ",", "LevelScheme`Multipanel`PanelOptions"}], 
           "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "DeducedFullOpts", 
       ",", "\[IndentingNewLine]", "OptPanelShift", ",", 
       "OptPanelAdjustments", ",", "\[IndentingNewLine]", "RegionRange", ",", 
       "MultipanelPlotRange", ",", "ExpandedPlotRange", ",", "XYPlotRange", 
       ",", "DeducedPlotRange", ",", "\[IndentingNewLine]", 
       "DeducedFrameLabel", ",", "DeducedShowFrameLabels", ",", 
       "\[IndentingNewLine]", "DeducedFrameTicks", ",", 
       "DeducedShowTickLabels", ",", "\[IndentingNewLine]", 
       "DeducedPanelLetter", ",", "\[IndentingNewLine]", "DeducedOptions", 
       ",", "\[IndentingNewLine]", "AugmentedOpts", ",", 
       "\[IndentingNewLine]", "ExteriorMask"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"ValueQ", "[", "LevelScheme`Multipanel`Dimension", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{"FigurePanel", "::", "undefined"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"TrueQ", "[", 
          RowBox[{"InRegion", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            "LevelScheme`Multipanel`Dimension", ",", "PanelIndices"}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"FigurePanel", "::", "badij"}], ",", "PanelIndices"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PlotRange", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PanelShift", ",", 
        RowBox[{"None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "FullOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PanelAdjustments", ",", 
        RowBox[{"None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"LevelScheme`Multipanel`PanelIndices", "=", "PanelIndices"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"calculate", " ", "geometry"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"OptPanelShift", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"PanelShift", "/.", "FullOpts"}], ")"}], "===", "None"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"(", 
          RowBox[{"PanelShift", "/.", "FullOpts"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OptPanelAdjustments", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"PanelAdjustments", "/.", "FullOpts"}], ")"}], "===", 
          "None"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"(", 
          RowBox[{"PanelAdjustments", "/.", "FullOpts"}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"RegionRange", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"LevelScheme`Multipanel`XRegionRangeList", "[", 
           RowBox[{"[", "Column", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"OptPanelShift", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           "LevelScheme`Multipanel`CanvasXUnit"}], "+", 
          RowBox[{
           RowBox[{"OptPanelAdjustments", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           "LevelScheme`Multipanel`CanvasXUnit"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LevelScheme`Multipanel`YRegionRangeList", "[", 
           RowBox[{"[", "Row", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"OptPanelShift", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           "LevelScheme`Multipanel`CanvasYUnit"}], "+", 
          RowBox[{
           RowBox[{"OptPanelAdjustments", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           "LevelScheme`Multipanel`CanvasYUnit"}]}]}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"calculate", " ", "plot", " ", "range"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", "1", ")"}], " ", "expand", " ", "PlotRange", " ", 
          "value", " ", "Automatic", " ", "to", " ", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ";", " ", 
         RowBox[{
          RowBox[{"(", "2", ")"}], " ", "for", " ", "each", " ", 
          "coordinate"}]}], ",", " ", 
        RowBox[{
        "use", " ", "explicit", " ", "range", " ", "if", " ", "given", " ", 
         "in", " ", "PlotRange"}], ",", " ", 
        RowBox[{
         RowBox[{
         "or", " ", "for", " ", "Automatic", " ", "default", " ", "to", " ", 
          "separate", " ", "XPlotRange", " ", "and", " ", "YPlotRange"}], ";",
          " ", 
         RowBox[{
          RowBox[{"(", "3", ")"}], " ", "for", " ", "XPlotRange", " ", "and", 
          " ", "YPlotRange"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "use", " ", "explicit", " ", "ranges", " ", "if", " ", "given", " ", 
          "or", " ", "else", " ", "for", " ", "Automatic", " ", "default", 
          " ", "to", " ", "range", " ", "for", " ", "this", " ", "row", " ", 
          "and", " ", "column", " ", "specified", " ", "to", " ", 
          "Multipanel"}], ";", " ", 
         RowBox[{
          RowBox[{"(", "4", ")"}], " ", "note", " ", "that", " ", "if", " ", 
          "Multipanel", " ", "range", " ", "is", " ", "in", " ", "turn", " ", 
          "Automatic"}]}], ",", " ", 
        RowBox[{
        "BasicPanel", " ", "will", " ", "later", " ", "extend", " ", "this", 
         " ", "range", " ", "if", " ", "necessary", " ", "and", " ", 
         "convert", " ", "this", " ", "to", " ", "the", " ", "range", " ", 
         "of", " ", "canvas", " ", "coordinates", " ", "covered", " ", "by", 
         " ", "the", " ", "panel"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"MultipanelPlotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LevelScheme`Multipanel`XPlotRanges", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", 
         RowBox[{"LevelScheme`Multipanel`YPlotRanges", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandedPlotRange", "=", 
       RowBox[{"GetAutoOption", "[", 
        RowBox[{"PlotRange", ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", "FullOpts"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XYPlotRange", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Automatic", "\[Rule]", "#2"}]}], "]"}], "&"}], ")"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ExpandedPlotRange", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"XPlotRange", ",", "YPlotRange"}], "}"}], "/.", 
            "FullOpts"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeducedPlotRange", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Automatic", "\[Rule]", "#2"}]}], "]"}], "&"}], ")"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"XYPlotRange", ",", "MultipanelPlotRange"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "exterior", " ", "mask", " ", "for", " ", "edges", " ", "of", " ", 
        "current", " ", "panel"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ExteriorMask", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "==", 
          RowBox[{"LevelScheme`Multipanel`Dimension", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Column", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Column", "==", 
          RowBox[{"LevelScheme`Multipanel`Dimension", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"deduce", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"DeducedFrameLabel", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LevelScheme`Multipanel`XFrameLabels", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", 
         RowBox[{"LevelScheme`Multipanel`YFrameLabels", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", "None", ",", 
         "None"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeducedShowFrameLabels", "=", 
       RowBox[{"ListableAnd", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "ShowFrameLabels", "/.", "LevelScheme`Multipanel`PanelOptions"}], 
          ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListableOr", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListableAnd", "[", 
            RowBox[{
            "ExteriorMask", ",", 
             "LevelScheme`Multipanel`ShowFrameLabelsExterior"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListableAnd", "[", 
            RowBox[{
             RowBox[{"ListableNot", "[", "ExteriorMask", "]"}], ",", 
             "LevelScheme`Multipanel`ShowFrameLabelsInterior"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"deduce", " ", "ticks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedFrameTicks", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LevelScheme`Multipanel`XFrameTicks", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", 
         RowBox[{"LevelScheme`Multipanel`YFrameTicks", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", 
         RowBox[{"LevelScheme`Multipanel`XFrameTicks", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}], ",", 
         RowBox[{"LevelScheme`Multipanel`YFrameTicks", "[", 
          RowBox[{"[", 
           RowBox[{"Row", ",", "Column"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"deduce", " ", "tick", " ", "label", " ", "sides"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "condition", " ", "for", " ", "tick", " ", "labels", " ", "to", " ", 
        "be", " ", "shown", " ", "is", " ", 
        RowBox[{"(", 
         RowBox[{"outer", " ", "edge"}], ")"}], " ", "AND", " ", 
        RowBox[{"(", 
         RowBox[{
         "edge", " ", "allowed", " ", "by", " ", "ShowTickLabels", " ", 
          "option", " ", "at", " ", "time", " ", "of", " ", "Multipanel", " ",
           "invocation"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DeducedShowTickLabels", "=", 
       RowBox[{"ListableAnd", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "ShowTickLabels", "/.", "LevelScheme`Multipanel`PanelOptions"}], 
          ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListableOr", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListableAnd", "[", 
            RowBox[{
            "ExteriorMask", ",", 
             "LevelScheme`Multipanel`ShowTickLabelsExterior"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListableAnd", "[", 
            RowBox[{
             RowBox[{"ListableNot", "[", "ExteriorMask", "]"}], ",", 
             "LevelScheme`Multipanel`ShowTickLabelsInterior"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"deduce", " ", "panel", " ", "label"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"DeducedPanelLetter", "=", 
       RowBox[{"PanelLetter", "[", 
        RowBox[{"LegacyFilterOptions", "[", 
         RowBox[{"PanelLetter", ",", "FullOpts"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"combine", " ", "deduced", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"DeducedOptions", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", "DeducedPlotRange"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", "Automatic"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "for", " ", "easier", " ", "user", " ", "override", " ", "with", 
           " ", "LabX"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"LabB", "->", 
          RowBox[{"DeducedFrameLabel", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"LabL", "->", 
          RowBox[{"DeducedFrameLabel", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"LabT", "\[Rule]", 
          RowBox[{"DeducedFrameLabel", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"LabR", "\[Rule]", 
          RowBox[{"DeducedFrameLabel", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ShowFrameLabels", "\[Rule]", "DeducedShowFrameLabels"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "->", "DeducedFrameTicks"}], ",", 
         RowBox[{"ShowTickLabels", "->", "DeducedShowTickLabels"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PanelLetter", "\[Rule]", "DeducedPanelLetter"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeducedFullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"FigurePanel", ",", 
         RowBox[{"{", 
          RowBox[{
          "Opts", ",", "DeducedOptions", ",", 
           "LevelScheme`Multipanel`PanelOptions"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AugmentedOpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ClipToRectangle", "\[Rule]", "False"}], ",", 
          "DeducedFullOpts"}], "}"}], "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"provide", " ", "ClipToRectangle", " ", "value"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"BasicFigurePanel", "[", 
       RowBox[{"FigurePanel", ",", "RegionRange", ",", "AugmentedOpts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3950898706875*^9, {3.3950924155625*^9, 3.39509244471875*^9}, {
   3.395521251609375*^9, 3.395521251671875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["PanelLetter", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PanelLetter", "[", 
    RowBox[{"Opts___", "?", "OptionQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"PanelLetter", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "StartLetterCode", ",", "Letter", ",", 
       "\[IndentingNewLine]", "i", ",", "j"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Order", ",", 
        RowBox[{"Horizontal", "|", "Vertical"}], ",", "FullOpts"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LevelScheme`Multipanel`PanelIndices", "===", "None"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{"PanelLetter", "::", "nopanel"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"StartLetterCode", "=", 
       RowBox[{"ToCharacterCode", "[", 
        RowBox[{"First", "/.", "FullOpts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "=", 
       "LevelScheme`Multipanel`PanelIndices"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Letter", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Order", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
         "Horizontal", ",", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"StartLetterCode", "+", 
           RowBox[{
            RowBox[{"LevelScheme`Multipanel`Dimension", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "+", 
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Vertical", ",", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"StartLetterCode", "+", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "+", 
           RowBox[{
            RowBox[{"LevelScheme`Multipanel`Dimension", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Format", "/.", "FullOpts"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "<>", "Letter", "<>", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Format", "/.", "FullOpts"}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data plotting -- UNDER DEVELOPMENT", "Section"],

Cell[CellGroupData[{

Cell["Data utilities", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AttachIndex", "[", 
    RowBox[{"DataValues_List", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"AttachIndex", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "s", ",", "x0"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckOption", "[", 
       RowBox[{"First", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ScaleFactor", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Range", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", "Automatic"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"Range", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
        "Automatic", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"s", "=", 
          RowBox[{"(", 
           RowBox[{"ScaleFactor", "/.", "FullOpts"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x0", "=", 
          RowBox[{"(", 
           RowBox[{"First", "/.", "FullOpts"}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]",
         
        RowBox[{
         RowBox[{"s", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Subtract", "@@", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Range", "/.", "FullOpts"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "DataValues", "]"}], "-", "1"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x0", "=", 
          RowBox[{"First", "[", 
           RowBox[{"Range", "/.", "FullOpts"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ")"}]}], "+", 
            "x0"}], ",", "#1"}], "}"}], "&"}], ",", "DataValues"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DataValueQ", "[", "x_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], ")"}], "|",
       
      RowBox[{"ErrorValue", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], ")"}], 
        ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], ")"}],
            ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], 
            ")"}]}], "}"}]}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataValueNoneQ", "[", "x_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"(", "None", ")"}], "|", 
      RowBox[{"ErrorValue", "[", 
       RowBox[{"None", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], ")"}],
            ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "RealNumericQ"}], ")"}], "|", "None"}], 
            ")"}]}], "}"}]}]}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DataPointQ", "[", "x_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "DataValueQ"}], ",", 
       RowBox[{"_", "?", "DataValueQ"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataPointNoneQ", "[", "x_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "DataValueNoneQ"}], ",", 
        RowBox[{"_", "?", "DataValueQ"}]}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "DataValueQ"}], ",", 
        RowBox[{"_", "?", "DataValueNoneQ"}]}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DataSetQ", "[", "x_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "DataPointQ"}], ")"}], "..."}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data filtering", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelectData", "[", 
     RowBox[{"Test_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{"Data", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "?", 
       RowBox[{"(", 
        RowBox[{"Composition", "[", 
         RowBox[{"Not", ",", "Test"}], "]"}], ")"}]}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", "None"}], "}"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExcludeData", "[", 
     RowBox[{"Test_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{"Data", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "?", "Test"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", "None"}], "}"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformData", "[", 
     RowBox[{"f_", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{"Data", ",", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ":>", 
      RowBox[{"f", "[", "x", "]"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DownsampleData", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "0"}], "}"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{"Data", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"i", "++"}], ",", "n"}], "]"}], "\[Equal]", "0"}], "&"}], 
        ")"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XRange", "[", 
    RowBox[{
     RowBox[{"x1_", "?", "RealNumericQ"}], ",", 
     RowBox[{"x2_", "?", "RealNumericQ"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"InRange", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2"}], "}"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YRange", "[", 
    RowBox[{
     RowBox[{"y1_", "?", "RealNumericQ"}], ",", 
     RowBox[{"y2_", "?", "RealNumericQ"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"InRange", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y1", ",", "y2"}], "}"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InPlotRegion", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"InRegion", "[", 
      RowBox[{"$RegionRange", ",", 
       RowBox[{"PCOfPU", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitX", "[", 
    RowBox[{
     RowBox[{"x1_", "?", "RealNumericQ"}], ",", 
     RowBox[{"x2_", "?", "RealNumericQ"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"#", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"XRange", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], ")"}]}], ",", "#", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"XRange", "[", 
          RowBox[{
           RowBox[{"-", "Infinity"}], ",", "x1"}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"XRange", "[", 
          RowBox[{"x2", ",", 
           RowBox[{"+", "Infinity"}]}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "_", ",", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"LimitX", "::", "badvalue"}], ",", "#"}], "]"}]}], "]"}], 
     "&"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LimitY", "[", 
    RowBox[{
     RowBox[{"y1_", "?", "RealNumericQ"}], ",", 
     RowBox[{"y2_", "?", "RealNumericQ"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"#", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"YRange", "[", 
          RowBox[{"y1", ",", "y2"}], "]"}], ")"}]}], ",", "#", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"YRange", "[", 
          RowBox[{
           RowBox[{"-", "Infinity"}], ",", "y1"}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "y1"}], "}"}], ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"YRange", "[", 
          RowBox[{"y2", ",", 
           RowBox[{"+", "Infinity"}]}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "y2"}], "}"}], ",", "_", ",", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"LimitY", "::", "badvalue"}], ",", "#"}], "]"}]}], "]"}], 
     "&"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Line shape definitions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataLineShape", "[", 
     RowBox[{"\"\<Straight\>\"", ",", "n_"}], "]"}], "[", "Points_List", 
    "]"}], ":=", "Points"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataLineShape", "[", 
     RowBox[{"\"\<Step\>\"", ",", "n_"}], "]"}], "[", "Points_List", "]"}], ":=",
    
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"First", "[", "Points", "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "Points", "]"}], "-", "1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "1"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Last", "[", "Points", "]"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataLineShape", "[", 
     RowBox[{"\"\<StepAnchored\>\"", ",", "n_"}], "]"}], "[", "Points_List", 
    "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"YCOfYU", "@", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"Last", "[", 
          RowBox[{"Points", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "Points", "]"}], "-", "1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "1"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"Last", "[", 
          RowBox[{"Points", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"YCOfYU", "@", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataLineShape", "[", 
     RowBox[{"\"\<Histogram\>\"", ",", "n_"}], "]"}], "[", "Points_List", 
    "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"YCOfYU", "@", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"Last", "[", 
          RowBox[{"Points", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"YCOfYU", "@", "0"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                RowBox[{"First", "[", 
                 RowBox[{"Points", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/",
               "2"}], ",", 
             RowBox[{"Last", "[", 
              RowBox[{"Points", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "Points", "]"}], "-", "1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "1"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"Last", "[", 
          RowBox[{"Points", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"First", "[", 
             RowBox[{"Points", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"YCOfYU", "@", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol shape definitions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<Circle\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", "*", "Pi", "*", 
         RowBox[{"i", "/", "n"}]}], "]"}], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "*", "Pi", "*", 
         RowBox[{"i", "/", "n"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"First", "@", 
      RowBox[{"N", "@", 
       RowBox[{"LegacyRegularPolygon", "[", 
        RowBox[{"3", ",", "1", ",", "0", ",", "theta"}], "]"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", 
      RowBox[{"3", "*", 
       RowBox[{"Pi", "/", "2"}]}], ",", 
      RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], "//", 
  "InputForm"}]], "Input",
 CellChangeTimes->{3.39509273621875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Most", "::", "\<\"normal\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) in \
\\!\\(Most[3.`]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Most::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.395090218703125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Most", "::", "\<\"normal\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) in \
\\!\\(Most[3.`]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Most::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.39509021871875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Most", "::", "\<\"normal\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) in \
\\!\\(Most[3.`]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Most::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.395090218734375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Most :: \\\"normal\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.39509021884375*^9}],

Cell["{Most[3.], Most[3.], Most[3.], Most[3.]}", "Output",
 CellChangeTimes->{3.395090218875*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<UpTriangle\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.8660254037844386"}], ",", 
        RowBox[{"-", "0.5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.8660254037844386", ",", 
        RowBox[{"-", "0.4999999999999999"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<LeftTriangle\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1."}], ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", 
        RowBox[{"-", "0.8660254037844386"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.4999999999999999", ",", "0.8660254037844386"}], "}"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<DownTriangle\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", 
        RowBox[{"-", "1."}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.8660254037844386", ",", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.8660254037844386"}], ",", "0.4999999999999999"}], 
       "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<RightTriangle\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.8660254037844386"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.4999999999999999"}], ",", 
        RowBox[{"-", "0.8660254037844386"}]}], "}"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"First", "@", 
      RowBox[{"N", "@", 
       RowBox[{"LegacyRegularPolygon", "[", 
        RowBox[{"4", ",", "1", ",", "0", ",", "theta"}], "]"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", 
      RowBox[{"Pi", "/", "4"}], ",", 
      RowBox[{"Pi", "/", "4"}]}], "}"}]}], "]"}], "//", 
  "InputForm"}]], "Input",
 CellChangeTimes->{3.39509273275*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Most", "::", "\<\"normal\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) in \
\\!\\(Most[4.`]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Most::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.39509021890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Most", "::", "\<\"normal\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) in \
\\!\\(Most[4.`]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Most::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.395090218921875*^9}],

Cell["{Most[4.], Most[4.]}", "Output",
 CellChangeTimes->{3.395090218953125*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<Square\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.7071067811865476"}], ",", "0.7071067811865476"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.7071067811865476"}], ",", 
        RowBox[{"-", "0.7071067811865476"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.7071067811865476", ",", 
        RowBox[{"-", "0.7071067811865476"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.7071067811865476", ",", "0.7071067811865476"}], "}"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataSymbolShape", "[", 
    RowBox[{"\"\<Diamond\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"1.2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1."}], ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", 
        RowBox[{"-", "1."}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "0."}], "}"}]}], "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol construction", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataSymbolVertices", "[", 
     RowBox[{"SymbolShape_", ",", 
      RowBox[{"SymbolSize_", "?", "NumericQ"}], ",", "PlotPoints_Integer"}], 
     "]"}], "[", 
    RowBox[{"P", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "BasicShape", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BasicShape", "=", 
       RowBox[{"DPCOfPA", "/@", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SymbolSize", "/", "2"}], ")"}], "*", 
          RowBox[{"DataSymbolShape", "[", 
           RowBox[{"SymbolShape", ",", "PlotPoints"}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"BasicShape", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], 
          "]"}]}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"SchemePoints", "::", "badsymbol"}], ",", "SymbolShape"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"P", "+", "#"}], ")"}], "&"}], "/@", "BasicShape"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ErrorBarPrimatives", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dx_", ",", "dy_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Capx_", ",", "Capy_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "+", 
         RowBox[{"{", 
          RowBox[{"dx", ",", "dy"}], "}"}]}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "+", 
         RowBox[{"{", 
          RowBox[{"dx", ",", "dy"}], "}"}], "-", 
         RowBox[{"DPCOfPA", "@", 
          RowBox[{"{", 
           RowBox[{"Capx", ",", "Capy"}], "}"}]}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "+", 
         RowBox[{"{", 
          RowBox[{"dx", ",", "dy"}], "}"}], "+", 
         RowBox[{"DPCOfPA", "@", 
          RowBox[{"{", 
           RowBox[{"Capx", ",", "Capy"}], "}"}]}]}]}], "}"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data plot engine", "Subsection"],

Cell["\<\
PartitionDataForLine partitions a data set into sublists, each containing at \
least two points, broken at points containing value None\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NoneFreeQ", "[", "x_", "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"DataPointNoneQ", "[", "x", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NoneFreeQ", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"NoneFreeQ", "[", "x", "]"}], "&&", 
    RowBox[{"NoneFreeQ", "[", "y", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PartitionDataForLine", "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Split", "[", 
      RowBox[{"Data", ",", "NoneFreeQ"}], "]"}], ",", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "NoneFreeQ"}], "}"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "x", "]"}], "\[GreaterEqual]", "2"}], 
       ")"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyOrNone", "[", "f_", "]"}], "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"f", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyOrNone", "[", "f_", "]"}], "[", "None", "]"}], ":=", 
   "None"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Timing tests on DataPlot

For 100 lines of 100 points:
\tmapping SchemeLine onto each ~1.6 sec
\tapplying MakeOutline to list of lines ~1.3 sec
\t\twith no user to canvas conversion ~1.1 sec
\t\twith no clipping ~0.65 sec
\tapplying MakeOutline to list of lines, symbol machinery in place but not \
shown ~1.45 sec
\t... and calculations done but no art constructed ~1.85 sec
\t... and art constructed but Make commands commented out ~1.95
\t... and art constructed and display only suppressed at option level in Make \
commands (with Show test after clipping) ~15.1 sec
\t... and art constructed and display only suppressed at option level in Make \
commands (after moving clipping inside Show test) ~1.95 sec
\t... and symbols with line and fill shown ~15.3 sec
\t... and symbols with line and fill shown but no clipping on symbols ~2.46 \
sec
\t\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RecurseData", "[", 
    RowBox[{"Data_", "?", "DataSetQ"}], "]"}], ":=", 
   RowBox[{"ProcessDataSetGroup", "[", 
    RowBox[{"{", "Data", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RecurseData", "[", 
    RowBox[{"Data", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "DataSetQ"}], ")"}], "..."}], "}"}]}], "]"}], ":=", 
   
   RowBox[{"ProcessDataSetGroup", "[", "Data", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RecurseData", "[", 
    RowBox[{"Data", ":", 
     RowBox[{"DataHold", "[", "x_", "]"}]}], "]"}], ":=", 
   RowBox[{"(", "x", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RecurseData", "[", "Data_List", "]"}], ":=", 
   RowBox[{"BlockOptions", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"DataLine", ",", "DataSymbol", ",", "DataTransformation"}], 
      "}"}], ",", 
     RowBox[{"RecurseData", "/@", "Data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RecurseData", "[", 
     RowBox[{"Data", ":", "Null"}], "]"}], ":=", 
    RowBox[{"{", "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "to", " ", "accept", " ", "extra", " ", "commas", " ", "silently"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RecurseData", "[", "Data_", "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"DataPlot", "::", "baddata"}], ",", "Data"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProcessDataSetGroup", "[", 
    RowBox[{"Data", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "DataSetQ"}], ")"}], "..."}], "}"}]}], "]"}], ":=", 
   
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "DataLineOpts", ",", "DataSymbolOpts", ",", "DataTransformationOpts", 
       ",", "\[IndentingNewLine]", "FilteredData", ",", "\[IndentingNewLine]",
        "Segments", ",", "\[IndentingNewLine]", "Points", ",", "PointCenters",
        ",", "\[IndentingNewLine]", "BasicShape", ",", "i", ",", "Point", ",",
        "PointVertices", ",", "CentralPoints", ",", "ExpandedErrorPoints", 
       ",", "\[IndentingNewLine]", "LineArt", ",", "SymbolOutlineArt", ",", 
       "SymbolFillArt", ",", "ErrorBarArt"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "$ProcessDataSets"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Generate", " ", "plot", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DataTransformationOpts", "=", 
       RowBox[{"RealizeOptions", "[", "DataTransformation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DataLineOpts", "=", 
       RowBox[{"RealizeOptions", "[", "DataLine", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DataSymbolOpts", "=", 
       RowBox[{"RealizeOptions", "[", "DataSymbol", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Validate", " ", "plot", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"DataFilters", ",", 
        RowBox[{"None", "|", 
         RowBox[{"(", "_List", ")"}]}], ",", "DataTransformationOpts"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "DataLineOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"Show", ",", 
        RowBox[{"True", "|", "False"}], ",", "DataSymbolOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SymbolSize", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "?", "Positive"}], ",", 
        "DataSymbolOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PlotPoints", ",", 
        RowBox[{"_Integer", "?", "Positive"}], ",", "DataSymbolOpts"}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "data", " ", "point", " ", "lists"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FilteredData", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DataFilters", "/.", "DataTransformationOpts"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"None", "|", 
          RowBox[{"{", "}"}]}], ",", "Data", ",", "\[IndentingNewLine]", 
         "_List", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Composition", "@@", 
            RowBox[{"Reverse", "[", 
             RowBox[{"DataFilters", "/.", "DataTransformationOpts"}], "]"}]}],
            ")"}], "/@", "Data"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"FilteredData", ",", "1"}], "]"}], ",", "NoneFreeQ"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Segments", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"PCOfPU", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"PartitionDataForLine", "/@", 
            RowBox[{"(", 
             RowBox[{"FilteredData", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"x_", ",", "_"}], "]"}], "\[RuleDelayed]", "x"}], 
               "}"}]}], ")"}]}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PointCenters", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"PCOfPU", ",", 
         RowBox[{"(", 
          RowBox[{"Points", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ErrorValue", "[", 
              RowBox[{"x_", ",", "_"}], "]"}], "\[RuleDelayed]", "x"}], 
            "}"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ExpandedErrorPoints", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"Points", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], ",", "y_"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}]}], "]"}], ",", "y"}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x_", ",", "None"}], "]"}], ",", "y_"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}]}], "]"}], ",", "y"}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x_", ",", 
                RowBox[{"dx_", "?", "NumericQ"}]}], "]"}], ",", "y_"}], "}"}],
             "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "dx"}], ",", "dx"}], "}"}]}], "]"}], ",", 
              "y"}], "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandedErrorPoints", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", 
              RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y", ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}]}], "]"}]}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y_", ",", "None"}], "]"}]}], "}"}], "\[RuleDelayed]", 
            
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y", ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}]}], "]"}]}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y_", ",", 
                RowBox[{"dy_", "?", "NumericQ"}]}], "]"}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "dy"}], ",", "dy"}], "}"}]}], "]"}]}], 
             "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandedErrorPoints", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ErrorValue", "[", 
              RowBox[{"x_", ",", 
               RowBox[{"{", 
                RowBox[{"dxm_", ",", "dxp_"}], "}"}]}], "]"}], ",", 
             RowBox[{"ErrorValue", "[", 
              RowBox[{"y_", ",", 
               RowBox[{"{", 
                RowBox[{"dym_", ",", "dyp_"}], "}"}]}], "]"}]}], "}"}], 
           "\[RuleDelayed]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ErrorValue", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ApplyOrNone", "[", "XCOfXU", "]"}], "@", "x"}], ",", 
               
               RowBox[{
                RowBox[{"ApplyOrNone", "[", "DXCOfXU", "]"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"dxm", ",", "dxp"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"ErrorValue", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ApplyOrNone", "[", "YCOfYU", "]"}], "@", "y"}], ",", 
               
               RowBox[{
                RowBox[{"ApplyOrNone", "[", "DYCOfYU", "]"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"dym", ",", "dyp"}], "}"}]}]}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "lines"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LineArt", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "DataLineOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "/@", 
          RowBox[{
           RowBox[{"DataLineShape", "[", 
            RowBox[{
             RowBox[{"LineShape", "/.", "DataLineOpts"}], ",", 
             RowBox[{"PlotPoints", "/.", "DataLineOpts"}]}], "]"}], "/@", 
           "Segments"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "symbols"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Show", "/.", "DataSymbolOpts"}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PointVertices", "=", 
         RowBox[{
          RowBox[{"DataSymbolVertices", "[", 
           RowBox[{
            RowBox[{"SymbolShape", "/.", "DataSymbolOpts"}], ",", 
            RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ",", 
            RowBox[{"PlotPoints", "/.", "DataSymbolOpts"}]}], "]"}], "/@", 
          "PointCenters"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SymbolOutlineArt", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "DataSymbolOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"Append", "[", 
              RowBox[{"#", ",", 
               RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}], ")"}],
           "/@", "PointVertices"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SymbolFillArt", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "DataSymbolOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Polygon", "/@", "PointVertices"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "error", " ", "bars"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ErrorBarArt", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "/.", "DataSymbolOpts"}], ")"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Cases", "[", "\[IndentingNewLine]", 
            RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"dxm_", "?", "NumericQ"}], ",", "dxp_"}], "}"}]}],
                  "]"}], ",", 
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"y_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dym_", ",", "dyp_"}], "}"}]}], "]"}]}], "}"}], ":>",
               
              RowBox[{"ErrorBarPrimatives", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dxm", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ")"}], 
                   "/", "2"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Cases", "[", "\[IndentingNewLine]", 
            RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dxm_", ",", 
                    RowBox[{"dxp_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
                
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"y_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dym_", ",", "dyp_"}], "}"}]}], "]"}]}], "}"}], ":>",
               
              RowBox[{"ErrorBarPrimatives", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dxm", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ")"}], 
                   "/", "2"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Cases", "[", "\[IndentingNewLine]", 
            RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dxm_", ",", "dxp_"}], "}"}]}], "]"}], ",", 
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"y_", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"dym_", "?", "NumericQ"}], ",", "dyp_"}], "}"}]}],
                  "]"}]}], "}"}], ":>", 
              RowBox[{"ErrorBarPrimatives", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "dym"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ")"}], 
                   "/", "2"}], ",", "0"}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Cases", "[", "\[IndentingNewLine]", 
            RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dxm_", ",", "dxp_"}], "}"}]}], "]"}], ",", 
                RowBox[{"ErrorValue", "[", 
                 RowBox[{"y_", ",", 
                  RowBox[{"{", 
                   RowBox[{"dym_", ",", 
                    RowBox[{"dyp_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], 
               "}"}], ":>", 
              RowBox[{"ErrorBarPrimatives", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "dyp"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ")"}], 
                   "/", "2"}], ",", "0"}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Save", " ", "dataset", " ", "info"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$DataTag", "=!=", "Dummy"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "LevelScheme`Data`DataTransformationOpts", "[", "$DataTag", "]"}], 
          "=", "DataTransformationOpts"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LevelScheme`Data`DataLineOpts", "[", "$DataTag", "]"}], 
          "=", "DataLineOpts"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LevelScheme`Data`DataSymbolOpts", "[", "$DataTag", "]"}], 
          "=", "DataSymbolOpts"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LevelScheme`Data`DataCanvasPoints", "[", "$DataTag", "]"}],
           "=", 
          RowBox[{"PCOfPU", "/@", "Points"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Clear", " ", "any", " ", "data", " ", "set", " ", "name"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"$DataTag", "=", "Dummy"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Draw", " ", "artwork"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{"LineArt", ",", "\[IndentingNewLine]", "DataLineOpts"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Error", " ", 
          RowBox[{"bars", " ", "--"}], " ", "behind", " ", "fill"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MakeOutline", "[", 
         RowBox[{
          RowBox[{"{", "ErrorBarArt", "}"}], ",", "DataSymbolOpts"}], "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Fill", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeFill", "[", 
         RowBox[{
          RowBox[{"{", "SymbolFillArt", "}"}], ",", "DataSymbolOpts"}], "]"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeOutline", "[", 
         RowBox[{
          RowBox[{"{", "SymbolOutlineArt", "}"}], ",", "DataSymbolOpts"}], 
         "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data plot control", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DataHeldFunctions", "=", 
   RowBox[{"{", 
    RowBox[{
    "SetOptions", ",", "DataTag", ",", "SaveDataStyle", ",", "SetDataStyle", 
     ",", "DataLabel"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DataHeldPattern", "=", 
   RowBox[{"Alternatives", "@@", 
    RowBox[{"Blank", "/@", "DataHeldFunctions"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"DataHold", ",", "HoldFirst"}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"DataPlot", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataPlot", "[", 
    RowBox[{"Data_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"DataPlot", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "Item", ",", "\[IndentingNewLine]", 
       RowBox[{"LineOpts", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"SymbolOpts", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"LineEnabled", "=", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"SymbolEnabled", "=", "False"}], ",", "\[IndentingNewLine]", 
       "SafeData"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"ShowData", ",", 
        RowBox[{"True", "|", "False"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$DataTag", "=", "Dummy"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"$ProcessDataSets", "=", 
       RowBox[{"(", 
        RowBox[{"ShowData", "/.", "FullOpts"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Block", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Evaluate", "[", "DataHeldFunctions", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SafeData", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"Data", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s", ":", "DataHeldPattern"}], "\[RuleDelayed]", 
              RowBox[{"DataHold", "[", "s", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Debug", "/.", "FullOpts"}], ",", 
           RowBox[{"Print", "[", "SafeData", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RecurseData", "[", "SafeData", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data labeling", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DataLabel", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"DataLabel", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckDataSet", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BasicLineAnnotations", "[", 
       RowBox[{
        RowBox[{"LevelScheme`Data`DataCanvasPoints", "[", "ID", "]"}], ",", 
        "FullOpts"}], "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data set tags and styles", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DataTag", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"DataTag", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckValue", "[", 
       RowBox[{"ID", ",", 
        RowBox[{"IDExpr_", "?", "LevelIdentifierQ"}], ",", 
        "\"\<a data set identifier symbol (cannot be list or number)\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$DataTag", "=", "ID"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "store", " ", "tentative", " ", "style", " ", "information", " ", "in",
         " ", "case", " ", "no", " ", "plot", " ", "later", " ", "made"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "LevelScheme`Data`DataTransformationOpts", "[", "$DataTag", "]"}], "=",
        
       RowBox[{"RealizeOptions", "[", "DataTransformation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataLineOpts", "[", "$DataTag", "]"}], "=", 
       RowBox[{"RealizeOptions", "[", "DataLine", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataSymbolOpts", "[", "$DataTag", "]"}], "=",
        
       RowBox[{"RealizeOptions", "[", "DataSymbol", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataCanvasPoints", "[", "$DataTag", "]"}], 
       "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataTagDefined", "[", "$DataTag", "]"}], "=",
        "True"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SaveDataStyle", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SaveDataStyle", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "DataStyle"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckValue", "[", 
       RowBox[{"ID", ",", 
        RowBox[{"IDExpr_", "?", "LevelIdentifierQ"}], ",", 
        "\"\<a data set identifier symbol (cannot be list or number)\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DataStyle", "=", "ID"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "LevelScheme`Data`DataTransformationOpts", "[", "DataStyle", "]"}], 
       "=", 
       RowBox[{"RealizeOptions", "[", "DataTransformation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataLineOpts", "[", "DataStyle", "]"}], "=", 
       
       RowBox[{"RealizeOptions", "[", "DataLine", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataSymbolOpts", "[", "DataStyle", "]"}], 
       "=", 
       RowBox[{"RealizeOptions", "[", "DataSymbol", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataCanvasPoints", "[", "DataStyle", "]"}], 
       "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LevelScheme`Data`DataTagDefined", "[", "DataStyle", "]"}], 
       "=", "True"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetDataStyle", "[", 
    RowBox[{"ID_", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"SetDataStyle", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]",
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckDataSet", "[", "ID", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Debug", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Restoring style: \>\"", ",", "ID"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"LevelScheme`Data`DataTransformationOpts", "[", "ID", "]"}],
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"LevelScheme`Data`DataLineOpts", "[", "ID", "]"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"LevelScheme`Data`DataSymbolOpts", "[", "ID", "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
       
      RowBox[{"BlockUnprotect", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DataTransformation", ",", "DataLine", ",", "DataSymbol"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Options", "[", "DataTransformation", "]"}], "=", 
          RowBox[{
          "LevelScheme`Data`DataTransformationOpts", "[", "ID", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Options", "[", "DataLine", "]"}], "=", 
          RowBox[{"LevelScheme`Data`DataLineOpts", "[", "ID", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Options", "[", "DataSymbol", "]"}], "=", 
          RowBox[{"LevelScheme`Data`DataSymbolOpts", "[", "ID", "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Legend construction", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DataLegend", "[", 
    RowBox[{
     RowBox[{"PS", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"DataSetInfo", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"DataLegend", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "P0", ",", "Pi", ",", "DPY", ",", "DPLeft", ",",
        "DPCenter", ",", "DPRight", ",", "DPText", ",", "\[IndentingNewLine]",
        "DataSetID", ",", "DataSetText", ",", "LineVertices", ",", 
       "\[IndentingNewLine]", "DataLineOpts", ",", "DataSymbolOpts", ",", 
       "SymbolVertices", ",", "\[IndentingNewLine]", "i"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P0", "=", 
       RowBox[{"PCOfPS", "[", "PS", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DPY", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"DYCOfYA", "[", 
           RowBox[{"FontSize", "/.", "FullOpts"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DPLeft", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DPSymbol", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DXCOfXA", "[", 
          RowBox[{"Length", "/.", "FullOpts"}], "]"}], ",", "0"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"DPRight", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"DXCOfXA", "[", 
           RowBox[{"Length", "/.", "FullOpts"}], "]"}]}], ",", "0"}], "}"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"DPText", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"DXCOfXA", "[", 
            RowBox[{"Length", "/.", "FullOpts"}], "]"}]}], "+", 
          RowBox[{"DXCOfXA", "[", 
           RowBox[{"Gap", "/.", "FullOpts"}], "]"}]}], ",", "0"}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TableForEach", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Pi", "=", 
            RowBox[{"P0", "+", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "*", "DPY"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"LineSpacing", "/.", "FullOpts"}], ")"}], "*", 
              "DPY"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"CheckDataSet", "[", "DataSetID", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"DataLineOpts", "=", 
            RowBox[{
            "LevelScheme`Data`DataLineOpts", "[", "DataSetID", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LineVertices", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Pi", "+", "DPLeft"}], ",", 
              RowBox[{"Pi", "+", "DPRight"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Line", "[", "LineVertices", "]"}], "}"}], ",", 
             "DataLineOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DataSymbolOpts", "=", 
            RowBox[{
            "LevelScheme`Data`DataSymbolOpts", "[", "DataSetID", "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"SymbolVertices", "=", 
            RowBox[{
             RowBox[{"DataSymbolVertices", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SymbolShape", "/.", "DataSymbolOpts"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"SymbolSize", "/.", "DataSymbolOpts"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotPoints", "/.", "DataSymbolOpts"}]}], 
              "\[IndentingNewLine]", "]"}], "[", 
             RowBox[{"Pi", "+", "DPSymbol"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"MakeOutline", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
                ")"}], "@", "SymbolVertices"}], "}"}], ",", 
             "DataSymbolOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"MakeFill", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Polygon", "@", "SymbolVertices"}], "}"}], ",", 
            "DataSymbolOpts"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"MakeText", "[", 
           RowBox[{"DataSetText", ",", 
            RowBox[{"Pi", "+", "DPText"}], ",", "0", ",", 
            RowBox[{"Offset", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", "FullOpts"}], 
           "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"DataSetID", ",", "DataSetText"}], "}"}], ",", "i", ",", 
          "DataSetInfo"}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Figure construction", "Section"],

Cell[CellGroupData[{

Cell["Conditional evaluation", "Subsection"],

Cell["\<\
SchemeIfDef, SchemeIfNDef -- conditional inclusion
\tUses global variable: $SchemeFlags\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"SchemeIfDef", ",", "HoldRest"}], "]"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "HoldRest", " ", "to", " ", "avoid", " ", "side", " ", "effects", " ", 
    "of", " ", "evaluating", " ", "Objects", " ", "sequence"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeIfDef", "[", 
    RowBox[{"Flag_", ",", "Objects___"}], "]"}], ":=", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"$SchemeFlags", ",", "Flag"}], "]"}], ",", 
      RowBox[{"{", "Objects", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"SchemeIfNDef", ",", "HoldRest"}], "]"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "HoldRest", " ", "to", " ", "avoid", " ", "side", " ", "effects", " ", 
    "of", " ", "evaluating", " ", "Objects", " ", "sequence"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeIfNDef", "[", 
    RowBox[{"Flag_", ",", "Objects___"}], "]"}], ":=", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"$SchemeFlags", ",", "Flag"}], "]"}]}], ",", 
      RowBox[{"{", "Objects", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Layer sorting auxiliary functions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetLayer", "[", 
    RowBox[{"SchemeGraphics", "[", 
     RowBox[{"_", ",", "_", ",", "LayerID_"}], "]"}], "]"}], ":=", 
   "LayerID"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SchemeGraphicsOrderedQ", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Obj1", ",", "Obj2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"GetLayer", "[", "Obj1", "]"}], "\[LessEqual]", 
      RowBox[{"GetLayer", "[", "Obj2", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Figure display", "Subsection"],

Cell["\<\
\tMust set attribute HoldFirst for Figure[], so that any SetOptions[] \
expressions in the arguments are not evaluated  until *after* we have saved \
the global values using BlockOptions.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"Figure", ",", 
     RowBox[{"{", "HoldFirst", "}"}]}], "]"}], ";"}], "\n", 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "[", 
    RowBox[{"Body_List", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"option", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"Figure", ",", "Opts"}], "]"}]}], ",", "\[IndentingNewLine]",
        
       RowBox[{"ExpansionFactor", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"work", " ", "variables"}], " ", "*)"}], 
       "\[IndentingNewLine]", "SchemeList", ",", "\[IndentingNewLine]", 
       "RawFrameLabel", ",", "\[IndentingNewLine]", "FormattedFrameLabel", 
       ",", "\[IndentingNewLine]", "GraphicsPrimatives", ",", 
       "\[IndentingNewLine]", "GraphicsOptions", ",", "\[IndentingNewLine]", 
       "FullGraphics", ",", "\[IndentingNewLine]", "FrameStyleOpts", ",", 
       "FrameTextStyleOpts", ",", "TickTextStyleOpts", ",", 
       "\[IndentingNewLine]", "UsedPlotRange", ",", "\[IndentingNewLine]", 
       "ErrorStatus", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"pattern", " ", "names"}], " ", "*)"}], "\[IndentingNewLine]",
        
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "locally", " ", "define", " ", "pattern", " ", "names", " ", "used", 
          " ", "in", " ", "scheme", " ", "list", " ", "processing"}], ",", 
         " ", 
         RowBox[{
         "to", " ", "avoid", " ", "glitch", " ", "if", " ", "global", " ", 
          "value", " ", "defined", " ", 
          RowBox[{"(", 
           RowBox[{
           "though", " ", "this", " ", "is", " ", "not", " ", "really", " ", 
            "a", " ", "concern", " ", "in", " ", "the", " ", "Private", " ", 
            "context"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "GraphicsObject", ",", "\[IndentingNewLine]", "Primatives"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Flag", " ", "entry", " ", "into", " ", "Scheme"}], ",", " ", 
       RowBox[{"for", " ", "error", " ", "handling", " ", "mechanism"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"$InScheme", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"LevelScheme", "::", "notreentrant"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Block", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"$InScheme", "=", "True"}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "options"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"CatchError", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"PlotRange", "/.", "FullOpts"}], ")"}], "===", 
                "Automatic"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Message", "[", 
                RowBox[{"Scheme", "::", "prange"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CheckOption", "[", 
              RowBox[{"PlotRange", ",", 
               RowBox[{"Automatic", "|", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"_", "?", "NumericQ"}], ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"_", "?", "NumericQ"}], ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
               "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CheckOption", "[", 
              RowBox[{"ImageSize", ",", 
               RowBox[{"Automatic", "|", 
                RowBox[{"_", "?", "NumericQ"}], "|", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], ",", 
                  RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
               "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CheckOption", "[", 
              RowBox[{"BlockOptions", ",", 
               RowBox[{"{", "___Symbol", "}"}], ",", "FullOpts"}], "]"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"CheckOption", "[", 
              RowBox[{"SchemeFlags", ",", 
               RowBox[{"{", "___String", "}"}], ",", "FullOpts"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Debugging", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Information", "/.", "FullOpts"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "$Version", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"{", 
              RowBox[{
              "$System", ",", "$SystemID", ",", "$OperatingSystem", ",", 
               "$MachineType", ",", "$ProcessorType", ",", "$ByteOrdering", 
               ",", "$MachineName"}], "}"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "$Path", "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Clear", " ", "any", " ", "existing", " ", "scheme", " ", "data", 
           " ", "definitions"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "\"\<LevelScheme`Data`*\>\"", ",", 
           "\"\<LevelScheme`Multipanel`*\>\"", ",", 
           "\"\<LevelScheme`AutoLevel`\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Set", " ", "up", " ", "coordinate", " ", "systems"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"absolute", " ", "size", " ", "imitates", " ", "Show"}], 
           ",", " ", 
           RowBox[{"defaulting", " ", "to", " ", "4", "*", "72"}], ",", " ", 
           RowBox[{
           "with", " ", "GoldenRatio", " ", "aspect", " ", "ratio"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"$AbsSize", "=", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ImageSize", "/.", "FullOpts"}], ")"}], ",", 
            "\[IndentingNewLine]", "Automatic", ",", 
            RowBox[{"4", "*", "72", "*", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"1", "/", "GoldenRatio"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ImageSize", "/.", "FullOpts"}], ")"}], "*", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"1", "/", "GoldenRatio"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
            RowBox[{"(", 
             RowBox[{"ImageSize", "/.", "FullOpts"}], ")"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Plot", " ", "range", " ", "is", " ", "expanded", " ", "outwards", 
            " ", "by", " ", "small", " ", "fraction", " ", "in", " ", "each", 
            " ", "direction"}], ",", " ", 
           RowBox[{
            RowBox[{"beyond", " ", "user"}], "-", 
            RowBox[{"determined", " ", "nominal", " ", "range"}]}], ",", " ", 
           
           RowBox[{
           "so", " ", "ending", " ", "tick", " ", "labels", " ", "are", " ", 
            "guaranteed", " ", "to", " ", "fit", " ", 
            RowBox[{"in", "."}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
         
         RowBox[{"UsedPlotRange", "=", 
          RowBox[{"ExtendRegion", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"GetAutoOption", "[", 
              RowBox[{"PlotRange", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "FullOpts"}], 
              "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"ExtendRange", "/.", "FullOpts"}], ")"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"$CanvasRange", "=", 
          RowBox[{"ExtendRegion", "[", 
           RowBox[{"UsedPlotRange", ",", "ExpansionFactor"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$P1C", "=", 
          RowBox[{"First", "/@", "$CanvasRange"}]}], ";", 
         RowBox[{"$P2C", "=", 
          RowBox[{"Last", "/@", "$CanvasRange"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$TickScaleFactor", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Plus", "@@", "$AbsSize"}], "/", "2"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CatchError", "[", 
            RowBox[{"SetRegion", "[", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Initialize", " ", "global", " ", "state", " ", "variables"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"$SchemeFlags", "=", 
          RowBox[{"(", 
           RowBox[{"SchemeFlags", "/.", "FullOpts"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$LastLevel", "=", "Null"}], ";", "\[IndentingNewLine]", 
         RowBox[{"$Background", "=", "None"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Evaluate", " ", "body"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "implements", " ", "held", " ", "calls", " ", "to", " ", 
            "SetOptions"}], ",", " ", 
           RowBox[{
           "catches", " ", "any", " ", "Throw", " ", "from", " ", "option", 
            " ", "or", " ", "parameter", " ", "validation"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"$DisplayFunction", "=", "Identity"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"BlockOptions", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"OptionSymbols", ",", "OptionSymbols3D", ",", 
               RowBox[{"(", 
                RowBox[{"BlockOptions", "/.", "FullOpts"}], ")"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ErrorStatus", "=", 
              RowBox[{"CatchError", "[", 
               RowBox[{"SchemeList", "=", "Body"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "handle", " ", "possible", " ", "error", " ", "thrown", " ", "by", 
            " ", "ErrorMessage"}], ",", " ", 
           RowBox[{
           "but", " ", "only", " ", "now", " ", "after", " ", "block", " ", 
            "constructs", " ", "have", " ", "restored", " ", "all", " ", 
            "scoped", " ", "values"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"ErrorStatus", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Preprocess", " ", "list", " ", "of", " ", "scheme", " ", 
           "objects"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Flatten", " ", "list"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"SchemeList", "=", 
          RowBox[{"Flatten", "[", "SchemeList", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Debug", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Object list after flattening: \>\"", ",", 
             RowBox[{"SchemeList", "//", "InputForm"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Strip", " ", "any", " ", "remaining", " ", "unidentified", " ", 
           "objects"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"SchemeList", ",", 
              RowBox[{"(", 
               RowBox[{
               "_Graphics", "|", "_ContourGraphics", "|", 
                "_DensityGraphics"}], ")"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "\[NotEqual]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Message", "[", 
            RowBox[{"Scheme", "::", "freegraphics"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"SchemeList", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"SchemeList", ",", "_SchemeGraphics"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Debug", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Object list after cleanup: \>\"", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"SchemeList", "//", "InputForm"}], ")"}], "//", 
              "TableForm"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Sort", " ", "scheme", " ", "by", " ", "layer"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SchemeList", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"SchemeList", ",", "SchemeGraphicsOrderedQ"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Extract", " ", "all", " ", "the", " ", "graphics", " ", 
           "primatives"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"GraphicsPrimatives", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{"SchemeList", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SchemeGraphics", "[", 
               RowBox[{"Directives_List", ",", "Primatives_List", ",", "_"}], 
               "]"}], "\[RuleDelayed]", 
              RowBox[{"Join", "[", 
               RowBox[{"Directives", ",", "Primatives"}], "]"}]}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GraphicsPrimatives", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"GraphicsPrimatives", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Debug", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Graphics size before directive pruning: \>\"", ",", 
             RowBox[{"ByteCount", "[", "GraphicsPrimatives", "]"}], ",", 
             "\"\< bytes\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Add", " ", "PostScript", " ", "comment"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"GraphicsPrimatives", ",", 
             RowBox[{"PostScript", "[", 
              RowBox[{
              "\"\<% This drawing was created using LevelScheme, Version \
\>\"", "<>", "$RevisionString", "<>", "\"\<.\>\""}], "]"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Construct", " ", "graphics", " ", "display", " ", "options"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CatchError", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FrameStyleOpts", "=", 
              RowBox[{"MakeOutlineDirectives", "[", "FullOpts", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameTextStyleOpts", "=", 
              RowBox[{"MakeTextStyle", "[", "FullOpts", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TickTextStyleOpts", "=", 
              RowBox[{"MakeTextStyle", "[", 
               RowBox[{"OptionsUnion", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FontFamily", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontFamily", ",", 
                    RowBox[{"FontFamily", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontSize", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontSize", ",", 
                    RowBox[{"FontSize", "/.", "FullOpts"}], ",", "FullOpts"}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontWeight", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontWeight", ",", 
                    RowBox[{"FontWeight", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontSlant", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontSlant", ",", 
                    RowBox[{"FontSlant", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontTracking", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontTracking", ",", 
                    RowBox[{"FontTracking", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontColor", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontColor", ",", 
                    RowBox[{"FontColor", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FontOpacity", "\[Rule]", 
                  RowBox[{"GetAutoOption", "[", 
                   RowBox[{"TickFontOpacity", ",", 
                    RowBox[{"FontOpacity", "/.", "FullOpts"}], ",", 
                    "FullOpts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 "FullOpts"}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RawFrameLabel", "=", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FrameLabel", "/.", "FullOpts"}], ")"}], ",", 
            "\[IndentingNewLine]", "None", ",", "\[IndentingNewLine]", "None",
             ",", "\[IndentingNewLine]", "Automatic", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LabB", ",", "LabL", ",", "LabT", ",", "LabR"}], "}"}], 
             "/.", "FullOpts"}], ",", "\[IndentingNewLine]", "_List", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"FrameLabel", "/.", "FullOpts"}], ")"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"FormattedFrameLabel", "=", 
          RowBox[{"Switch", "[", "\[IndentingNewLine]", 
           RowBox[{
           "RawFrameLabel", ",", "\[IndentingNewLine]", "None", ",", "None", 
            ",", "\[IndentingNewLine]", "_List", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "===", "None"}], ",", "None", ",", 
                 RowBox[{"DisplayForm", "[", 
                  RowBox[{"StyleForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Sequence", "@@", "FrameTextStyleOpts"}]}], "]"}],
                   "]"}]}], "]"}], ")"}], "&"}], "/@", "RawFrameLabel"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"GraphicsOptions", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PlotRange", " ", "\[Rule]", "$CanvasRange"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "$AbsSize"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{
              RowBox[{"$AbsSize", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"$AbsSize", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Frame", "->", " ", 
             RowBox[{"(", 
              RowBox[{"Frame", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "FrameStyleOpts", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", "FormattedFrameLabel"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"FrameTicks", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Axes", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Axes", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Ticks", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TextStyle", "\[Rule]", "TickTextStyleOpts"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Background", "/.", "FullOpts"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"DisplayFunction", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"DisplayFunction", "/.", "FullOpts"}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Debug", "/.", "FullOpts"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Graphics options: \>\"", ",", "GraphicsOptions"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Construct", " ", "and", " ", "render", " ", "full", " ", 
           "graphics", " ", "object"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"FullGraphics", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"GraphicsPrimatives", ",", "GraphicsOptions"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "FullGraphics", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Delete", " ", "scheme", " ", "data", " ", "definitions"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "\"\<LevelScheme`Data`*\>\"", ",", 
           "\"\<LevelScheme`Multipanel`*\>\"", ",", 
           "\"\<LevelScheme`AutoLevel`\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"Return", " ", "result"}], " ", "*)"}], 
         "\[IndentingNewLine]", "FullGraphics"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395094058546875*^9, 3.39509406065625*^9}, {
   3.395094145734375*^9, 3.3950941489375*^9}, {3.395094187234375*^9, 
   3.395094190671875*^9}, {3.395094437453125*^9, 3.395094451484375*^9}, {
   3.395094677546875*^9, 3.39509467865625*^9}, 3.395094712265625*^9, {
   3.395094749828125*^9, 3.39509478028125*^9}, {3.395094815765625*^9, 
   3.395094816171875*^9}, {3.395094909625*^9, 3.39509491075*^9}, {
   3.3950953448125*^9, 3.395095377296875*^9}, {3.395520199671875*^9, 
   3.3955202125*^9}, 3.396633484703125*^9, {3.396634631390625*^9, 
   3.3966346449375*^9}, {3.396635471921875*^9, 3.39663547665625*^9}, {
   3.396635677296875*^9, 3.396635680078125*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["User-accessible utilities", "Section"],

Cell[CellGroupData[{

Cell["Automatic level/transition spacing controls ", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoLevelInit", "[", 
     RowBox[{"Posn_", ",", "Space_", ",", "BigSpace_"}], "]"}], "  ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`IDi", " ", "=", " ", "Null"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`Posn", " ", "=", " ", "Posn"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`Space", " ", "=", " ", "Space"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`xbigSpace", " ", "=", " ", "BigSpace"}],
        ";", "\[IndentingNewLine]", "Null"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoLevel", "[", 
     RowBox[{"IDi_", "?", "LevelIdentifierQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`Posn", "+=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{"LevelScheme`AutoLevel`IDi", " ", "===", " ", "Null"}], 
           "]"}], ",", " ", "0", ",", 
          RowBox[{
          "LevelScheme`AutoLevel`xbigSpace", "-", 
           "LevelScheme`AutoLevel`Space"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LevelScheme`AutoLevel`IDi", "=", "IDi"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoTrans", "[", 
    RowBox[{
     RowBox[{"IDf_", "?", "LevelIdentifierQ"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Posn", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Posn", "=", "LevelScheme`AutoLevel`Posn"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "LevelScheme`AutoLevel`Posn", "+=", "LevelScheme`AutoLevel`Space"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Trans", "[", 
       RowBox[{
       "LevelScheme`AutoLevel`IDi", ",", "Posn", ",", "IDf", ",", "Automatic",
         ",", "Opts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extraction of points from graphics", "Subsection"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ExtractLines", "[", 
     RowBox[{"G", ":", 
      RowBox[{"(", 
       RowBox[{"_Graphics", "|", "_Graphics3D"}], ")"}]}], "]"}], ":=", 
    RowBox[{"Cases", "[", 
     RowBox[{"G", ",", "_Line", ",", "Infinity"}], "]"}]}], ";"}],
  InitializationCell->True], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ExtractLines", "[", 
     RowBox[{"CG", ":", 
      RowBox[{"(", "_ContourGraphics", ")"}]}], "]"}], ":=", 
    RowBox[{"ExtractLines", "[", 
     RowBox[{"Graphics", "[", "CG", "]"}], "]"}]}], ";"}],
  InitializationCell->True]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "[", 
    RowBox[{"G", ":", 
     RowBox[{"(", 
      RowBox[{"_Graphics", "|", "_Graphics3D", "|", "_ContourGraphics"}], 
      ")"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Lines", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Lines", "=", 
       RowBox[{"ExtractLines", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Lines", "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{"GrabPoints", "::", "nolines"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Lines", "]"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{"GrabPoints", "::", "manylines"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lines", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Style directive generation", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineStyle", "[", 
    RowBox[{"Opts___", "?", "OptionQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"LineStyle", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeOutlineDirectives", "[", "FullOpts", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FillStyle", "[", 
    RowBox[{"Opts___", "?", "OptionQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"FullOpts", "=", 
       RowBox[{"RealizeOptions", "[", 
        RowBox[{"FillStyle", ",", "Opts"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeFillDirectives", "[", "FullOpts", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scheme template cell generator", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IndentingNewline", "=", 
   RowBox[{"FromCharacterCode", "[", "62371", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SchemeTemplateCell", "=", 
   RowBox[{"Cell", "[", 
    RowBox[{
     RowBox[{"BoxData", "[", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RowBox", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Scheme\>\"", ",", "\"\<[\>\"", ",", "IndentingNewline", ",", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\\(", 
                RowBox[{"{", "}"}], "\\)"}], ",", "\"\<,\>\"", ",", 
               "IndentingNewline", ",", 
               RowBox[{"\\(", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"\\(", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\\(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "\\)"}], ",", 
                    RowBox[{"\\(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "\\)"}]}], "}"}], 
                  "\\)"}]}], "\\)"}], ",", "\"\<,\>\"", ",", 
               "IndentingNewline", ",", 
               RowBox[{"\\(", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"\\(", 
                  RowBox[{"72", "*", 
                   RowBox[{"\\(", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "4"}], "}"}], "\\)"}]}], "\\)"}]}], 
                "\\)"}]}], "}"}], "]"}], ",", "IndentingNewline", ",", 
            "\"\<]\>\""}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<;\>\""}], "\[IndentingNewLine]", "}"}], 
       "]"}], "]"}], ",", "\"\<Input\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeTemplate", "[", "]"}], ":=", 
   RowBox[{"CellPrint", "[", "SchemeTemplateCell", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Debugging tools", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LevelScheme", "[", "]"}], ":=", 
   RowBox[{"Get", "[", "\"\<LevelScheme`\>\"", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MultipanelSettings", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "SymbolNames", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SymbolNames", "=", 
       RowBox[{"Names", "[", "\"\<LevelScheme`Multipanel`*\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"#", ",", "\"\< \>\"", ",", 
           RowBox[{"ToExpression", "[", "#", "]"}]}], "]"}], "&"}], ")"}], "/@",
        "SymbolNames"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual definitions", "Section"],

Cell[CellGroupData[{

Cell["Fall-through syntax error traps", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Lev", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"Lev", ",", "Expr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ExtensionLine", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ExtensionLine", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Connector", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"Connector", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Trans", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"Trans", ",", "Expr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ManualLabel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ManualLabel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ScaledLabel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ScaledLabel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"BandLabel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"BandLabel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"LevelLabel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"LevelLabel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeBracket", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeBracket", ",", "Expr"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeLine", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeLine", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemePoints", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemePoints", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemePolygon", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemePolygon", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeCircle", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeCircle", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeEllipse", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeEllipse", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeBox", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeBox", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeSquare", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeSquare", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeArrow", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeArrow", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"RawGraphics", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"RawGraphics", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ViewPort3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ViewPort3D", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ScaledViewPort3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ViewPort3D", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"FigurePanel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"FigurePanel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ScaledFigurePanel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ScaledFigurePanel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Multipanel", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"Multipanel", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"SchemeAxis", "[", "___", "]"}], "]"}]}], ":=", 
    RowBox[{"FallThroughError", "[", 
     RowBox[{"SchemeAxis", ",", "Expr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"PanelLetter", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"PanelLetter", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"LineStyle", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"LineStyle", ",", "Expr"}], "]"}]}], ";"}], "\[IndentingNewLine]",
 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"FillStyle", "[", "___", "]"}], "]"}]}], ":=", 
    RowBox[{"FallThroughError", "[", 
     RowBox[{"FillStyle", ",", "Expr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"DataPlot", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"DataPlot", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"DataLegend", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"DataLegend", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"DataTag", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"DataTag", ",", "Expr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SaveDataStyle", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SaveDataStyle", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SetDataStyle", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SetDataStyle", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"DataLabel", "[", "___", "]"}], "]"}]}], ":=", 
    RowBox[{"FallThroughError", "[", 
     RowBox[{"DataLabel", ",", "Expr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SetRegion", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SetRegion", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SetOrigin", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SetOrigin", ",", "Expr"}], "]"}]}], ";"}], "\[IndentingNewLine]",
 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"SetScale", "[", "___", "]"}], "]"}]}], ":=", 
    RowBox[{"FallThroughError", "[", 
     RowBox[{"SetScale", ",", "Expr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ConvertCoordinate", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ConvertCoordinate", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ConvertRange", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ConvertRange", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"ConvertRegion", "[", "___", "]"}], "]"}]}], ":=", 
    RowBox[{"FallThroughError", "[", 
     RowBox[{"ConvertRegion", ",", "Expr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"ManualLabel3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"ManualLabel3D", ",", "Expr"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeLine3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeLine3D", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SchemeArrow3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"SchemeArrow3D", ",", "Expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"RawGraphics3D", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"FallThroughError", "[", 
    RowBox[{"RawGraphics3D", ",", "Expr"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395091964203125*^9, 3.39509196621875*^9}, {
  3.395092450390625*^9, 3.3950924525625*^9}, {3.3955212516875*^9, 
  3.39552125171875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Figure", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"Scheme", "::", "args"}], ",", "Scheme"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expr", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"AttachIndex", "[", "___", "]"}], "]"}]}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"AttachIndex", "::", "args"}], ",", 
     RowBox[{"HoldForm", "[", "Expr", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Legacy definitions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeOrigin", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SetSchemeOrigin", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOrigin", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeScale", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SetSchemeScale", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetScale", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSchemeRegion", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SetSchemeRegion", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetRegion", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransArrow", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"TransArrow", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Trans", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AnnotateL", "[", 
    RowBox[{"ID_", ",", "Args___"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"AnnotateL", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LevelLabel", "[", 
       RowBox[{"ID", ",", "Left", ",", "Args"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AnnotateR", "[", 
    RowBox[{"ID_", ",", "Args___"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"AnnotateR", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LevelLabel", "[", 
       RowBox[{"ID", ",", "Right", ",", "Args"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLineL", "[", 
    RowBox[{"ID_", ",", "Args___"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ExtensionLineL", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtensionLine", "[", 
       RowBox[{"ID", ",", "Left", ",", "Args"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtensionLineR", "[", 
    RowBox[{"ID_", ",", "Args___"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ExtensionLineR", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtensionLine", "[", 
       RowBox[{"ID", ",", "Right", ",", "Args"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisB", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SchemeAxisB", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeAxis", "[", 
       RowBox[{"Bottom", ",", "Args"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisL", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SchemeAxisL", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeAxis", "[", 
       RowBox[{"Left", ",", "Args"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisT", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SchemeAxisT", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeAxis", "[", 
       RowBox[{"Top", ",", "Args"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SchemeAxisR", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SchemeAxisR", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SchemeAxis", "[", 
       RowBox[{"Right", ",", "Args"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RegionLabel", "[", "Args___", "]"}], " ", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"RegionLabel", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ScaledLabel", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoInit", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"AutoInit", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AutoLevelInit", "[", "Args", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoPanel", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{"AutoPanel", "::", "replaced"}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoPanelInit", "[", "Args___", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{"AutoPanelInit", "::", "replaced"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetCoordinates", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ResetCoordinates", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetRegion", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.39663606546875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scheme", "=", "Figure"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["SchemePoints -- DEPRECATED", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SchemePoints", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOpts", "=", 
        RowBox[{"RealizeOptions", "[", 
         RowBox[{"SchemePoints", ",", "Opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "BasicShape", ",", "i", ",", "Point", ",", 
       "PointVertices", ",", "CentralPoints", ",", "ExpandedErrorPoints", ",",
        "ErrorBars"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"SchemePoints", "::", "deprecated"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckInScheme", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"SymbolSize", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "?", "Positive"}], ",", 
        "FullOpts"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckOption", "[", 
       RowBox[{"PlotPoints", ",", 
        RowBox[{"_Integer", "?", "Positive"}], ",", "FullOpts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "points"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BasicShape", "=", 
       RowBox[{"DPCOfPA", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SymbolSize", "/.", "FullOpts"}], ")"}], "*", 
          RowBox[{"N", "[", 
           RowBox[{"DataSymbolShape", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"SymbolShape", "/.", "FullOpts"}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"PlotPoints", "/.", "FullOpts"}], ")"}]}], "]"}], 
           "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"BasicShape", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], 
          "]"}]}], ",", 
        RowBox[{"ErrorMessage", "[", 
         RowBox[{
          RowBox[{"DataPlot", "::", "badsymbol"}], ",", 
          RowBox[{"(", 
           RowBox[{"SymbolShape", "/.", "FullOpts"}], ")"}]}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"CentralPoints", "=", 
       RowBox[{"(", 
        RowBox[{"Points", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ErrorValue", "[", 
            RowBox[{"x_", ",", "_"}], "]"}], "\[RuleDelayed]", "x"}], "}"}]}],
         ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PointVertices", "=", 
       RowBox[{"TableForEach", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"PCOfPU", "[", "Point", "]"}], "+", "#"}], ")"}], "&"}], 
          "/@", "BasicShape"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Point", ",", "CentralPoints"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "error", " ", "bars"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandedErrorPoints", "=", 
       RowBox[{"(", 
        RowBox[{"Points", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ErrorValue", "[", 
            RowBox[{"x_", ",", "dx_"}], "]"}], ":>", 
           RowBox[{"ErrorValue", "[", 
            RowBox[{"x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "dx"}], ",", "dx"}], "}"}]}], "]"}]}], "}"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ErrorBars", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cases", "[", "\[IndentingNewLine]", 
          RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "x_", ")"}], "|", 
               RowBox[{"ErrorValue", "[", 
                RowBox[{"x_", ",", "_"}], "]"}]}], ",", 
              RowBox[{"ErrorValue", "[", 
               RowBox[{"y_", ",", 
                RowBox[{"{", 
                 RowBox[{"dym_", ",", "dyp_"}], "}"}]}], "]"}]}], "}"}], ":>",
             
            RowBox[{"ErrorBarPrimatives", "[", 
             RowBox[{"Vertical", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dym", ",", "dyp"}], "}"}], ",", 
              RowBox[{"(", 
               RowBox[{"SymbolSize", "/.", "FullOpts"}], ")"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Cases", "[", "\[IndentingNewLine]", 
          RowBox[{"ExpandedErrorPoints", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ErrorValue", "[", 
               RowBox[{"x_", ",", 
                RowBox[{"{", 
                 RowBox[{"dxm_", ",", "dxp_"}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", "y_", ")"}], "|", 
               RowBox[{"ErrorValue", "[", 
                RowBox[{"y_", ",", "_"}], "]"}]}]}], "}"}], ":>", 
            RowBox[{"ErrorBarPrimatives", "[", 
             RowBox[{"Horizontal", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dxm", ",", "dxp"}], "}"}], ",", 
              RowBox[{"(", 
               RowBox[{"SymbolSize", "/.", "FullOpts"}], ")"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Draw", " ", "artwork"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Error", " ", 
         RowBox[{"bars", " ", "--"}], " ", "behind", " ", "fill"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "{", "\[IndentingNewLine]", "ErrorBars", "\[IndentingNewLine]", 
           "}"}], ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Fill", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeFill", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Polygon", "/@", "PointVertices"}], "\[IndentingNewLine]", 
           "}"}], ",", "\[IndentingNewLine]", "FullOpts"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Outline", " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"MakeOutline", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"Append", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
             ")"}], "/@", "PointVertices"}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", "FullOpts"}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End private context", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["End package", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<DataLineShape\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<DataSymbolShape\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->"RulerBar",
WindowSize->{1272, 902},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrintingCopies->1,
PrintingPageRange->{1, 2},
PageHeaders->{{Inherited, Inherited, Inherited}, {
   Cell[
    TextData[{"LevelScheme 3.20 source code"}], "Header"], Inherited, 
   Inherited}},
PageHeaderLines->{False, Inherited},
PrintingOptions->{"PrintingMargins"->{{36, 36}, {19.125, 36}}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 307, 10, 83, "Chapter"],
Cell[878, 33, 231, 6, 68, "Text"],
Cell[CellGroupData[{
Cell[1134, 43, 34, 0, 88, "Section"],
Cell[1171, 45, 5057, 130, 652, "Input",
 InitializationCell->True],
Cell[6231, 177, 718, 16, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6986, 198, 32, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[7043, 202, 106, 1, 46, "Subsection"],
Cell[7152, 205, 1101, 23, 168, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8290, 233, 48, 0, 46, "Subsection"],
Cell[8341, 235, 191, 4, 34, "Text"],
Cell[8535, 241, 1242, 22, 221, "Text"],
Cell[9780, 265, 829, 16, 58, "Input",
 InitializationCell->True],
Cell[10612, 283, 184, 5, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10845, 294, 27, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[10897, 298, 43, 0, 46, "Subsection"],
Cell[10943, 300, 210, 6, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11190, 311, 47, 0, 46, "Subsection"],
Cell[11240, 313, 3093, 88, 366, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[14370, 406, 48, 0, 46, "Subsection"],
Cell[14421, 408, 122, 3, 34, "Text"],
Cell[14546, 413, 13223, 432, 1730, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[27806, 850, 47, 0, 46, "Subsection"],
Cell[27856, 852, 2326, 74, 278, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30219, 931, 50, 0, 46, "Subsection"],
Cell[30272, 933, 2607, 80, 300, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[32916, 1018, 49, 0, 46, "Subsection"],
Cell[32968, 1020, 5730, 187, 696, "Input",
 InitializationCell->True],
Cell[38701, 1209, 60, 0, 34, "Text"],
Cell[38764, 1211, 2078, 65, 278, "Input",
 InitializationCell->True],
Cell[40845, 1278, 1702, 47, 256, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[42584, 1330, 62, 0, 46, "Subsection"],
Cell[42649, 1332, 864, 20, 212, "Input",
 InitializationCell->True],
Cell[43516, 1354, 1132, 23, 256, "Input",
 InitializationCell->True],
Cell[44651, 1379, 1326, 40, 168, "Input",
 InitializationCell->True],
Cell[45980, 1421, 717, 15, 168, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[46734, 1441, 36, 0, 46, "Subsection"],
Cell[46773, 1443, 936, 24, 190, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[47746, 1472, 35, 0, 46, "Subsection"],
Cell[47784, 1474, 951, 27, 168, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[48772, 1506, 46, 0, 46, "Subsection"],
Cell[48821, 1508, 244, 6, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[49102, 1519, 43, 0, 46, "Subsection"],
Cell[49148, 1521, 2123, 54, 344, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51308, 1580, 35, 0, 46, "Subsection"],
Cell[51346, 1582, 911, 26, 124, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[52294, 1613, 40, 0, 46, "Subsection"],
Cell[52337, 1615, 708, 18, 146, "Input",
 InitializationCell->True],
Cell[53048, 1635, 918, 22, 190, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[54003, 1662, 37, 0, 46, "Subsection"],
Cell[54043, 1664, 6305, 172, 916, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60385, 1841, 35, 0, 46, "Subsection"],
Cell[60423, 1843, 30, 0, 34, "Text"],
Cell[60456, 1845, 786, 24, 102, "Input",
 InitializationCell->True],
Cell[61245, 1871, 30, 0, 34, "Text"],
Cell[61278, 1873, 1540, 46, 212, "Input",
 InitializationCell->True],
Cell[62821, 1921, 29, 0, 34, "Text"],
Cell[62853, 1923, 3320, 92, 476, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66210, 2020, 47, 0, 46, "Subsection"],
Cell[66260, 2022, 41, 0, 34, "Text"],
Cell[66304, 2024, 677, 17, 124, "Input",
 InitializationCell->True],
Cell[66984, 2043, 24, 0, 34, "Text"],
Cell[67011, 2045, 1611, 37, 366, "Input",
 InitializationCell->True],
Cell[68625, 2084, 52, 0, 34, "Text"],
Cell[68680, 2086, 1372, 34, 168, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[70089, 2125, 38, 0, 46, "Subsection"],
Cell[70130, 2127, 87, 3, 55, "Text"],
Cell[70220, 2132, 4014, 99, 498, "Input",
 InitializationCell->True],
Cell[74237, 2233, 356, 8, 80, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74630, 2246, 36, 0, 46, "Subsection"],
Cell[74669, 2248, 8717, 220, 1246, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83435, 2474, 40, 0, 88, "Section"],
Cell[83478, 2476, 213, 6, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[83728, 2487, 33, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[83786, 2491, 208, 6, 46, "Subsection"],
Cell[83997, 2499, 380, 7, 76, "Text"],
Cell[84380, 2508, 163, 4, 34, "Text"],
Cell[84546, 2514, 3612, 104, 190, "Input",
 InitializationCell->True],
Cell[88161, 2620, 412, 11, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[88610, 2636, 46, 0, 46, "Subsection"],
Cell[CellGroupData[{
Cell[88681, 2640, 2813, 60, 498, "Input",
 InitializationCell->True],
Cell[91497, 2702, 2105, 63, 113, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93651, 2771, 38, 0, 46, "Subsection"],
Cell[93692, 2773, 30, 0, 34, "Text"],
Cell[93725, 2775, 376, 10, 102, "Input",
 InitializationCell->True],
Cell[94104, 2787, 88, 2, 34, "Text"],
Cell[94195, 2791, 106, 3, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94350, 2800, 37, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[94412, 2804, 49, 0, 46, "Subsection"],
Cell[94464, 2806, 86, 2, 34, "Text"],
Cell[94553, 2810, 1818, 34, 344, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[96408, 2849, 48, 0, 46, "Subsection"],
Cell[96459, 2851, 6162, 153, 498, "Input",
 InitializationCell->True],
Cell[102624, 3006, 270, 8, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[102931, 3019, 43, 0, 46, "Subsection"],
Cell[102977, 3021, 259, 7, 55, "Text"],
Cell[103239, 3030, 268, 8, 35, "Input",
 InitializationCell->True],
Cell[103510, 3040, 2568, 48, 586, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[106115, 3093, 35, 0, 46, "Subsection"],
Cell[106153, 3095, 1828, 37, 498, "Input",
 InitializationCell->True],
Cell[107984, 3134, 639, 15, 146, "Input",
 InitializationCell->True],
Cell[108626, 3151, 340, 9, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[109003, 3165, 46, 0, 46, "Subsection"],
Cell[109052, 3167, 3581, 72, 740, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[112670, 3244, 35, 0, 46, "Subsection"],
Cell[112708, 3246, 1727, 44, 234, "Input",
 InitializationCell->True],
Cell[114438, 3292, 947, 22, 212, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[115422, 3319, 43, 0, 46, "Subsection"],
Cell[115468, 3321, 13236, 293, 2566, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[128741, 3619, 42, 0, 46, "Subsection"],
Cell[128786, 3621, 5588, 123, 1224, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[134411, 3749, 37, 0, 46, "Subsection"],
Cell[134451, 3751, 14779, 306, 2962, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[149267, 4062, 35, 0, 46, "Subsection"],
Cell[149305, 4064, 360, 10, 35, "Input",
 InitializationCell->True],
Cell[149668, 4076, 1919, 49, 300, "Input",
 InitializationCell->True],
Cell[151590, 4127, 1227, 33, 124, "Input",
 InitializationCell->True],
Cell[152820, 4162, 618, 16, 80, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[153475, 4183, 36, 0, 46, "Subsection"],
Cell[153514, 4185, 4206, 89, 872, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[157757, 4279, 31, 0, 46, "Subsection"],
Cell[157791, 4281, 1034, 26, 168, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158874, 4313, 47, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[158946, 4317, 55, 0, 46, "Subsection"],
Cell[159004, 4319, 297, 8, 117, "Text"],
Cell[159304, 4329, 46, 0, 34, "Text"],
Cell[159353, 4331, 1198, 33, 168, "Input",
 InitializationCell->True],
Cell[160554, 4366, 755, 12, 138, "Text"],
Cell[161312, 4380, 3265, 64, 542, "Input",
 InitializationCell->True],
Cell[164580, 4446, 491, 9, 97, "Text",
 InitializationCell->True],
Cell[165074, 4457, 2231, 66, 168, "Input",
 InitializationCell->True],
Cell[167308, 4525, 1605, 47, 102, "Input",
 InitializationCell->True],
Cell[168916, 4574, 1832, 55, 124, "Input",
 InitializationCell->True],
Cell[170751, 4631, 42, 0, 34, "Text"],
Cell[170796, 4633, 1986, 50, 344, "Input",
 InitializationCell->True],
Cell[172785, 4685, 126, 4, 76, "Text"],
Cell[172914, 4691, 9025, 214, 938, "Input",
 InitializationCell->True],
Cell[181942, 4907, 383, 8, 97, "Text"],
Cell[182328, 4917, 430, 15, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[182795, 4937, 58, 0, 46, "Subsection"],
Cell[182856, 4939, 1173, 34, 168, "Input",
 InitializationCell->True],
Cell[184032, 4975, 1504, 43, 190, "Input",
 InitializationCell->True],
Cell[185539, 5020, 2948, 83, 300, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188536, 5109, 28, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[188589, 5113, 47, 0, 46, "Subsection"],
Cell[188639, 5115, 1133, 33, 190, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[189809, 5153, 49, 0, 46, "Subsection"],
Cell[189861, 5155, 866, 29, 58, "Input",
 InitializationCell->True],
Cell[190730, 5186, 508, 15, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[191275, 5206, 35, 0, 46, "Subsection"],
Cell[191313, 5208, 41, 0, 34, "Text"],
Cell[191357, 5210, 446, 15, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[191840, 5230, 50, 0, 46, "Subsection"],
Cell[191893, 5232, 39, 0, 34, "Text"],
Cell[191935, 5234, 364, 12, 35, "Input",
 InitializationCell->True],
Cell[192302, 5248, 1209, 42, 58, "Input",
 InitializationCell->True],
Cell[193514, 5292, 1122, 37, 80, "Input",
 InitializationCell->True],
Cell[194639, 5331, 2821, 91, 168, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[197497, 5427, 36, 0, 46, "Subsection"],
Cell[197536, 5429, 41, 0, 34, "Text"],
Cell[197580, 5431, 470, 16, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[198087, 5452, 41, 0, 46, "Subsection"],
Cell[198131, 5454, 206, 4, 34, "Text"],
Cell[198340, 5460, 1195, 29, 300, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[199572, 5494, 39, 0, 46, "Subsection"],
Cell[199614, 5496, 156, 3, 34, "Text"],
Cell[199773, 5501, 1481, 40, 278, "Input",
 InitializationCell->True],
Cell[201257, 5543, 30, 0, 34, "Text"],
Cell[201290, 5545, 780, 25, 58, "Input",
 InitializationCell->True],
Cell[202073, 5572, 1287, 43, 80, "Input",
 InitializationCell->True],
Cell[203363, 5617, 154, 4, 55, "Text"],
Cell[203520, 5623, 434, 14, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[203991, 5642, 41, 0, 46, "Subsection"],
Cell[204035, 5644, 27, 0, 34, "Text"],
Cell[204065, 5646, 2003, 56, 234, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[206105, 5707, 51, 0, 46, "Subsection"],
Cell[206159, 5709, 1571, 47, 124, "Input",
 InitializationCell->True],
Cell[207733, 5758, 2016, 57, 256, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[209786, 5820, 67, 0, 46, "Subsection"],
Cell[209856, 5822, 359, 7, 97, "Text"],
Cell[210218, 5831, 798, 19, 234, "Input",
 InitializationCell->True],
Cell[211019, 5852, 26, 0, 34, "Text"],
Cell[211048, 5854, 367, 12, 58, "Input",
 InitializationCell->True],
Cell[211418, 5868, 306, 6, 97, "Text"],
Cell[211727, 5876, 643, 17, 168, "Input",
 InitializationCell->True],
Cell[212373, 5895, 406, 7, 76, "Text"],
Cell[212782, 5904, 1241, 32, 234, "Input",
 InitializationCell->True],
Cell[214026, 5938, 39, 0, 34, "Text"],
Cell[214068, 5940, 1550, 41, 322, "Input",
 InitializationCell->True],
Cell[215621, 5983, 46, 0, 34, "Text"],
Cell[215670, 5985, 678, 18, 168, "Input",
 InitializationCell->True],
Cell[216351, 6005, 668, 18, 168, "Input",
 InitializationCell->True],
Cell[217022, 6025, 683, 18, 168, "Input",
 InitializationCell->True],
Cell[217708, 6045, 93, 2, 34, "Text"],
Cell[217804, 6049, 353, 11, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[218206, 6066, 50, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[218281, 6070, 126, 1, 46, "Subsection"],
Cell[218410, 6073, 280, 7, 34, "Text"],
Cell[218693, 6082, 396, 10, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[219126, 6097, 30, 0, 46, "Subsection"],
Cell[219159, 6099, 906, 15, 221, "Text"],
Cell[220068, 6116, 10368, 243, 1642, "Input",
 InitializationCell->True],
Cell[230439, 6361, 90, 3, 55, "Text"],
Cell[230532, 6366, 1384, 34, 344, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[231953, 6405, 27, 0, 46, "Subsection"],
Cell[231983, 6407, 346, 10, 180, "Text"],
Cell[232332, 6419, 4212, 97, 806, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[236581, 6521, 26, 0, 46, "Subsection"],
Cell[236610, 6523, 738, 19, 325, "Text"],
Cell[237351, 6544, 14373, 314, 2500, "Input",
 InitializationCell->True],
Cell[251727, 6860, 92, 3, 55, "Text"],
Cell[251822, 6865, 7467, 157, 1400, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[259326, 7027, 34, 0, 46, "Subsection"],
Cell[259363, 7029, 498, 12, 200, "Text"],
Cell[259864, 7043, 2628, 61, 564, "Input",
 InitializationCell->True],
Cell[262495, 7106, 94, 3, 55, "Text"],
Cell[262592, 7111, 1241, 29, 344, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[263870, 7145, 30, 0, 46, "Subsection"],
Cell[263903, 7147, 350, 9, 159, "Text"],
Cell[264256, 7158, 1459, 34, 366, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265764, 7198, 34, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[265823, 7202, 44, 0, 46, "Subsection"],
Cell[265870, 7204, 138, 3, 34, "Text"],
Cell[266011, 7209, 22688, 502, 3204, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[288736, 7716, 40, 0, 46, "Subsection"],
Cell[288779, 7718, 740, 12, 117, "Text"],
Cell[289522, 7732, 12774, 337, 1488, "Input",
 InitializationCell->True],
Cell[302299, 8071, 2910, 73, 322, "Input",
 InitializationCell->True],
Cell[305212, 8146, 259, 6, 76, "Text"],
Cell[305474, 8154, 2261, 62, 234, "Input",
 InitializationCell->True],
Cell[307738, 8218, 1191, 19, 366, "Text"],
Cell[308932, 8239, 1356, 27, 366, "Text"],
Cell[310291, 8268, 54390, 1172, 8352, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[364718, 9445, 35, 0, 46, "Subsection"],
Cell[364756, 9447, 22459, 491, 3358, "Input",
 InitializationCell->True],
Cell[387218, 9940, 892, 22, 256, "Input",
 InitializationCell->True],
Cell[388113, 9964, 4026, 100, 608, "Input",
 InitializationCell->True],
Cell[392142, 10066, 1665, 38, 388, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[393844, 10109, 39, 0, 46, "Subsection"],
Cell[393886, 10111, 517, 16, 35, "Input",
 InitializationCell->True],
Cell[394406, 10129, 12662, 307, 1972, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[407105, 10441, 38, 0, 46, "Subsection"],
Cell[407146, 10443, 167, 3, 34, "Text"],
Cell[407316, 10448, 1075, 25, 190, "Input",
 InitializationCell->True],
Cell[408394, 10475, 1062, 26, 190, "Input",
 InitializationCell->True],
Cell[409459, 10503, 3985, 97, 652, "Input",
 InitializationCell->True],
Cell[413447, 10602, 8745, 215, 1334, "Input",
 InitializationCell->True],
Cell[422195, 10819, 148, 4, 55, "Text"],
Cell[422346, 10825, 465, 12, 102, "Input",
 InitializationCell->True],
Cell[422814, 10839, 985, 25, 146, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[423836, 10869, 37, 0, 46, "Subsection"],
Cell[423876, 10871, 31, 0, 34, "Text"],
Cell[423910, 10873, 4955, 110, 1114, "Input",
 InitializationCell->True],
Cell[428868, 10985, 2137, 48, 674, "Input",
 InitializationCell->True],
Cell[431008, 11035, 13417, 345, 2038, "Input",
 InitializationCell->True],
Cell[444428, 11382, 397, 8, 55, "Text"],
Cell[444828, 11392, 20323, 487, 3028, "Input",
 InitializationCell->True],
Cell[465154, 11881, 139, 3, 34, "Text"],
Cell[465296, 11886, 21271, 514, 3336, "Input",
 InitializationCell->True],
Cell[486570, 12402, 6593, 160, 1180, "Input",
 InitializationCell->True],
Cell[493166, 12564, 19112, 458, 2940, "Input",
 InitializationCell->True],
Cell[512281, 13024, 693, 13, 159, "Text"],
Cell[512977, 13039, 9054, 218, 1532, "Input",
 InitializationCell->True],
Cell[522034, 13259, 1277, 35, 168, "Input",
 InitializationCell->True],
Cell[523314, 13296, 747, 17, 256, "Input",
 InitializationCell->True],
Cell[524064, 13315, 926, 25, 146, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[525039, 13346, 37, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[525101, 13350, 34, 0, 46, "Subsection"],
Cell[525138, 13352, 181, 5, 34, "Text"],
Cell[525322, 13359, 1922, 60, 124, "Input",
 InitializationCell->True],
Cell[527247, 13421, 708, 14, 138, "Text"],
Cell[527958, 13437, 10767, 260, 1422, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[538762, 13702, 37, 0, 46, "Subsection"],
Cell[538802, 13704, 1268, 32, 256, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[540107, 13741, 33, 0, 46, "Subsection"],
Cell[540143, 13743, 518, 16, 80, "Input",
 InitializationCell->True],
Cell[540664, 13761, 1805, 52, 146, "Input",
 InitializationCell->True],
Cell[542472, 13815, 107, 3, 34, "Text"],
Cell[542582, 13820, 2443, 78, 146, "Input",
 InitializationCell->True],
Cell[545028, 13900, 581, 16, 58, "Input",
 InitializationCell->True],
Cell[545612, 13918, 8780, 209, 1356, "Input",
 InitializationCell->True],
Cell[554395, 14129, 2678, 76, 234, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[557122, 14211, 34, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[557181, 14215, 39, 0, 46, "Subsection"],
Cell[557223, 14217, 329, 6, 76, "Text"],
Cell[557555, 14225, 22680, 509, 3072, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[580272, 14739, 32, 0, 46, "Subsection"],
Cell[580307, 14741, 8129, 200, 1048, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[588473, 14946, 32, 0, 46, "Subsection"],
Cell[588508, 14948, 472, 15, 58, "Input",
 InitializationCell->True],
Cell[588983, 14965, 1097, 39, 102, "Input",
 InitializationCell->True],
Cell[590083, 15006, 5048, 136, 564, "Input",
 InitializationCell->True],
Cell[595134, 15144, 788, 22, 80, "Input",
 InitializationCell->True],
Cell[595925, 15168, 27714, 642, 3578, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[623676, 15815, 27, 0, 46, "Subsection"],
Cell[623706, 15817, 29609, 693, 3644, "Input",
 InitializationCell->True],
Cell[653318, 16512, 1159, 23, 346, "Text"],
Cell[654480, 16537, 17792, 403, 2434, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[672309, 16945, 33, 0, 46, "Subsection"],
Cell[672345, 16947, 2997, 71, 498, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[675391, 17024, 53, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[675469, 17028, 36, 0, 46, "Subsection"],
Cell[675508, 17030, 2941, 79, 432, "Input",
 InitializationCell->True],
Cell[678452, 17111, 1864, 59, 124, "Input",
 InitializationCell->True],
Cell[680319, 17172, 795, 26, 58, "Input",
 InitializationCell->True],
Cell[681117, 17200, 310, 11, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[681464, 17216, 36, 0, 46, "Subsection"],
Cell[681503, 17218, 2506, 77, 124, "Input",
 InitializationCell->True],
Cell[684012, 17297, 3553, 111, 212, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[687602, 17413, 44, 0, 46, "Subsection"],
Cell[687649, 17415, 12881, 344, 1246, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[700567, 17764, 46, 0, 46, "Subsection"],
Cell[700616, 17766, 561, 17, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[701202, 17787, 507, 15, 35, "Input"],
Cell[701712, 17804, 436, 9, 27, "Message"],
Cell[702151, 17815, 435, 9, 27, "Message"],
Cell[702589, 17826, 436, 9, 27, "Message"],
Cell[703028, 17837, 453, 9, 27, "Message"],
Cell[703484, 17848, 97, 1, 52, "Output"]
}, Open  ]],
Cell[703596, 17852, 2143, 67, 102, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[705764, 17923, 476, 14, 35, "Input"],
Cell[706243, 17939, 435, 9, 27, "Message"],
Cell[706681, 17950, 436, 9, 27, "Message"],
Cell[707120, 17961, 80, 1, 52, "Output"]
}, Open  ]],
Cell[707215, 17965, 1267, 39, 102, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[708519, 18009, 41, 0, 46, "Subsection"],
Cell[708563, 18011, 1655, 47, 146, "Input",
 InitializationCell->True],
Cell[710221, 18060, 1404, 44, 102, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[711662, 18109, 38, 0, 46, "Subsection"],
Cell[711703, 18111, 159, 3, 34, "Text"],
Cell[711865, 18116, 954, 30, 80, "Input",
 InitializationCell->True],
Cell[712822, 18148, 378, 12, 58, "Input",
 InitializationCell->True],
Cell[713203, 18162, 872, 20, 325, "Text"],
Cell[714078, 18184, 1649, 51, 190, "Input",
 InitializationCell->True],
Cell[715730, 18237, 21362, 495, 3424, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[737129, 18737, 39, 0, 46, "Subsection"],
Cell[737171, 18739, 522, 15, 80, "Input",
 InitializationCell->True],
Cell[737696, 18756, 2469, 58, 564, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[740202, 18819, 35, 0, 46, "Subsection"],
Cell[740240, 18821, 932, 22, 256, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[741209, 18848, 46, 0, 46, "Subsection"],
Cell[741258, 18850, 2077, 49, 344, "Input",
 InitializationCell->True],
Cell[743338, 18901, 1932, 48, 344, "Input",
 InitializationCell->True],
Cell[745273, 18951, 2327, 53, 454, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[747637, 19009, 41, 0, 46, "Subsection"],
Cell[747681, 19011, 6125, 150, 916, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[753855, 19167, 38, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[753918, 19171, 44, 0, 46, "Subsection"],
Cell[753965, 19173, 111, 3, 55, "Text"],
Cell[754079, 19178, 1490, 42, 102, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[755606, 19225, 55, 0, 46, "Subsection"],
Cell[755664, 19227, 559, 16, 58, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[756260, 19248, 36, 0, 46, "Subsection"],
Cell[756299, 19250, 211, 4, 34, "Text"],
Cell[756513, 19256, 27062, 568, 4436, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[783624, 19830, 44, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[783693, 19834, 66, 0, 46, "Subsection"],
Cell[783762, 19836, 2597, 63, 520, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[786396, 19904, 56, 0, 46, "Subsection"],
Cell[786455, 19906, 661, 20, 58, "Input",
 InitializationCell->True],
Cell[787119, 19928, 1358, 36, 322, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[788514, 19969, 48, 0, 46, "Subsection"],
Cell[788565, 19971, 559, 14, 146, "Input",
 InitializationCell->True],
Cell[789127, 19987, 556, 14, 146, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[789720, 20006, 52, 0, 46, "Subsection"],
Cell[789775, 20008, 2092, 52, 234, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[791904, 20065, 37, 0, 46, "Subsection"],
Cell[791944, 20067, 179, 5, 35, "Input",
 InitializationCell->True],
Cell[792126, 20074, 695, 18, 124, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[792870, 20098, 39, 0, 88, "Section"],
Cell[CellGroupData[{
Cell[792934, 20102, 53, 0, 46, "Subsection"],
Cell[792990, 20104, 11640, 345, 1070, "Input",
 InitializationCell->True],
Cell[804633, 20451, 303, 10, 35, "Input",
 InitializationCell->True],
Cell[804939, 20463, 346, 10, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[805322, 20478, 40, 0, 46, "Subsection"],
Cell[805365, 20480, 7766, 212, 1840, "Input",
 InitializationCell->True],
Cell[813134, 20694, 104, 3, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[813275, 20702, 48, 0, 46, "Subsection"],
Cell[813326, 20704, 8102, 192, 1444, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[821477, 20902, 38, 0, 88, "Section"],
Cell[821518, 20904, 96, 3, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[821651, 20912, 30, 0, 88, "Section"],
Cell[821684, 20914, 592, 17, 102, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
